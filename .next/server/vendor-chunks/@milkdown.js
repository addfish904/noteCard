"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@milkdown";
exports.ids = ["vendor-chunks/@milkdown"];
exports.modules = {

/***/ "(rsc)/./node_modules/@milkdown/theme-nord/lib/style.css":
/*!*********************************************************!*\
  !*** ./node_modules/@milkdown/theme-nord/lib/style.css ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"0483034b9480\");\nif (false) {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3RoZW1lLW5vcmQvbGliL3N0eWxlLmNzcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsY0FBYztBQUM3QixJQUFJLEtBQVUsRUFBRSxFQUF1QiIsInNvdXJjZXMiOlsiL1VzZXJzL3JhaW4yL0RvY3VtZW50cy9ub3RlQ2FyZC9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3RoZW1lLW5vcmQvbGliL3N0eWxlLmNzcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBcIjA0ODMwMzRiOTQ4MFwiXG5pZiAobW9kdWxlLmhvdCkgeyBtb2R1bGUuaG90LmFjY2VwdCgpIH1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@milkdown/theme-nord/lib/style.css\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/core/lib/index.js":
/*!**************************************************!*\
  !*** ./node_modules/@milkdown/core/lib/index.js ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CommandManager: () => (/* binding */ CommandManager),\n/* harmony export */   CommandsReady: () => (/* binding */ CommandsReady),\n/* harmony export */   ConfigReady: () => (/* binding */ ConfigReady),\n/* harmony export */   Editor: () => (/* binding */ Editor),\n/* harmony export */   EditorStateReady: () => (/* binding */ EditorStateReady),\n/* harmony export */   EditorStatus: () => (/* binding */ EditorStatus),\n/* harmony export */   EditorViewReady: () => (/* binding */ EditorViewReady),\n/* harmony export */   InitReady: () => (/* binding */ InitReady),\n/* harmony export */   ParserReady: () => (/* binding */ ParserReady),\n/* harmony export */   SchemaReady: () => (/* binding */ SchemaReady),\n/* harmony export */   SerializerReady: () => (/* binding */ SerializerReady),\n/* harmony export */   commands: () => (/* binding */ commands),\n/* harmony export */   commandsCtx: () => (/* binding */ commandsCtx),\n/* harmony export */   commandsTimerCtx: () => (/* binding */ commandsTimerCtx),\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   createCmdKey: () => (/* binding */ createCmdKey),\n/* harmony export */   defaultValueCtx: () => (/* binding */ defaultValueCtx),\n/* harmony export */   editorCtx: () => (/* binding */ editorCtx),\n/* harmony export */   editorState: () => (/* binding */ editorState),\n/* harmony export */   editorStateCtx: () => (/* binding */ editorStateCtx),\n/* harmony export */   editorStateOptionsCtx: () => (/* binding */ editorStateOptionsCtx),\n/* harmony export */   editorStateTimerCtx: () => (/* binding */ editorStateTimerCtx),\n/* harmony export */   editorView: () => (/* binding */ editorView),\n/* harmony export */   editorViewCtx: () => (/* binding */ editorViewCtx),\n/* harmony export */   editorViewOptionsCtx: () => (/* binding */ editorViewOptionsCtx),\n/* harmony export */   editorViewTimerCtx: () => (/* binding */ editorViewTimerCtx),\n/* harmony export */   getDoc: () => (/* binding */ getDoc),\n/* harmony export */   init: () => (/* binding */ init),\n/* harmony export */   initTimerCtx: () => (/* binding */ initTimerCtx),\n/* harmony export */   inputRulesCtx: () => (/* binding */ inputRulesCtx),\n/* harmony export */   markViewCtx: () => (/* binding */ markViewCtx),\n/* harmony export */   marksCtx: () => (/* binding */ marksCtx),\n/* harmony export */   nodeViewCtx: () => (/* binding */ nodeViewCtx),\n/* harmony export */   nodesCtx: () => (/* binding */ nodesCtx),\n/* harmony export */   parser: () => (/* binding */ parser),\n/* harmony export */   parserCtx: () => (/* binding */ parserCtx),\n/* harmony export */   parserTimerCtx: () => (/* binding */ parserTimerCtx),\n/* harmony export */   prosePluginsCtx: () => (/* binding */ prosePluginsCtx),\n/* harmony export */   remarkCtx: () => (/* binding */ remarkCtx),\n/* harmony export */   remarkPluginsCtx: () => (/* binding */ remarkPluginsCtx),\n/* harmony export */   remarkStringifyOptionsCtx: () => (/* binding */ remarkStringifyOptionsCtx),\n/* harmony export */   rootAttrsCtx: () => (/* binding */ rootAttrsCtx),\n/* harmony export */   rootCtx: () => (/* binding */ rootCtx),\n/* harmony export */   rootDOMCtx: () => (/* binding */ rootDOMCtx),\n/* harmony export */   schema: () => (/* binding */ schema),\n/* harmony export */   schemaCtx: () => (/* binding */ schemaCtx),\n/* harmony export */   schemaTimerCtx: () => (/* binding */ schemaTimerCtx),\n/* harmony export */   serializer: () => (/* binding */ serializer),\n/* harmony export */   serializerCtx: () => (/* binding */ serializerCtx),\n/* harmony export */   serializerTimerCtx: () => (/* binding */ serializerTimerCtx)\n/* harmony export */ });\n/* harmony import */ var _milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @milkdown/ctx */ \"(ssr)/./node_modules/@milkdown/ctx/lib/index.js\");\n/* harmony import */ var _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @milkdown/prose/model */ \"(ssr)/./node_modules/prosemirror-model/dist/index.js\");\n/* harmony import */ var remark_parse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! remark-parse */ \"(ssr)/./node_modules/remark-parse/lib/index.js\");\n/* harmony import */ var remark_stringify__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! remark-stringify */ \"(ssr)/./node_modules/remark-stringify/lib/index.js\");\n/* harmony import */ var unified__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! unified */ \"(ssr)/./node_modules/unified/lib/index.js\");\n/* harmony import */ var _milkdown_exception__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @milkdown/exception */ \"(ssr)/./node_modules/@milkdown/exception/lib/index.js\");\n/* harmony import */ var _milkdown_transformer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @milkdown/transformer */ \"(ssr)/./node_modules/@milkdown/transformer/lib/index.js\");\n/* harmony import */ var _milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @milkdown/prose/commands */ \"(ssr)/./node_modules/prosemirror-commands/dist/index.js\");\n/* harmony import */ var _milkdown_prose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @milkdown/prose */ \"(ssr)/./node_modules/@milkdown/prose/lib/index.js\");\n/* harmony import */ var _milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @milkdown/prose/inputrules */ \"(ssr)/./node_modules/prosemirror-inputrules/dist/index.js\");\n/* harmony import */ var _milkdown_prose_keymap__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @milkdown/prose/keymap */ \"(ssr)/./node_modules/prosemirror-keymap/dist/index.js\");\n/* harmony import */ var _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @milkdown/prose/state */ \"(ssr)/./node_modules/prosemirror-state/dist/index.js\");\n/* harmony import */ var _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @milkdown/prose/view */ \"(ssr)/./node_modules/prosemirror-view/dist/index.js\");\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\nvar _container, _ctx, _enableInspector, _status, _configureList, _onStatusChange, _container2, _clock, _usrPluginStore, _sysPluginStore, _ctx2, _loadInternal, _prepare, _cleanup, _cleanupInternal, _setStatus, _loadPluginInStore;\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction withMeta(plugin, meta) {\n  plugin.meta = {\n    package: \"@milkdown/core\",\n    group: \"System\",\n    ...meta\n  };\n  return plugin;\n}\nconst remarkHandlers = {\n  strong: (node, _, state, info) => {\n    const marker = node.marker || state.options.strong || \"*\";\n    const exit = state.enter(\"strong\");\n    const tracker = state.createTracker(info);\n    let value = tracker.move(marker + marker);\n    value += tracker.move(\n      state.containerPhrasing(node, {\n        before: value,\n        after: marker,\n        ...tracker.current()\n      })\n    );\n    value += tracker.move(marker + marker);\n    exit();\n    return value;\n  },\n  emphasis: (node, _, state, info) => {\n    const marker = node.marker || state.options.emphasis || \"*\";\n    const exit = state.enter(\"emphasis\");\n    const tracker = state.createTracker(info);\n    let value = tracker.move(marker);\n    value += tracker.move(\n      state.containerPhrasing(node, {\n        before: value,\n        after: marker,\n        ...tracker.current()\n      })\n    );\n    value += tracker.move(marker);\n    exit();\n    return value;\n  }\n};\nconst editorViewCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)({}, \"editorView\");\nconst editorStateCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)({}, \"editorState\");\nconst initTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"initTimer\");\nconst editorCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)({}, \"editor\");\nconst inputRulesCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"inputRules\");\nconst prosePluginsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"prosePlugins\");\nconst remarkPluginsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  [],\n  \"remarkPlugins\"\n);\nconst nodeViewCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"nodeView\");\nconst markViewCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"markView\");\nconst remarkCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  (0,unified__WEBPACK_IMPORTED_MODULE_1__.unified)().use(remark_parse__WEBPACK_IMPORTED_MODULE_2__[\"default\"]).use(remark_stringify__WEBPACK_IMPORTED_MODULE_3__[\"default\"]),\n  \"remark\"\n);\nconst remarkStringifyOptionsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  {\n    handlers: remarkHandlers\n  },\n  \"remarkStringifyOptions\"\n);\nconst ConfigReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"ConfigReady\");\nfunction config(configure) {\n  const plugin = (ctx) => {\n    ctx.record(ConfigReady);\n    return async () => {\n      await configure(ctx);\n      ctx.done(ConfigReady);\n      return () => {\n        ctx.clearTimer(ConfigReady);\n      };\n    };\n  };\n  withMeta(plugin, {\n    displayName: \"Config\"\n  });\n  return plugin;\n}\nconst InitReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"InitReady\");\nfunction init(editor) {\n  const plugin = (ctx) => {\n    ctx.inject(editorCtx, editor).inject(prosePluginsCtx, []).inject(remarkPluginsCtx, []).inject(inputRulesCtx, []).inject(nodeViewCtx, []).inject(markViewCtx, []).inject(remarkStringifyOptionsCtx, {\n      handlers: remarkHandlers\n    }).inject(remarkCtx, (0,unified__WEBPACK_IMPORTED_MODULE_1__.unified)().use(remark_parse__WEBPACK_IMPORTED_MODULE_2__[\"default\"]).use(remark_stringify__WEBPACK_IMPORTED_MODULE_3__[\"default\"])).inject(initTimerCtx, [ConfigReady]).record(InitReady);\n    return async () => {\n      await ctx.waitTimers(initTimerCtx);\n      const options = ctx.get(remarkStringifyOptionsCtx);\n      ctx.set(\n        remarkCtx,\n        (0,unified__WEBPACK_IMPORTED_MODULE_1__.unified)().use(remark_parse__WEBPACK_IMPORTED_MODULE_2__[\"default\"]).use(remark_stringify__WEBPACK_IMPORTED_MODULE_3__[\"default\"], options)\n      );\n      ctx.done(InitReady);\n      return () => {\n        ctx.remove(editorCtx).remove(prosePluginsCtx).remove(remarkPluginsCtx).remove(inputRulesCtx).remove(nodeViewCtx).remove(markViewCtx).remove(remarkStringifyOptionsCtx).remove(remarkCtx).remove(initTimerCtx).clearTimer(InitReady);\n      };\n    };\n  };\n  withMeta(plugin, {\n    displayName: \"Init\"\n  });\n  return plugin;\n}\nconst SchemaReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"SchemaReady\");\nconst schemaTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"schemaTimer\");\nconst schemaCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)({}, \"schema\");\nconst nodesCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"nodes\");\nconst marksCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"marks\");\nfunction extendPriority(x) {\n  var _a;\n  return {\n    ...x,\n    parseDOM: (_a = x.parseDOM) == null ? void 0 : _a.map((rule) => ({ priority: x.priority, ...rule }))\n  };\n}\nconst schema = (ctx) => {\n  ctx.inject(schemaCtx, {}).inject(nodesCtx, []).inject(marksCtx, []).inject(schemaTimerCtx, [InitReady]).record(SchemaReady);\n  return async () => {\n    await ctx.waitTimers(schemaTimerCtx);\n    const remark = ctx.get(remarkCtx);\n    const remarkPlugins = ctx.get(remarkPluginsCtx);\n    const processor = remarkPlugins.reduce(\n      (acc, plug) => acc.use(plug.plugin, plug.options),\n      remark\n    );\n    ctx.set(remarkCtx, processor);\n    const nodes = Object.fromEntries(\n      ctx.get(nodesCtx).map(([key2, x]) => [key2, extendPriority(x)])\n    );\n    const marks = Object.fromEntries(\n      ctx.get(marksCtx).map(([key2, x]) => [key2, extendPriority(x)])\n    );\n    const schema2 = new _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.Schema({ nodes, marks });\n    ctx.set(schemaCtx, schema2);\n    ctx.done(SchemaReady);\n    return () => {\n      ctx.remove(schemaCtx).remove(nodesCtx).remove(marksCtx).remove(schemaTimerCtx).clearTimer(SchemaReady);\n    };\n  };\n};\nwithMeta(schema, {\n  displayName: \"Schema\"\n});\nclass CommandManager {\n  constructor() {\n    __privateAdd(this, _container);\n    __privateAdd(this, _ctx);\n    __privateSet(this, _container, new _milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.Container());\n    __privateSet(this, _ctx, null);\n    this.setCtx = (ctx) => {\n      __privateSet(this, _ctx, ctx);\n    };\n    this.chain = () => {\n      if (__privateGet(this, _ctx) == null) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.callCommandBeforeEditorView)();\n      const ctx = __privateGet(this, _ctx);\n      const commands2 = [];\n      const get = this.get;\n      const chains = {\n        run: () => {\n          const chained = (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__.chainCommands)(...commands2);\n          const view = ctx.get(editorViewCtx);\n          return chained(view.state, view.dispatch, view);\n        },\n        inline: (command) => {\n          commands2.push(command);\n          return chains;\n        },\n        pipe\n      };\n      function pipe(slice, payload) {\n        const cmd = get(slice);\n        commands2.push(cmd(payload));\n        return chains;\n      }\n      return chains;\n    };\n  }\n  get ctx() {\n    return __privateGet(this, _ctx);\n  }\n  /// Register a command into the manager.\n  create(meta, value) {\n    const slice = meta.create(__privateGet(this, _container).sliceMap);\n    slice.set(value);\n    return slice;\n  }\n  get(slice) {\n    return __privateGet(this, _container).get(slice).get();\n  }\n  remove(slice) {\n    return __privateGet(this, _container).remove(slice);\n  }\n  call(slice, payload) {\n    if (__privateGet(this, _ctx) == null) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.callCommandBeforeEditorView)();\n    const cmd = this.get(slice);\n    const command = cmd(payload);\n    const view = __privateGet(this, _ctx).get(editorViewCtx);\n    return command(view.state, view.dispatch, view);\n  }\n  /// Call an inline command.\n  inline(command) {\n    if (__privateGet(this, _ctx) == null) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.callCommandBeforeEditorView)();\n    const view = __privateGet(this, _ctx).get(editorViewCtx);\n    return command(view.state, view.dispatch, view);\n  }\n}\n_container = new WeakMap();\n_ctx = new WeakMap();\nfunction createCmdKey(key2 = \"cmdKey\") {\n  return (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(() => () => false, key2);\n}\nconst commandsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(new CommandManager(), \"commands\");\nconst commandsTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([SchemaReady], \"commandsTimer\");\nconst CommandsReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"CommandsReady\");\nconst commands = (ctx) => {\n  const cmd = new CommandManager();\n  cmd.setCtx(ctx);\n  ctx.inject(commandsCtx, cmd).inject(commandsTimerCtx, [SchemaReady]).record(CommandsReady);\n  return async () => {\n    await ctx.waitTimers(commandsTimerCtx);\n    ctx.done(CommandsReady);\n    return () => {\n      ctx.remove(commandsCtx).remove(commandsTimerCtx).clearTimer(CommandsReady);\n    };\n  };\n};\nwithMeta(commands, {\n  displayName: \"Commands\"\n});\nconst ParserReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"ParserReady\");\nconst outOfScope$1 = () => {\n  throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.ctxCallOutOfScope)();\n};\nconst parserCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(outOfScope$1, \"parser\");\nconst parserTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)([], \"parserTimer\");\nconst parser = (ctx) => {\n  ctx.inject(parserCtx, outOfScope$1).inject(parserTimerCtx, [SchemaReady]).record(ParserReady);\n  return async () => {\n    await ctx.waitTimers(parserTimerCtx);\n    const remark = ctx.get(remarkCtx);\n    const schema2 = ctx.get(schemaCtx);\n    ctx.set(parserCtx, _milkdown_transformer__WEBPACK_IMPORTED_MODULE_7__.ParserState.create(schema2, remark));\n    ctx.done(ParserReady);\n    return () => {\n      ctx.remove(parserCtx).remove(parserTimerCtx).clearTimer(ParserReady);\n    };\n  };\n};\nwithMeta(parser, {\n  displayName: \"Parser\"\n});\nconst SerializerReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"SerializerReady\");\nconst serializerTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  [],\n  \"serializerTimer\"\n);\nconst outOfScope = () => {\n  throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.ctxCallOutOfScope)();\n};\nconst serializerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  outOfScope,\n  \"serializer\"\n);\nconst serializer = (ctx) => {\n  ctx.inject(serializerCtx, outOfScope).inject(serializerTimerCtx, [SchemaReady]).record(SerializerReady);\n  return async () => {\n    await ctx.waitTimers(serializerTimerCtx);\n    const remark = ctx.get(remarkCtx);\n    const schema2 = ctx.get(schemaCtx);\n    ctx.set(serializerCtx, _milkdown_transformer__WEBPACK_IMPORTED_MODULE_7__.SerializerState.create(schema2, remark));\n    ctx.done(SerializerReady);\n    return () => {\n      ctx.remove(serializerCtx).remove(serializerTimerCtx).clearTimer(SerializerReady);\n    };\n  };\n};\nwithMeta(serializer, {\n  displayName: \"Serializer\"\n});\nconst defaultValueCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\"\", \"defaultValue\");\nconst editorStateOptionsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  (x) => x,\n  \"stateOptions\"\n);\nconst editorStateTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  [],\n  \"editorStateTimer\"\n);\nconst EditorStateReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"EditorStateReady\");\nfunction getDoc(defaultValue, parser2, schema2) {\n  if (typeof defaultValue === \"string\") return parser2(defaultValue);\n  if (defaultValue.type === \"html\")\n    return _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.DOMParser.fromSchema(schema2).parse(defaultValue.dom);\n  if (defaultValue.type === \"json\")\n    return _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_4__.Node.fromJSON(schema2, defaultValue.value);\n  throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.docTypeError)(defaultValue);\n}\nconst key$1 = new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_8__.PluginKey(\"MILKDOWN_STATE_TRACKER\");\nfunction overrideBaseKeymap(keymap2) {\n  const handleBackspace = (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__.chainCommands)(\n    _milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_9__.undoInputRule,\n    _milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__.deleteSelection,\n    _milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__.joinBackward,\n    _milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__.selectNodeBackward\n  );\n  keymap2.Backspace = handleBackspace;\n  return keymap2;\n}\nconst editorState = (ctx) => {\n  ctx.inject(defaultValueCtx, \"\").inject(editorStateCtx, {}).inject(editorStateOptionsCtx, (x) => x).inject(editorStateTimerCtx, [ParserReady, SerializerReady, CommandsReady]).record(EditorStateReady);\n  return async () => {\n    await ctx.waitTimers(editorStateTimerCtx);\n    const schema2 = ctx.get(schemaCtx);\n    const parser2 = ctx.get(parserCtx);\n    const rules = ctx.get(inputRulesCtx);\n    const optionsOverride = ctx.get(editorStateOptionsCtx);\n    const prosePlugins = ctx.get(prosePluginsCtx);\n    const defaultValue = ctx.get(defaultValueCtx);\n    const doc = getDoc(defaultValue, parser2, schema2);\n    const plugins = [\n      ...prosePlugins,\n      new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_8__.Plugin({\n        key: key$1,\n        state: {\n          init: () => {\n          },\n          apply: (_tr, _value, _oldState, newState) => {\n            ctx.set(editorStateCtx, newState);\n          }\n        }\n      }),\n      (0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_10__.customInputRules)({ rules }),\n      (0,_milkdown_prose_keymap__WEBPACK_IMPORTED_MODULE_11__.keymap)(overrideBaseKeymap(_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_6__.baseKeymap))\n    ];\n    ctx.set(prosePluginsCtx, plugins);\n    const options = optionsOverride({\n      schema: schema2,\n      doc,\n      plugins\n    });\n    const state = _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_8__.EditorState.create(options);\n    ctx.set(editorStateCtx, state);\n    ctx.done(EditorStateReady);\n    return () => {\n      ctx.remove(defaultValueCtx).remove(editorStateCtx).remove(editorStateOptionsCtx).remove(editorStateTimerCtx).clearTimer(EditorStateReady);\n    };\n  };\n};\nwithMeta(editorState, {\n  displayName: \"EditorState\"\n});\nconst EditorViewReady = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createTimer)(\"EditorViewReady\");\nconst editorViewTimerCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  [],\n  \"editorViewTimer\"\n);\nconst editorViewOptionsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  {},\n  \"editorViewOptions\"\n);\nconst rootCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(null, \"root\");\nconst rootDOMCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(null, \"rootDOM\");\nconst rootAttrsCtx = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.createSlice)(\n  {},\n  \"rootAttrs\"\n);\nfunction createViewContainer(root, ctx) {\n  const container = document.createElement(\"div\");\n  container.className = \"milkdown\";\n  root.appendChild(container);\n  ctx.set(rootDOMCtx, container);\n  const attrs = ctx.get(rootAttrsCtx);\n  Object.entries(attrs).forEach(\n    ([key2, value]) => container.setAttribute(key2, value)\n  );\n  return container;\n}\nfunction prepareViewDom(dom) {\n  dom.classList.add(\"editor\");\n  dom.setAttribute(\"role\", \"textbox\");\n}\nconst key = new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_8__.PluginKey(\"MILKDOWN_VIEW_CLEAR\");\nconst editorView = (ctx) => {\n  ctx.inject(rootCtx, document.body).inject(editorViewCtx, {}).inject(editorViewOptionsCtx, {}).inject(rootDOMCtx, null).inject(rootAttrsCtx, {}).inject(editorViewTimerCtx, [EditorStateReady]).record(EditorViewReady);\n  return async () => {\n    await ctx.wait(InitReady);\n    const root = ctx.get(rootCtx) || document.body;\n    const el = typeof root === \"string\" ? document.querySelector(root) : root;\n    ctx.update(prosePluginsCtx, (xs) => [\n      new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_8__.Plugin({\n        key,\n        view: (editorView2) => {\n          const container = el ? createViewContainer(el, ctx) : void 0;\n          const handleDOM = () => {\n            if (container && el) {\n              const editor = editorView2.dom;\n              el.replaceChild(container, editor);\n              container.appendChild(editor);\n            }\n          };\n          handleDOM();\n          return {\n            destroy: () => {\n              if (container == null ? void 0 : container.parentNode)\n                container == null ? void 0 : container.parentNode.replaceChild(editorView2.dom, container);\n              container == null ? void 0 : container.remove();\n            }\n          };\n        }\n      }),\n      ...xs\n    ]);\n    await ctx.waitTimers(editorViewTimerCtx);\n    const state = ctx.get(editorStateCtx);\n    const options = ctx.get(editorViewOptionsCtx);\n    const nodeViews = Object.fromEntries(ctx.get(nodeViewCtx));\n    const markViews = Object.fromEntries(ctx.get(markViewCtx));\n    const view = new _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__.EditorView(el, {\n      state,\n      nodeViews,\n      markViews,\n      ...options\n    });\n    prepareViewDom(view.dom);\n    ctx.set(editorViewCtx, view);\n    ctx.done(EditorViewReady);\n    return () => {\n      view == null ? void 0 : view.destroy();\n      ctx.remove(rootCtx).remove(editorViewCtx).remove(editorViewOptionsCtx).remove(rootDOMCtx).remove(rootAttrsCtx).remove(editorViewTimerCtx).clearTimer(EditorViewReady);\n    };\n  };\n};\nwithMeta(editorView, {\n  displayName: \"EditorView\"\n});\nvar EditorStatus = /* @__PURE__ */ ((EditorStatus2) => {\n  EditorStatus2[\"Idle\"] = \"Idle\";\n  EditorStatus2[\"OnCreate\"] = \"OnCreate\";\n  EditorStatus2[\"Created\"] = \"Created\";\n  EditorStatus2[\"OnDestroy\"] = \"OnDestroy\";\n  EditorStatus2[\"Destroyed\"] = \"Destroyed\";\n  return EditorStatus2;\n})(EditorStatus || {});\nconst _Editor = class _Editor {\n  constructor() {\n    __privateAdd(this, _enableInspector);\n    __privateAdd(this, _status);\n    __privateAdd(this, _configureList);\n    __privateAdd(this, _onStatusChange);\n    __privateAdd(this, _container2);\n    __privateAdd(this, _clock);\n    __privateAdd(this, _usrPluginStore);\n    __privateAdd(this, _sysPluginStore);\n    __privateAdd(this, _ctx2);\n    __privateAdd(this, _loadInternal);\n    __privateAdd(this, _prepare);\n    __privateAdd(this, _cleanup);\n    __privateAdd(this, _cleanupInternal);\n    __privateAdd(this, _setStatus);\n    __privateAdd(this, _loadPluginInStore);\n    __privateSet(this, _enableInspector, false);\n    __privateSet(this, _status, \"Idle\");\n    __privateSet(this, _configureList, []);\n    __privateSet(this, _onStatusChange, () => void 0);\n    __privateSet(this, _container2, new _milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.Container());\n    __privateSet(this, _clock, new _milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.Clock());\n    __privateSet(this, _usrPluginStore, /* @__PURE__ */ new Map());\n    __privateSet(this, _sysPluginStore, /* @__PURE__ */ new Map());\n    __privateSet(this, _ctx2, new _milkdown_ctx__WEBPACK_IMPORTED_MODULE_0__.Ctx(__privateGet(this, _container2), __privateGet(this, _clock)));\n    __privateSet(this, _loadInternal, () => {\n      const configPlugin = config(async (ctx) => {\n        await Promise.all(__privateGet(this, _configureList).map((fn) => fn(ctx)));\n      });\n      const internalPlugins = [\n        schema,\n        parser,\n        serializer,\n        commands,\n        editorState,\n        editorView,\n        init(this),\n        configPlugin\n      ];\n      __privateGet(this, _prepare).call(this, internalPlugins, __privateGet(this, _sysPluginStore));\n    });\n    __privateSet(this, _prepare, (plugins, store) => {\n      plugins.forEach((plugin) => {\n        const ctx = __privateGet(this, _ctx2).produce(\n          __privateGet(this, _enableInspector) ? plugin.meta : void 0\n        );\n        const handler = plugin(ctx);\n        store.set(plugin, { ctx, handler, cleanup: void 0 });\n      });\n    });\n    __privateSet(this, _cleanup, (plugins, remove = false) => {\n      return Promise.all(\n        [plugins].flat().map((plugin) => {\n          const loader = __privateGet(this, _usrPluginStore).get(plugin);\n          const cleanup = loader == null ? void 0 : loader.cleanup;\n          if (remove) __privateGet(this, _usrPluginStore).delete(plugin);\n          else\n            __privateGet(this, _usrPluginStore).set(plugin, {\n              ctx: void 0,\n              handler: void 0,\n              cleanup: void 0\n            });\n          if (typeof cleanup === \"function\") return cleanup();\n          return cleanup;\n        })\n      );\n    });\n    __privateSet(this, _cleanupInternal, async () => {\n      await Promise.all(\n        [...__privateGet(this, _sysPluginStore).entries()].map(([_, { cleanup }]) => {\n          if (typeof cleanup === \"function\") return cleanup();\n          return cleanup;\n        })\n      );\n      __privateGet(this, _sysPluginStore).clear();\n    });\n    __privateSet(this, _setStatus, (status) => {\n      __privateSet(this, _status, status);\n      __privateGet(this, _onStatusChange).call(this, status);\n    });\n    __privateSet(this, _loadPluginInStore, (store) => {\n      return [...store.entries()].map(async ([key2, loader]) => {\n        const { ctx, handler } = loader;\n        if (!handler) return;\n        const cleanup = await handler();\n        store.set(key2, { ctx, handler, cleanup });\n      });\n    });\n    this.enableInspector = (enable = true) => {\n      __privateSet(this, _enableInspector, enable);\n      return this;\n    };\n    this.onStatusChange = (onChange) => {\n      __privateSet(this, _onStatusChange, onChange);\n      return this;\n    };\n    this.config = (configure) => {\n      __privateGet(this, _configureList).push(configure);\n      return this;\n    };\n    this.removeConfig = (configure) => {\n      __privateSet(this, _configureList, __privateGet(this, _configureList).filter((x) => x !== configure));\n      return this;\n    };\n    this.use = (plugins) => {\n      const _plugins = [plugins].flat();\n      _plugins.flat().forEach((plugin) => {\n        __privateGet(this, _usrPluginStore).set(plugin, {\n          ctx: void 0,\n          handler: void 0,\n          cleanup: void 0\n        });\n      });\n      if (__privateGet(this, _status) === \"Created\")\n        __privateGet(this, _prepare).call(this, _plugins, __privateGet(this, _usrPluginStore));\n      return this;\n    };\n    this.remove = async (plugins) => {\n      if (__privateGet(this, _status) === \"OnCreate\") {\n        console.warn(\n          \"[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code.\"\n        );\n        return new Promise((resolve) => {\n          setTimeout(() => {\n            resolve(this.remove(plugins));\n          }, 50);\n        });\n      }\n      await __privateGet(this, _cleanup).call(this, [plugins].flat(), true);\n      return this;\n    };\n    this.create = async () => {\n      if (__privateGet(this, _status) === \"OnCreate\") return this;\n      if (__privateGet(this, _status) === \"Created\") await this.destroy();\n      __privateGet(this, _setStatus).call(this, \"OnCreate\");\n      __privateGet(this, _loadInternal).call(this);\n      __privateGet(this, _prepare).call(this, [...__privateGet(this, _usrPluginStore).keys()], __privateGet(this, _usrPluginStore));\n      await Promise.all(\n        [\n          __privateGet(this, _loadPluginInStore).call(this, __privateGet(this, _sysPluginStore)),\n          __privateGet(this, _loadPluginInStore).call(this, __privateGet(this, _usrPluginStore))\n        ].flat()\n      );\n      __privateGet(this, _setStatus).call(this, \"Created\");\n      return this;\n    };\n    this.destroy = async (clearPlugins = false) => {\n      if (__privateGet(this, _status) === \"Destroyed\" || __privateGet(this, _status) === \"OnDestroy\")\n        return this;\n      if (__privateGet(this, _status) === \"OnCreate\") {\n        return new Promise((resolve) => {\n          setTimeout(() => {\n            resolve(this.destroy(clearPlugins));\n          }, 50);\n        });\n      }\n      if (clearPlugins) __privateSet(this, _configureList, []);\n      __privateGet(this, _setStatus).call(this, \"OnDestroy\");\n      await __privateGet(this, _cleanup).call(this, [...__privateGet(this, _usrPluginStore).keys()], clearPlugins);\n      await __privateGet(this, _cleanupInternal).call(this);\n      __privateGet(this, _setStatus).call(this, \"Destroyed\");\n      return this;\n    };\n    this.action = (action) => action(__privateGet(this, _ctx2));\n    this.inspect = () => {\n      if (!__privateGet(this, _enableInspector)) {\n        console.warn(\n          \"[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first.\"\n        );\n        return [];\n      }\n      return [...__privateGet(this, _sysPluginStore).values(), ...__privateGet(this, _usrPluginStore).values()].map(({ ctx }) => {\n        var _a;\n        return (_a = ctx == null ? void 0 : ctx.inspector) == null ? void 0 : _a.read();\n      }).filter((x) => Boolean(x));\n    };\n  }\n  /// Create a new editor instance.\n  static make() {\n    return new _Editor();\n  }\n  /// Get the ctx of the editor.\n  get ctx() {\n    return __privateGet(this, _ctx2);\n  }\n  /// Get the status of the editor.\n  get status() {\n    return __privateGet(this, _status);\n  }\n};\n_enableInspector = new WeakMap();\n_status = new WeakMap();\n_configureList = new WeakMap();\n_onStatusChange = new WeakMap();\n_container2 = new WeakMap();\n_clock = new WeakMap();\n_usrPluginStore = new WeakMap();\n_sysPluginStore = new WeakMap();\n_ctx2 = new WeakMap();\n_loadInternal = new WeakMap();\n_prepare = new WeakMap();\n_cleanup = new WeakMap();\n_cleanupInternal = new WeakMap();\n_setStatus = new WeakMap();\n_loadPluginInStore = new WeakMap();\nlet Editor = _Editor;\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL2NvcmUvbGliL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDZ0Y7QUFDaEI7QUFDekI7QUFDUTtBQUNiO0FBQ2lFO0FBQzlCO0FBQ21EO0FBQ3JFO0FBQ1E7QUFDWDtBQUN1QjtBQUNyQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsMERBQVcsR0FBRztBQUNwQyx1QkFBdUIsMERBQVcsR0FBRztBQUNyQyxxQkFBcUIsMERBQVc7QUFDaEMsa0JBQWtCLDBEQUFXLEdBQUc7QUFDaEMsc0JBQXNCLDBEQUFXO0FBQ2pDLHdCQUF3QiwwREFBVztBQUNuQyx5QkFBeUIsMERBQVc7QUFDcEM7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDBEQUFXO0FBQy9CLG9CQUFvQiwwREFBVztBQUMvQixrQkFBa0IsMERBQVc7QUFDN0IsRUFBRSxnREFBTyxPQUFPLG9EQUFXLE1BQU0sd0RBQWU7QUFDaEQ7QUFDQTtBQUNBLGtDQUFrQywwREFBVztBQUM3QztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxvQkFBb0IsMERBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFH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QUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUhBQXVILEtBQUs7QUFDNUg7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW9ERTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcmFpbjIvRG9jdW1lbnRzL25vdGVDYXJkL25vZGVfbW9kdWxlcy9AbWlsa2Rvd24vY29yZS9saWIvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fdHlwZUVycm9yID0gKG1zZykgPT4ge1xuICB0aHJvdyBUeXBlRXJyb3IobXNnKTtcbn07XG52YXIgX19hY2Nlc3NDaGVjayA9IChvYmosIG1lbWJlciwgbXNnKSA9PiBtZW1iZXIuaGFzKG9iaikgfHwgX190eXBlRXJyb3IoXCJDYW5ub3QgXCIgKyBtc2cpO1xudmFyIF9fcHJpdmF0ZUdldCA9IChvYmosIG1lbWJlciwgZ2V0dGVyKSA9PiAoX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJyZWFkIGZyb20gcHJpdmF0ZSBmaWVsZFwiKSwgZ2V0dGVyID8gZ2V0dGVyLmNhbGwob2JqKSA6IG1lbWJlci5nZXQob2JqKSk7XG52YXIgX19wcml2YXRlQWRkID0gKG9iaiwgbWVtYmVyLCB2YWx1ZSkgPT4gbWVtYmVyLmhhcyhvYmopID8gX190eXBlRXJyb3IoXCJDYW5ub3QgYWRkIHRoZSBzYW1lIHByaXZhdGUgbWVtYmVyIG1vcmUgdGhhbiBvbmNlXCIpIDogbWVtYmVyIGluc3RhbmNlb2YgV2Vha1NldCA/IG1lbWJlci5hZGQob2JqKSA6IG1lbWJlci5zZXQob2JqLCB2YWx1ZSk7XG52YXIgX19wcml2YXRlU2V0ID0gKG9iaiwgbWVtYmVyLCB2YWx1ZSwgc2V0dGVyKSA9PiAoX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJ3cml0ZSB0byBwcml2YXRlIGZpZWxkXCIpLCBzZXR0ZXIgPyBzZXR0ZXIuY2FsbChvYmosIHZhbHVlKSA6IG1lbWJlci5zZXQob2JqLCB2YWx1ZSksIHZhbHVlKTtcbnZhciBfY29udGFpbmVyLCBfY3R4LCBfZW5hYmxlSW5zcGVjdG9yLCBfc3RhdHVzLCBfY29uZmlndXJlTGlzdCwgX29uU3RhdHVzQ2hhbmdlLCBfY29udGFpbmVyMiwgX2Nsb2NrLCBfdXNyUGx1Z2luU3RvcmUsIF9zeXNQbHVnaW5TdG9yZSwgX2N0eDIsIF9sb2FkSW50ZXJuYWwsIF9wcmVwYXJlLCBfY2xlYW51cCwgX2NsZWFudXBJbnRlcm5hbCwgX3NldFN0YXR1cywgX2xvYWRQbHVnaW5JblN0b3JlO1xuaW1wb3J0IHsgY3JlYXRlU2xpY2UsIGNyZWF0ZVRpbWVyLCBDb250YWluZXIsIENsb2NrLCBDdHggfSBmcm9tIFwiQG1pbGtkb3duL2N0eFwiO1xuaW1wb3J0IHsgU2NoZW1hLCBET01QYXJzZXIsIE5vZGUgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL21vZGVsXCI7XG5pbXBvcnQgcmVtYXJrUGFyc2UgZnJvbSBcInJlbWFyay1wYXJzZVwiO1xuaW1wb3J0IHJlbWFya1N0cmluZ2lmeSBmcm9tIFwicmVtYXJrLXN0cmluZ2lmeVwiO1xuaW1wb3J0IHsgdW5pZmllZCB9IGZyb20gXCJ1bmlmaWVkXCI7XG5pbXBvcnQgeyBjYWxsQ29tbWFuZEJlZm9yZUVkaXRvclZpZXcsIGN0eENhbGxPdXRPZlNjb3BlLCBkb2NUeXBlRXJyb3IgfSBmcm9tIFwiQG1pbGtkb3duL2V4Y2VwdGlvblwiO1xuaW1wb3J0IHsgUGFyc2VyU3RhdGUsIFNlcmlhbGl6ZXJTdGF0ZSB9IGZyb20gXCJAbWlsa2Rvd24vdHJhbnNmb3JtZXJcIjtcbmltcG9ydCB7IGNoYWluQ29tbWFuZHMsIGRlbGV0ZVNlbGVjdGlvbiwgam9pbkJhY2t3YXJkLCBzZWxlY3ROb2RlQmFja3dhcmQsIGJhc2VLZXltYXAgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL2NvbW1hbmRzXCI7XG5pbXBvcnQgeyBjdXN0b21JbnB1dFJ1bGVzIH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZVwiO1xuaW1wb3J0IHsgdW5kb0lucHV0UnVsZSB9IGZyb20gXCJAbWlsa2Rvd24vcHJvc2UvaW5wdXRydWxlc1wiO1xuaW1wb3J0IHsga2V5bWFwIH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZS9rZXltYXBcIjtcbmltcG9ydCB7IFBsdWdpbiwgUGx1Z2luS2V5LCBFZGl0b3JTdGF0ZSB9IGZyb20gXCJAbWlsa2Rvd24vcHJvc2Uvc3RhdGVcIjtcbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL3ZpZXdcIjtcbmZ1bmN0aW9uIHdpdGhNZXRhKHBsdWdpbiwgbWV0YSkge1xuICBwbHVnaW4ubWV0YSA9IHtcbiAgICBwYWNrYWdlOiBcIkBtaWxrZG93bi9jb3JlXCIsXG4gICAgZ3JvdXA6IFwiU3lzdGVtXCIsXG4gICAgLi4ubWV0YVxuICB9O1xuICByZXR1cm4gcGx1Z2luO1xufVxuY29uc3QgcmVtYXJrSGFuZGxlcnMgPSB7XG4gIHN0cm9uZzogKG5vZGUsIF8sIHN0YXRlLCBpbmZvKSA9PiB7XG4gICAgY29uc3QgbWFya2VyID0gbm9kZS5tYXJrZXIgfHwgc3RhdGUub3B0aW9ucy5zdHJvbmcgfHwgXCIqXCI7XG4gICAgY29uc3QgZXhpdCA9IHN0YXRlLmVudGVyKFwic3Ryb25nXCIpO1xuICAgIGNvbnN0IHRyYWNrZXIgPSBzdGF0ZS5jcmVhdGVUcmFja2VyKGluZm8pO1xuICAgIGxldCB2YWx1ZSA9IHRyYWNrZXIubW92ZShtYXJrZXIgKyBtYXJrZXIpO1xuICAgIHZhbHVlICs9IHRyYWNrZXIubW92ZShcbiAgICAgIHN0YXRlLmNvbnRhaW5lclBocmFzaW5nKG5vZGUsIHtcbiAgICAgICAgYmVmb3JlOiB2YWx1ZSxcbiAgICAgICAgYWZ0ZXI6IG1hcmtlcixcbiAgICAgICAgLi4udHJhY2tlci5jdXJyZW50KClcbiAgICAgIH0pXG4gICAgKTtcbiAgICB2YWx1ZSArPSB0cmFja2VyLm1vdmUobWFya2VyICsgbWFya2VyKTtcbiAgICBleGl0KCk7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9LFxuICBlbXBoYXNpczogKG5vZGUsIF8sIHN0YXRlLCBpbmZvKSA9PiB7XG4gICAgY29uc3QgbWFya2VyID0gbm9kZS5tYXJrZXIgfHwgc3RhdGUub3B0aW9ucy5lbXBoYXNpcyB8fCBcIipcIjtcbiAgICBjb25zdCBleGl0ID0gc3RhdGUuZW50ZXIoXCJlbXBoYXNpc1wiKTtcbiAgICBjb25zdCB0cmFja2VyID0gc3RhdGUuY3JlYXRlVHJhY2tlcihpbmZvKTtcbiAgICBsZXQgdmFsdWUgPSB0cmFja2VyLm1vdmUobWFya2VyKTtcbiAgICB2YWx1ZSArPSB0cmFja2VyLm1vdmUoXG4gICAgICBzdGF0ZS5jb250YWluZXJQaHJhc2luZyhub2RlLCB7XG4gICAgICAgIGJlZm9yZTogdmFsdWUsXG4gICAgICAgIGFmdGVyOiBtYXJrZXIsXG4gICAgICAgIC4uLnRyYWNrZXIuY3VycmVudCgpXG4gICAgICB9KVxuICAgICk7XG4gICAgdmFsdWUgKz0gdHJhY2tlci5tb3ZlKG1hcmtlcik7XG4gICAgZXhpdCgpO1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufTtcbmNvbnN0IGVkaXRvclZpZXdDdHggPSBjcmVhdGVTbGljZSh7fSwgXCJlZGl0b3JWaWV3XCIpO1xuY29uc3QgZWRpdG9yU3RhdGVDdHggPSBjcmVhdGVTbGljZSh7fSwgXCJlZGl0b3JTdGF0ZVwiKTtcbmNvbnN0IGluaXRUaW1lckN0eCA9IGNyZWF0ZVNsaWNlKFtdLCBcImluaXRUaW1lclwiKTtcbmNvbnN0IGVkaXRvckN0eCA9IGNyZWF0ZVNsaWNlKHt9LCBcImVkaXRvclwiKTtcbmNvbnN0IGlucHV0UnVsZXNDdHggPSBjcmVhdGVTbGljZShbXSwgXCJpbnB1dFJ1bGVzXCIpO1xuY29uc3QgcHJvc2VQbHVnaW5zQ3R4ID0gY3JlYXRlU2xpY2UoW10sIFwicHJvc2VQbHVnaW5zXCIpO1xuY29uc3QgcmVtYXJrUGx1Z2luc0N0eCA9IGNyZWF0ZVNsaWNlKFxuICBbXSxcbiAgXCJyZW1hcmtQbHVnaW5zXCJcbik7XG5jb25zdCBub2RlVmlld0N0eCA9IGNyZWF0ZVNsaWNlKFtdLCBcIm5vZGVWaWV3XCIpO1xuY29uc3QgbWFya1ZpZXdDdHggPSBjcmVhdGVTbGljZShbXSwgXCJtYXJrVmlld1wiKTtcbmNvbnN0IHJlbWFya0N0eCA9IGNyZWF0ZVNsaWNlKFxuICB1bmlmaWVkKCkudXNlKHJlbWFya1BhcnNlKS51c2UocmVtYXJrU3RyaW5naWZ5KSxcbiAgXCJyZW1hcmtcIlxuKTtcbmNvbnN0IHJlbWFya1N0cmluZ2lmeU9wdGlvbnNDdHggPSBjcmVhdGVTbGljZShcbiAge1xuICAgIGhhbmRsZXJzOiByZW1hcmtIYW5kbGVyc1xuICB9LFxuICBcInJlbWFya1N0cmluZ2lmeU9wdGlvbnNcIlxuKTtcbmNvbnN0IENvbmZpZ1JlYWR5ID0gY3JlYXRlVGltZXIoXCJDb25maWdSZWFkeVwiKTtcbmZ1bmN0aW9uIGNvbmZpZyhjb25maWd1cmUpIHtcbiAgY29uc3QgcGx1Z2luID0gKGN0eCkgPT4ge1xuICAgIGN0eC5yZWNvcmQoQ29uZmlnUmVhZHkpO1xuICAgIHJldHVybiBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBjb25maWd1cmUoY3R4KTtcbiAgICAgIGN0eC5kb25lKENvbmZpZ1JlYWR5KTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGN0eC5jbGVhclRpbWVyKENvbmZpZ1JlYWR5KTtcbiAgICAgIH07XG4gICAgfTtcbiAgfTtcbiAgd2l0aE1ldGEocGx1Z2luLCB7XG4gICAgZGlzcGxheU5hbWU6IFwiQ29uZmlnXCJcbiAgfSk7XG4gIHJldHVybiBwbHVnaW47XG59XG5jb25zdCBJbml0UmVhZHkgPSBjcmVhdGVUaW1lcihcIkluaXRSZWFkeVwiKTtcbmZ1bmN0aW9uIGluaXQoZWRpdG9yKSB7XG4gIGNvbnN0IHBsdWdpbiA9IChjdHgpID0+IHtcbiAgICBjdHguaW5qZWN0KGVkaXRvckN0eCwgZWRpdG9yKS5pbmplY3QocHJvc2VQbHVnaW5zQ3R4LCBbXSkuaW5qZWN0KHJlbWFya1BsdWdpbnNDdHgsIFtdKS5pbmplY3QoaW5wdXRSdWxlc0N0eCwgW10pLmluamVjdChub2RlVmlld0N0eCwgW10pLmluamVjdChtYXJrVmlld0N0eCwgW10pLmluamVjdChyZW1hcmtTdHJpbmdpZnlPcHRpb25zQ3R4LCB7XG4gICAgICBoYW5kbGVyczogcmVtYXJrSGFuZGxlcnNcbiAgICB9KS5pbmplY3QocmVtYXJrQ3R4LCB1bmlmaWVkKCkudXNlKHJlbWFya1BhcnNlKS51c2UocmVtYXJrU3RyaW5naWZ5KSkuaW5qZWN0KGluaXRUaW1lckN0eCwgW0NvbmZpZ1JlYWR5XSkucmVjb3JkKEluaXRSZWFkeSk7XG4gICAgcmV0dXJuIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGN0eC53YWl0VGltZXJzKGluaXRUaW1lckN0eCk7XG4gICAgICBjb25zdCBvcHRpb25zID0gY3R4LmdldChyZW1hcmtTdHJpbmdpZnlPcHRpb25zQ3R4KTtcbiAgICAgIGN0eC5zZXQoXG4gICAgICAgIHJlbWFya0N0eCxcbiAgICAgICAgdW5pZmllZCgpLnVzZShyZW1hcmtQYXJzZSkudXNlKHJlbWFya1N0cmluZ2lmeSwgb3B0aW9ucylcbiAgICAgICk7XG4gICAgICBjdHguZG9uZShJbml0UmVhZHkpO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgY3R4LnJlbW92ZShlZGl0b3JDdHgpLnJlbW92ZShwcm9zZVBsdWdpbnNDdHgpLnJlbW92ZShyZW1hcmtQbHVnaW5zQ3R4KS5yZW1vdmUoaW5wdXRSdWxlc0N0eCkucmVtb3ZlKG5vZGVWaWV3Q3R4KS5yZW1vdmUobWFya1ZpZXdDdHgpLnJlbW92ZShyZW1hcmtTdHJpbmdpZnlPcHRpb25zQ3R4KS5yZW1vdmUocmVtYXJrQ3R4KS5yZW1vdmUoaW5pdFRpbWVyQ3R4KS5jbGVhclRpbWVyKEluaXRSZWFkeSk7XG4gICAgICB9O1xuICAgIH07XG4gIH07XG4gIHdpdGhNZXRhKHBsdWdpbiwge1xuICAgIGRpc3BsYXlOYW1lOiBcIkluaXRcIlxuICB9KTtcbiAgcmV0dXJuIHBsdWdpbjtcbn1cbmNvbnN0IFNjaGVtYVJlYWR5ID0gY3JlYXRlVGltZXIoXCJTY2hlbWFSZWFkeVwiKTtcbmNvbnN0IHNjaGVtYVRpbWVyQ3R4ID0gY3JlYXRlU2xpY2UoW10sIFwic2NoZW1hVGltZXJcIik7XG5jb25zdCBzY2hlbWFDdHggPSBjcmVhdGVTbGljZSh7fSwgXCJzY2hlbWFcIik7XG5jb25zdCBub2Rlc0N0eCA9IGNyZWF0ZVNsaWNlKFtdLCBcIm5vZGVzXCIpO1xuY29uc3QgbWFya3NDdHggPSBjcmVhdGVTbGljZShbXSwgXCJtYXJrc1wiKTtcbmZ1bmN0aW9uIGV4dGVuZFByaW9yaXR5KHgpIHtcbiAgdmFyIF9hO1xuICByZXR1cm4ge1xuICAgIC4uLngsXG4gICAgcGFyc2VET006IChfYSA9IHgucGFyc2VET00pID09IG51bGwgPyB2b2lkIDAgOiBfYS5tYXAoKHJ1bGUpID0+ICh7IHByaW9yaXR5OiB4LnByaW9yaXR5LCAuLi5ydWxlIH0pKVxuICB9O1xufVxuY29uc3Qgc2NoZW1hID0gKGN0eCkgPT4ge1xuICBjdHguaW5qZWN0KHNjaGVtYUN0eCwge30pLmluamVjdChub2Rlc0N0eCwgW10pLmluamVjdChtYXJrc0N0eCwgW10pLmluamVjdChzY2hlbWFUaW1lckN0eCwgW0luaXRSZWFkeV0pLnJlY29yZChTY2hlbWFSZWFkeSk7XG4gIHJldHVybiBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY3R4LndhaXRUaW1lcnMoc2NoZW1hVGltZXJDdHgpO1xuICAgIGNvbnN0IHJlbWFyayA9IGN0eC5nZXQocmVtYXJrQ3R4KTtcbiAgICBjb25zdCByZW1hcmtQbHVnaW5zID0gY3R4LmdldChyZW1hcmtQbHVnaW5zQ3R4KTtcbiAgICBjb25zdCBwcm9jZXNzb3IgPSByZW1hcmtQbHVnaW5zLnJlZHVjZShcbiAgICAgIChhY2MsIHBsdWcpID0+IGFjYy51c2UocGx1Zy5wbHVnaW4sIHBsdWcub3B0aW9ucyksXG4gICAgICByZW1hcmtcbiAgICApO1xuICAgIGN0eC5zZXQocmVtYXJrQ3R4LCBwcm9jZXNzb3IpO1xuICAgIGNvbnN0IG5vZGVzID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgY3R4LmdldChub2Rlc0N0eCkubWFwKChba2V5MiwgeF0pID0+IFtrZXkyLCBleHRlbmRQcmlvcml0eSh4KV0pXG4gICAgKTtcbiAgICBjb25zdCBtYXJrcyA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgIGN0eC5nZXQobWFya3NDdHgpLm1hcCgoW2tleTIsIHhdKSA9PiBba2V5MiwgZXh0ZW5kUHJpb3JpdHkoeCldKVxuICAgICk7XG4gICAgY29uc3Qgc2NoZW1hMiA9IG5ldyBTY2hlbWEoeyBub2RlcywgbWFya3MgfSk7XG4gICAgY3R4LnNldChzY2hlbWFDdHgsIHNjaGVtYTIpO1xuICAgIGN0eC5kb25lKFNjaGVtYVJlYWR5KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY3R4LnJlbW92ZShzY2hlbWFDdHgpLnJlbW92ZShub2Rlc0N0eCkucmVtb3ZlKG1hcmtzQ3R4KS5yZW1vdmUoc2NoZW1hVGltZXJDdHgpLmNsZWFyVGltZXIoU2NoZW1hUmVhZHkpO1xuICAgIH07XG4gIH07XG59O1xud2l0aE1ldGEoc2NoZW1hLCB7XG4gIGRpc3BsYXlOYW1lOiBcIlNjaGVtYVwiXG59KTtcbmNsYXNzIENvbW1hbmRNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jb250YWluZXIpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY3R4KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2NvbnRhaW5lciwgbmV3IENvbnRhaW5lcigpKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2N0eCwgbnVsbCk7XG4gICAgdGhpcy5zZXRDdHggPSAoY3R4KSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2N0eCwgY3R4KTtcbiAgICB9O1xuICAgIHRoaXMuY2hhaW4gPSAoKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9jdHgpID09IG51bGwpIHRocm93IGNhbGxDb21tYW5kQmVmb3JlRWRpdG9yVmlldygpO1xuICAgICAgY29uc3QgY3R4ID0gX19wcml2YXRlR2V0KHRoaXMsIF9jdHgpO1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gW107XG4gICAgICBjb25zdCBnZXQgPSB0aGlzLmdldDtcbiAgICAgIGNvbnN0IGNoYWlucyA9IHtcbiAgICAgICAgcnVuOiAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2hhaW5lZCA9IGNoYWluQ29tbWFuZHMoLi4uY29tbWFuZHMyKTtcbiAgICAgICAgICBjb25zdCB2aWV3ID0gY3R4LmdldChlZGl0b3JWaWV3Q3R4KTtcbiAgICAgICAgICByZXR1cm4gY2hhaW5lZCh2aWV3LnN0YXRlLCB2aWV3LmRpc3BhdGNoLCB2aWV3KTtcbiAgICAgICAgfSxcbiAgICAgICAgaW5saW5lOiAoY29tbWFuZCkgPT4ge1xuICAgICAgICAgIGNvbW1hbmRzMi5wdXNoKGNvbW1hbmQpO1xuICAgICAgICAgIHJldHVybiBjaGFpbnM7XG4gICAgICAgIH0sXG4gICAgICAgIHBpcGVcbiAgICAgIH07XG4gICAgICBmdW5jdGlvbiBwaXBlKHNsaWNlLCBwYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IGNtZCA9IGdldChzbGljZSk7XG4gICAgICAgIGNvbW1hbmRzMi5wdXNoKGNtZChwYXlsb2FkKSk7XG4gICAgICAgIHJldHVybiBjaGFpbnM7XG4gICAgICB9XG4gICAgICByZXR1cm4gY2hhaW5zO1xuICAgIH07XG4gIH1cbiAgZ2V0IGN0eCgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9jdHgpO1xuICB9XG4gIC8vLyBSZWdpc3RlciBhIGNvbW1hbmQgaW50byB0aGUgbWFuYWdlci5cbiAgY3JlYXRlKG1ldGEsIHZhbHVlKSB7XG4gICAgY29uc3Qgc2xpY2UgPSBtZXRhLmNyZWF0ZShfX3ByaXZhdGVHZXQodGhpcywgX2NvbnRhaW5lcikuc2xpY2VNYXApO1xuICAgIHNsaWNlLnNldCh2YWx1ZSk7XG4gICAgcmV0dXJuIHNsaWNlO1xuICB9XG4gIGdldChzbGljZSkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2NvbnRhaW5lcikuZ2V0KHNsaWNlKS5nZXQoKTtcbiAgfVxuICByZW1vdmUoc2xpY2UpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9jb250YWluZXIpLnJlbW92ZShzbGljZSk7XG4gIH1cbiAgY2FsbChzbGljZSwgcGF5bG9hZCkge1xuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX2N0eCkgPT0gbnVsbCkgdGhyb3cgY2FsbENvbW1hbmRCZWZvcmVFZGl0b3JWaWV3KCk7XG4gICAgY29uc3QgY21kID0gdGhpcy5nZXQoc2xpY2UpO1xuICAgIGNvbnN0IGNvbW1hbmQgPSBjbWQocGF5bG9hZCk7XG4gICAgY29uc3QgdmlldyA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfY3R4KS5nZXQoZWRpdG9yVmlld0N0eCk7XG4gICAgcmV0dXJuIGNvbW1hbmQodmlldy5zdGF0ZSwgdmlldy5kaXNwYXRjaCwgdmlldyk7XG4gIH1cbiAgLy8vIENhbGwgYW4gaW5saW5lIGNvbW1hbmQuXG4gIGlubGluZShjb21tYW5kKSB7XG4gICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfY3R4KSA9PSBudWxsKSB0aHJvdyBjYWxsQ29tbWFuZEJlZm9yZUVkaXRvclZpZXcoKTtcbiAgICBjb25zdCB2aWV3ID0gX19wcml2YXRlR2V0KHRoaXMsIF9jdHgpLmdldChlZGl0b3JWaWV3Q3R4KTtcbiAgICByZXR1cm4gY29tbWFuZCh2aWV3LnN0YXRlLCB2aWV3LmRpc3BhdGNoLCB2aWV3KTtcbiAgfVxufVxuX2NvbnRhaW5lciA9IG5ldyBXZWFrTWFwKCk7XG5fY3R4ID0gbmV3IFdlYWtNYXAoKTtcbmZ1bmN0aW9uIGNyZWF0ZUNtZEtleShrZXkyID0gXCJjbWRLZXlcIikge1xuICByZXR1cm4gY3JlYXRlU2xpY2UoKCkgPT4gKCkgPT4gZmFsc2UsIGtleTIpO1xufVxuY29uc3QgY29tbWFuZHNDdHggPSBjcmVhdGVTbGljZShuZXcgQ29tbWFuZE1hbmFnZXIoKSwgXCJjb21tYW5kc1wiKTtcbmNvbnN0IGNvbW1hbmRzVGltZXJDdHggPSBjcmVhdGVTbGljZShbU2NoZW1hUmVhZHldLCBcImNvbW1hbmRzVGltZXJcIik7XG5jb25zdCBDb21tYW5kc1JlYWR5ID0gY3JlYXRlVGltZXIoXCJDb21tYW5kc1JlYWR5XCIpO1xuY29uc3QgY29tbWFuZHMgPSAoY3R4KSA9PiB7XG4gIGNvbnN0IGNtZCA9IG5ldyBDb21tYW5kTWFuYWdlcigpO1xuICBjbWQuc2V0Q3R4KGN0eCk7XG4gIGN0eC5pbmplY3QoY29tbWFuZHNDdHgsIGNtZCkuaW5qZWN0KGNvbW1hbmRzVGltZXJDdHgsIFtTY2hlbWFSZWFkeV0pLnJlY29yZChDb21tYW5kc1JlYWR5KTtcbiAgcmV0dXJuIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBjdHgud2FpdFRpbWVycyhjb21tYW5kc1RpbWVyQ3R4KTtcbiAgICBjdHguZG9uZShDb21tYW5kc1JlYWR5KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY3R4LnJlbW92ZShjb21tYW5kc0N0eCkucmVtb3ZlKGNvbW1hbmRzVGltZXJDdHgpLmNsZWFyVGltZXIoQ29tbWFuZHNSZWFkeSk7XG4gICAgfTtcbiAgfTtcbn07XG53aXRoTWV0YShjb21tYW5kcywge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kc1wiXG59KTtcbmNvbnN0IFBhcnNlclJlYWR5ID0gY3JlYXRlVGltZXIoXCJQYXJzZXJSZWFkeVwiKTtcbmNvbnN0IG91dE9mU2NvcGUkMSA9ICgpID0+IHtcbiAgdGhyb3cgY3R4Q2FsbE91dE9mU2NvcGUoKTtcbn07XG5jb25zdCBwYXJzZXJDdHggPSBjcmVhdGVTbGljZShvdXRPZlNjb3BlJDEsIFwicGFyc2VyXCIpO1xuY29uc3QgcGFyc2VyVGltZXJDdHggPSBjcmVhdGVTbGljZShbXSwgXCJwYXJzZXJUaW1lclwiKTtcbmNvbnN0IHBhcnNlciA9IChjdHgpID0+IHtcbiAgY3R4LmluamVjdChwYXJzZXJDdHgsIG91dE9mU2NvcGUkMSkuaW5qZWN0KHBhcnNlclRpbWVyQ3R4LCBbU2NoZW1hUmVhZHldKS5yZWNvcmQoUGFyc2VyUmVhZHkpO1xuICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGN0eC53YWl0VGltZXJzKHBhcnNlclRpbWVyQ3R4KTtcbiAgICBjb25zdCByZW1hcmsgPSBjdHguZ2V0KHJlbWFya0N0eCk7XG4gICAgY29uc3Qgc2NoZW1hMiA9IGN0eC5nZXQoc2NoZW1hQ3R4KTtcbiAgICBjdHguc2V0KHBhcnNlckN0eCwgUGFyc2VyU3RhdGUuY3JlYXRlKHNjaGVtYTIsIHJlbWFyaykpO1xuICAgIGN0eC5kb25lKFBhcnNlclJlYWR5KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY3R4LnJlbW92ZShwYXJzZXJDdHgpLnJlbW92ZShwYXJzZXJUaW1lckN0eCkuY2xlYXJUaW1lcihQYXJzZXJSZWFkeSk7XG4gICAgfTtcbiAgfTtcbn07XG53aXRoTWV0YShwYXJzZXIsIHtcbiAgZGlzcGxheU5hbWU6IFwiUGFyc2VyXCJcbn0pO1xuY29uc3QgU2VyaWFsaXplclJlYWR5ID0gY3JlYXRlVGltZXIoXCJTZXJpYWxpemVyUmVhZHlcIik7XG5jb25zdCBzZXJpYWxpemVyVGltZXJDdHggPSBjcmVhdGVTbGljZShcbiAgW10sXG4gIFwic2VyaWFsaXplclRpbWVyXCJcbik7XG5jb25zdCBvdXRPZlNjb3BlID0gKCkgPT4ge1xuICB0aHJvdyBjdHhDYWxsT3V0T2ZTY29wZSgpO1xufTtcbmNvbnN0IHNlcmlhbGl6ZXJDdHggPSBjcmVhdGVTbGljZShcbiAgb3V0T2ZTY29wZSxcbiAgXCJzZXJpYWxpemVyXCJcbik7XG5jb25zdCBzZXJpYWxpemVyID0gKGN0eCkgPT4ge1xuICBjdHguaW5qZWN0KHNlcmlhbGl6ZXJDdHgsIG91dE9mU2NvcGUpLmluamVjdChzZXJpYWxpemVyVGltZXJDdHgsIFtTY2hlbWFSZWFkeV0pLnJlY29yZChTZXJpYWxpemVyUmVhZHkpO1xuICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGN0eC53YWl0VGltZXJzKHNlcmlhbGl6ZXJUaW1lckN0eCk7XG4gICAgY29uc3QgcmVtYXJrID0gY3R4LmdldChyZW1hcmtDdHgpO1xuICAgIGNvbnN0IHNjaGVtYTIgPSBjdHguZ2V0KHNjaGVtYUN0eCk7XG4gICAgY3R4LnNldChzZXJpYWxpemVyQ3R4LCBTZXJpYWxpemVyU3RhdGUuY3JlYXRlKHNjaGVtYTIsIHJlbWFyaykpO1xuICAgIGN0eC5kb25lKFNlcmlhbGl6ZXJSZWFkeSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGN0eC5yZW1vdmUoc2VyaWFsaXplckN0eCkucmVtb3ZlKHNlcmlhbGl6ZXJUaW1lckN0eCkuY2xlYXJUaW1lcihTZXJpYWxpemVyUmVhZHkpO1xuICAgIH07XG4gIH07XG59O1xud2l0aE1ldGEoc2VyaWFsaXplciwge1xuICBkaXNwbGF5TmFtZTogXCJTZXJpYWxpemVyXCJcbn0pO1xuY29uc3QgZGVmYXVsdFZhbHVlQ3R4ID0gY3JlYXRlU2xpY2UoXCJcIiwgXCJkZWZhdWx0VmFsdWVcIik7XG5jb25zdCBlZGl0b3JTdGF0ZU9wdGlvbnNDdHggPSBjcmVhdGVTbGljZShcbiAgKHgpID0+IHgsXG4gIFwic3RhdGVPcHRpb25zXCJcbik7XG5jb25zdCBlZGl0b3JTdGF0ZVRpbWVyQ3R4ID0gY3JlYXRlU2xpY2UoXG4gIFtdLFxuICBcImVkaXRvclN0YXRlVGltZXJcIlxuKTtcbmNvbnN0IEVkaXRvclN0YXRlUmVhZHkgPSBjcmVhdGVUaW1lcihcIkVkaXRvclN0YXRlUmVhZHlcIik7XG5mdW5jdGlvbiBnZXREb2MoZGVmYXVsdFZhbHVlLCBwYXJzZXIyLCBzY2hlbWEyKSB7XG4gIGlmICh0eXBlb2YgZGVmYXVsdFZhbHVlID09PSBcInN0cmluZ1wiKSByZXR1cm4gcGFyc2VyMihkZWZhdWx0VmFsdWUpO1xuICBpZiAoZGVmYXVsdFZhbHVlLnR5cGUgPT09IFwiaHRtbFwiKVxuICAgIHJldHVybiBET01QYXJzZXIuZnJvbVNjaGVtYShzY2hlbWEyKS5wYXJzZShkZWZhdWx0VmFsdWUuZG9tKTtcbiAgaWYgKGRlZmF1bHRWYWx1ZS50eXBlID09PSBcImpzb25cIilcbiAgICByZXR1cm4gTm9kZS5mcm9tSlNPTihzY2hlbWEyLCBkZWZhdWx0VmFsdWUudmFsdWUpO1xuICB0aHJvdyBkb2NUeXBlRXJyb3IoZGVmYXVsdFZhbHVlKTtcbn1cbmNvbnN0IGtleSQxID0gbmV3IFBsdWdpbktleShcIk1JTEtET1dOX1NUQVRFX1RSQUNLRVJcIik7XG5mdW5jdGlvbiBvdmVycmlkZUJhc2VLZXltYXAoa2V5bWFwMikge1xuICBjb25zdCBoYW5kbGVCYWNrc3BhY2UgPSBjaGFpbkNvbW1hbmRzKFxuICAgIHVuZG9JbnB1dFJ1bGUsXG4gICAgZGVsZXRlU2VsZWN0aW9uLFxuICAgIGpvaW5CYWNrd2FyZCxcbiAgICBzZWxlY3ROb2RlQmFja3dhcmRcbiAgKTtcbiAga2V5bWFwMi5CYWNrc3BhY2UgPSBoYW5kbGVCYWNrc3BhY2U7XG4gIHJldHVybiBrZXltYXAyO1xufVxuY29uc3QgZWRpdG9yU3RhdGUgPSAoY3R4KSA9PiB7XG4gIGN0eC5pbmplY3QoZGVmYXVsdFZhbHVlQ3R4LCBcIlwiKS5pbmplY3QoZWRpdG9yU3RhdGVDdHgsIHt9KS5pbmplY3QoZWRpdG9yU3RhdGVPcHRpb25zQ3R4LCAoeCkgPT4geCkuaW5qZWN0KGVkaXRvclN0YXRlVGltZXJDdHgsIFtQYXJzZXJSZWFkeSwgU2VyaWFsaXplclJlYWR5LCBDb21tYW5kc1JlYWR5XSkucmVjb3JkKEVkaXRvclN0YXRlUmVhZHkpO1xuICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGN0eC53YWl0VGltZXJzKGVkaXRvclN0YXRlVGltZXJDdHgpO1xuICAgIGNvbnN0IHNjaGVtYTIgPSBjdHguZ2V0KHNjaGVtYUN0eCk7XG4gICAgY29uc3QgcGFyc2VyMiA9IGN0eC5nZXQocGFyc2VyQ3R4KTtcbiAgICBjb25zdCBydWxlcyA9IGN0eC5nZXQoaW5wdXRSdWxlc0N0eCk7XG4gICAgY29uc3Qgb3B0aW9uc092ZXJyaWRlID0gY3R4LmdldChlZGl0b3JTdGF0ZU9wdGlvbnNDdHgpO1xuICAgIGNvbnN0IHByb3NlUGx1Z2lucyA9IGN0eC5nZXQocHJvc2VQbHVnaW5zQ3R4KTtcbiAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBjdHguZ2V0KGRlZmF1bHRWYWx1ZUN0eCk7XG4gICAgY29uc3QgZG9jID0gZ2V0RG9jKGRlZmF1bHRWYWx1ZSwgcGFyc2VyMiwgc2NoZW1hMik7XG4gICAgY29uc3QgcGx1Z2lucyA9IFtcbiAgICAgIC4uLnByb3NlUGx1Z2lucyxcbiAgICAgIG5ldyBQbHVnaW4oe1xuICAgICAgICBrZXk6IGtleSQxLFxuICAgICAgICBzdGF0ZToge1xuICAgICAgICAgIGluaXQ6ICgpID0+IHtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFwcGx5OiAoX3RyLCBfdmFsdWUsIF9vbGRTdGF0ZSwgbmV3U3RhdGUpID0+IHtcbiAgICAgICAgICAgIGN0eC5zZXQoZWRpdG9yU3RhdGVDdHgsIG5ld1N0YXRlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgY3VzdG9tSW5wdXRSdWxlcyh7IHJ1bGVzIH0pLFxuICAgICAga2V5bWFwKG92ZXJyaWRlQmFzZUtleW1hcChiYXNlS2V5bWFwKSlcbiAgICBdO1xuICAgIGN0eC5zZXQocHJvc2VQbHVnaW5zQ3R4LCBwbHVnaW5zKTtcbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uc092ZXJyaWRlKHtcbiAgICAgIHNjaGVtYTogc2NoZW1hMixcbiAgICAgIGRvYyxcbiAgICAgIHBsdWdpbnNcbiAgICB9KTtcbiAgICBjb25zdCBzdGF0ZSA9IEVkaXRvclN0YXRlLmNyZWF0ZShvcHRpb25zKTtcbiAgICBjdHguc2V0KGVkaXRvclN0YXRlQ3R4LCBzdGF0ZSk7XG4gICAgY3R4LmRvbmUoRWRpdG9yU3RhdGVSZWFkeSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGN0eC5yZW1vdmUoZGVmYXVsdFZhbHVlQ3R4KS5yZW1vdmUoZWRpdG9yU3RhdGVDdHgpLnJlbW92ZShlZGl0b3JTdGF0ZU9wdGlvbnNDdHgpLnJlbW92ZShlZGl0b3JTdGF0ZVRpbWVyQ3R4KS5jbGVhclRpbWVyKEVkaXRvclN0YXRlUmVhZHkpO1xuICAgIH07XG4gIH07XG59O1xud2l0aE1ldGEoZWRpdG9yU3RhdGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiRWRpdG9yU3RhdGVcIlxufSk7XG5jb25zdCBFZGl0b3JWaWV3UmVhZHkgPSBjcmVhdGVUaW1lcihcIkVkaXRvclZpZXdSZWFkeVwiKTtcbmNvbnN0IGVkaXRvclZpZXdUaW1lckN0eCA9IGNyZWF0ZVNsaWNlKFxuICBbXSxcbiAgXCJlZGl0b3JWaWV3VGltZXJcIlxuKTtcbmNvbnN0IGVkaXRvclZpZXdPcHRpb25zQ3R4ID0gY3JlYXRlU2xpY2UoXG4gIHt9LFxuICBcImVkaXRvclZpZXdPcHRpb25zXCJcbik7XG5jb25zdCByb290Q3R4ID0gY3JlYXRlU2xpY2UobnVsbCwgXCJyb290XCIpO1xuY29uc3Qgcm9vdERPTUN0eCA9IGNyZWF0ZVNsaWNlKG51bGwsIFwicm9vdERPTVwiKTtcbmNvbnN0IHJvb3RBdHRyc0N0eCA9IGNyZWF0ZVNsaWNlKFxuICB7fSxcbiAgXCJyb290QXR0cnNcIlxuKTtcbmZ1bmN0aW9uIGNyZWF0ZVZpZXdDb250YWluZXIocm9vdCwgY3R4KSB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnRhaW5lci5jbGFzc05hbWUgPSBcIm1pbGtkb3duXCI7XG4gIHJvb3QuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgY3R4LnNldChyb290RE9NQ3R4LCBjb250YWluZXIpO1xuICBjb25zdCBhdHRycyA9IGN0eC5nZXQocm9vdEF0dHJzQ3R4KTtcbiAgT2JqZWN0LmVudHJpZXMoYXR0cnMpLmZvckVhY2goXG4gICAgKFtrZXkyLCB2YWx1ZV0pID0+IGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoa2V5MiwgdmFsdWUpXG4gICk7XG4gIHJldHVybiBjb250YWluZXI7XG59XG5mdW5jdGlvbiBwcmVwYXJlVmlld0RvbShkb20pIHtcbiAgZG9tLmNsYXNzTGlzdC5hZGQoXCJlZGl0b3JcIik7XG4gIGRvbS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwidGV4dGJveFwiKTtcbn1cbmNvbnN0IGtleSA9IG5ldyBQbHVnaW5LZXkoXCJNSUxLRE9XTl9WSUVXX0NMRUFSXCIpO1xuY29uc3QgZWRpdG9yVmlldyA9IChjdHgpID0+IHtcbiAgY3R4LmluamVjdChyb290Q3R4LCBkb2N1bWVudC5ib2R5KS5pbmplY3QoZWRpdG9yVmlld0N0eCwge30pLmluamVjdChlZGl0b3JWaWV3T3B0aW9uc0N0eCwge30pLmluamVjdChyb290RE9NQ3R4LCBudWxsKS5pbmplY3Qocm9vdEF0dHJzQ3R4LCB7fSkuaW5qZWN0KGVkaXRvclZpZXdUaW1lckN0eCwgW0VkaXRvclN0YXRlUmVhZHldKS5yZWNvcmQoRWRpdG9yVmlld1JlYWR5KTtcbiAgcmV0dXJuIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBjdHgud2FpdChJbml0UmVhZHkpO1xuICAgIGNvbnN0IHJvb3QgPSBjdHguZ2V0KHJvb3RDdHgpIHx8IGRvY3VtZW50LmJvZHk7XG4gICAgY29uc3QgZWwgPSB0eXBlb2Ygcm9vdCA9PT0gXCJzdHJpbmdcIiA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iocm9vdCkgOiByb290O1xuICAgIGN0eC51cGRhdGUocHJvc2VQbHVnaW5zQ3R4LCAoeHMpID0+IFtcbiAgICAgIG5ldyBQbHVnaW4oe1xuICAgICAgICBrZXksXG4gICAgICAgIHZpZXc6IChlZGl0b3JWaWV3MikgPT4ge1xuICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGVsID8gY3JlYXRlVmlld0NvbnRhaW5lcihlbCwgY3R4KSA6IHZvaWQgMDtcbiAgICAgICAgICBjb25zdCBoYW5kbGVET00gPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyICYmIGVsKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IGVkaXRvclZpZXcyLmRvbTtcbiAgICAgICAgICAgICAgZWwucmVwbGFjZUNoaWxkKGNvbnRhaW5lciwgZWRpdG9yKTtcbiAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBoYW5kbGVET00oKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGVzdHJveTogKCkgPT4ge1xuICAgICAgICAgICAgICBpZiAoY29udGFpbmVyID09IG51bGwgPyB2b2lkIDAgOiBjb250YWluZXIucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICBjb250YWluZXIgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbnRhaW5lci5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChlZGl0b3JWaWV3Mi5kb20sIGNvbnRhaW5lcik7XG4gICAgICAgICAgICAgIGNvbnRhaW5lciA9PSBudWxsID8gdm9pZCAwIDogY29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgLi4ueHNcbiAgICBdKTtcbiAgICBhd2FpdCBjdHgud2FpdFRpbWVycyhlZGl0b3JWaWV3VGltZXJDdHgpO1xuICAgIGNvbnN0IHN0YXRlID0gY3R4LmdldChlZGl0b3JTdGF0ZUN0eCk7XG4gICAgY29uc3Qgb3B0aW9ucyA9IGN0eC5nZXQoZWRpdG9yVmlld09wdGlvbnNDdHgpO1xuICAgIGNvbnN0IG5vZGVWaWV3cyA9IE9iamVjdC5mcm9tRW50cmllcyhjdHguZ2V0KG5vZGVWaWV3Q3R4KSk7XG4gICAgY29uc3QgbWFya1ZpZXdzID0gT2JqZWN0LmZyb21FbnRyaWVzKGN0eC5nZXQobWFya1ZpZXdDdHgpKTtcbiAgICBjb25zdCB2aWV3ID0gbmV3IEVkaXRvclZpZXcoZWwsIHtcbiAgICAgIHN0YXRlLFxuICAgICAgbm9kZVZpZXdzLFxuICAgICAgbWFya1ZpZXdzLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH0pO1xuICAgIHByZXBhcmVWaWV3RG9tKHZpZXcuZG9tKTtcbiAgICBjdHguc2V0KGVkaXRvclZpZXdDdHgsIHZpZXcpO1xuICAgIGN0eC5kb25lKEVkaXRvclZpZXdSZWFkeSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHZpZXcgPT0gbnVsbCA/IHZvaWQgMCA6IHZpZXcuZGVzdHJveSgpO1xuICAgICAgY3R4LnJlbW92ZShyb290Q3R4KS5yZW1vdmUoZWRpdG9yVmlld0N0eCkucmVtb3ZlKGVkaXRvclZpZXdPcHRpb25zQ3R4KS5yZW1vdmUocm9vdERPTUN0eCkucmVtb3ZlKHJvb3RBdHRyc0N0eCkucmVtb3ZlKGVkaXRvclZpZXdUaW1lckN0eCkuY2xlYXJUaW1lcihFZGl0b3JWaWV3UmVhZHkpO1xuICAgIH07XG4gIH07XG59O1xud2l0aE1ldGEoZWRpdG9yVmlldywge1xuICBkaXNwbGF5TmFtZTogXCJFZGl0b3JWaWV3XCJcbn0pO1xudmFyIEVkaXRvclN0YXR1cyA9IC8qIEBfX1BVUkVfXyAqLyAoKEVkaXRvclN0YXR1czIpID0+IHtcbiAgRWRpdG9yU3RhdHVzMltcIklkbGVcIl0gPSBcIklkbGVcIjtcbiAgRWRpdG9yU3RhdHVzMltcIk9uQ3JlYXRlXCJdID0gXCJPbkNyZWF0ZVwiO1xuICBFZGl0b3JTdGF0dXMyW1wiQ3JlYXRlZFwiXSA9IFwiQ3JlYXRlZFwiO1xuICBFZGl0b3JTdGF0dXMyW1wiT25EZXN0cm95XCJdID0gXCJPbkRlc3Ryb3lcIjtcbiAgRWRpdG9yU3RhdHVzMltcIkRlc3Ryb3llZFwiXSA9IFwiRGVzdHJveWVkXCI7XG4gIHJldHVybiBFZGl0b3JTdGF0dXMyO1xufSkoRWRpdG9yU3RhdHVzIHx8IHt9KTtcbmNvbnN0IF9FZGl0b3IgPSBjbGFzcyBfRWRpdG9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9lbmFibGVJbnNwZWN0b3IpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfc3RhdHVzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2NvbmZpZ3VyZUxpc3QpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfb25TdGF0dXNDaGFuZ2UpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY29udGFpbmVyMik7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jbG9jayk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF91c3JQbHVnaW5TdG9yZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9zeXNQbHVnaW5TdG9yZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jdHgyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2xvYWRJbnRlcm5hbCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9wcmVwYXJlKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2NsZWFudXApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY2xlYW51cEludGVybmFsKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3NldFN0YXR1cyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9sb2FkUGx1Z2luSW5TdG9yZSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9lbmFibGVJbnNwZWN0b3IsIGZhbHNlKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3N0YXR1cywgXCJJZGxlXCIpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY29uZmlndXJlTGlzdCwgW10pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfb25TdGF0dXNDaGFuZ2UsICgpID0+IHZvaWQgMCk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jb250YWluZXIyLCBuZXcgQ29udGFpbmVyKCkpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY2xvY2ssIG5ldyBDbG9jaygpKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3VzclBsdWdpblN0b3JlLCAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3N5c1BsdWdpblN0b3JlLCAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2N0eDIsIG5ldyBDdHgoX19wcml2YXRlR2V0KHRoaXMsIF9jb250YWluZXIyKSwgX19wcml2YXRlR2V0KHRoaXMsIF9jbG9jaykpKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2xvYWRJbnRlcm5hbCwgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnUGx1Z2luID0gY29uZmlnKGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoX19wcml2YXRlR2V0KHRoaXMsIF9jb25maWd1cmVMaXN0KS5tYXAoKGZuKSA9PiBmbihjdHgpKSk7XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGludGVybmFsUGx1Z2lucyA9IFtcbiAgICAgICAgc2NoZW1hLFxuICAgICAgICBwYXJzZXIsXG4gICAgICAgIHNlcmlhbGl6ZXIsXG4gICAgICAgIGNvbW1hbmRzLFxuICAgICAgICBlZGl0b3JTdGF0ZSxcbiAgICAgICAgZWRpdG9yVmlldyxcbiAgICAgICAgaW5pdCh0aGlzKSxcbiAgICAgICAgY29uZmlnUGx1Z2luXG4gICAgICBdO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9wcmVwYXJlKS5jYWxsKHRoaXMsIGludGVybmFsUGx1Z2lucywgX19wcml2YXRlR2V0KHRoaXMsIF9zeXNQbHVnaW5TdG9yZSkpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcHJlcGFyZSwgKHBsdWdpbnMsIHN0b3JlKSA9PiB7XG4gICAgICBwbHVnaW5zLmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgICAgICBjb25zdCBjdHggPSBfX3ByaXZhdGVHZXQodGhpcywgX2N0eDIpLnByb2R1Y2UoXG4gICAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9lbmFibGVJbnNwZWN0b3IpID8gcGx1Z2luLm1ldGEgOiB2b2lkIDBcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgaGFuZGxlciA9IHBsdWdpbihjdHgpO1xuICAgICAgICBzdG9yZS5zZXQocGx1Z2luLCB7IGN0eCwgaGFuZGxlciwgY2xlYW51cDogdm9pZCAwIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jbGVhbnVwLCAocGx1Z2lucywgcmVtb3ZlID0gZmFsc2UpID0+IHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChcbiAgICAgICAgW3BsdWdpbnNdLmZsYXQoKS5tYXAoKHBsdWdpbikgPT4ge1xuICAgICAgICAgIGNvbnN0IGxvYWRlciA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfdXNyUGx1Z2luU3RvcmUpLmdldChwbHVnaW4pO1xuICAgICAgICAgIGNvbnN0IGNsZWFudXAgPSBsb2FkZXIgPT0gbnVsbCA/IHZvaWQgMCA6IGxvYWRlci5jbGVhbnVwO1xuICAgICAgICAgIGlmIChyZW1vdmUpIF9fcHJpdmF0ZUdldCh0aGlzLCBfdXNyUGx1Z2luU3RvcmUpLmRlbGV0ZShwbHVnaW4pO1xuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfdXNyUGx1Z2luU3RvcmUpLnNldChwbHVnaW4sIHtcbiAgICAgICAgICAgICAgY3R4OiB2b2lkIDAsXG4gICAgICAgICAgICAgIGhhbmRsZXI6IHZvaWQgMCxcbiAgICAgICAgICAgICAgY2xlYW51cDogdm9pZCAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAodHlwZW9mIGNsZWFudXAgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGNsZWFudXAoKTtcbiAgICAgICAgICByZXR1cm4gY2xlYW51cDtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jbGVhbnVwSW50ZXJuYWwsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBbLi4uX19wcml2YXRlR2V0KHRoaXMsIF9zeXNQbHVnaW5TdG9yZSkuZW50cmllcygpXS5tYXAoKFtfLCB7IGNsZWFudXAgfV0pID0+IHtcbiAgICAgICAgICBpZiAodHlwZW9mIGNsZWFudXAgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGNsZWFudXAoKTtcbiAgICAgICAgICByZXR1cm4gY2xlYW51cDtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3N5c1BsdWdpblN0b3JlKS5jbGVhcigpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfc2V0U3RhdHVzLCAoc3RhdHVzKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3N0YXR1cywgc3RhdHVzKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfb25TdGF0dXNDaGFuZ2UpLmNhbGwodGhpcywgc3RhdHVzKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2xvYWRQbHVnaW5JblN0b3JlLCAoc3RvcmUpID0+IHtcbiAgICAgIHJldHVybiBbLi4uc3RvcmUuZW50cmllcygpXS5tYXAoYXN5bmMgKFtrZXkyLCBsb2FkZXJdKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgY3R4LCBoYW5kbGVyIH0gPSBsb2FkZXI7XG4gICAgICAgIGlmICghaGFuZGxlcikgcmV0dXJuO1xuICAgICAgICBjb25zdCBjbGVhbnVwID0gYXdhaXQgaGFuZGxlcigpO1xuICAgICAgICBzdG9yZS5zZXQoa2V5MiwgeyBjdHgsIGhhbmRsZXIsIGNsZWFudXAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLmVuYWJsZUluc3BlY3RvciA9IChlbmFibGUgPSB0cnVlKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2VuYWJsZUluc3BlY3RvciwgZW5hYmxlKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5vblN0YXR1c0NoYW5nZSA9IChvbkNoYW5nZSkgPT4ge1xuICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9vblN0YXR1c0NoYW5nZSwgb25DaGFuZ2UpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLmNvbmZpZyA9IChjb25maWd1cmUpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29uZmlndXJlTGlzdCkucHVzaChjb25maWd1cmUpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnJlbW92ZUNvbmZpZyA9IChjb25maWd1cmUpID0+IHtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY29uZmlndXJlTGlzdCwgX19wcml2YXRlR2V0KHRoaXMsIF9jb25maWd1cmVMaXN0KS5maWx0ZXIoKHgpID0+IHggIT09IGNvbmZpZ3VyZSkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnVzZSA9IChwbHVnaW5zKSA9PiB7XG4gICAgICBjb25zdCBfcGx1Z2lucyA9IFtwbHVnaW5zXS5mbGF0KCk7XG4gICAgICBfcGx1Z2lucy5mbGF0KCkuZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfdXNyUGx1Z2luU3RvcmUpLnNldChwbHVnaW4sIHtcbiAgICAgICAgICBjdHg6IHZvaWQgMCxcbiAgICAgICAgICBoYW5kbGVyOiB2b2lkIDAsXG4gICAgICAgICAgY2xlYW51cDogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9zdGF0dXMpID09PSBcIkNyZWF0ZWRcIilcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9wcmVwYXJlKS5jYWxsKHRoaXMsIF9wbHVnaW5zLCBfX3ByaXZhdGVHZXQodGhpcywgX3VzclBsdWdpblN0b3JlKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMucmVtb3ZlID0gYXN5bmMgKHBsdWdpbnMpID0+IHtcbiAgICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3N0YXR1cykgPT09IFwiT25DcmVhdGVcIikge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJbTWlsa2Rvd25dOiBZb3UgYXJlIHRyeWluZyB0byByZW1vdmUgcGx1Z2lucyB3aGVuIHRoZSBlZGl0b3IgaXMgY3JlYXRpbmcsIHRoaXMgaXMgbm90IHJlY29tbWVuZGVkLCBwbGVhc2UgY2hlY2sgeW91ciBjb2RlLlwiXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlbW92ZShwbHVnaW5zKSk7XG4gICAgICAgICAgfSwgNTApO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IF9fcHJpdmF0ZUdldCh0aGlzLCBfY2xlYW51cCkuY2FsbCh0aGlzLCBbcGx1Z2luc10uZmxhdCgpLCB0cnVlKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5jcmVhdGUgPSBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9zdGF0dXMpID09PSBcIk9uQ3JlYXRlXCIpIHJldHVybiB0aGlzO1xuICAgICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfc3RhdHVzKSA9PT0gXCJDcmVhdGVkXCIpIGF3YWl0IHRoaXMuZGVzdHJveSgpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRTdGF0dXMpLmNhbGwodGhpcywgXCJPbkNyZWF0ZVwiKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbG9hZEludGVybmFsKS5jYWxsKHRoaXMpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9wcmVwYXJlKS5jYWxsKHRoaXMsIFsuLi5fX3ByaXZhdGVHZXQodGhpcywgX3VzclBsdWdpblN0b3JlKS5rZXlzKCldLCBfX3ByaXZhdGVHZXQodGhpcywgX3VzclBsdWdpblN0b3JlKSk7XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgW1xuICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbG9hZFBsdWdpbkluU3RvcmUpLmNhbGwodGhpcywgX19wcml2YXRlR2V0KHRoaXMsIF9zeXNQbHVnaW5TdG9yZSkpLFxuICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfbG9hZFBsdWdpbkluU3RvcmUpLmNhbGwodGhpcywgX19wcml2YXRlR2V0KHRoaXMsIF91c3JQbHVnaW5TdG9yZSkpXG4gICAgICAgIF0uZmxhdCgpXG4gICAgICApO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9zZXRTdGF0dXMpLmNhbGwodGhpcywgXCJDcmVhdGVkXCIpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLmRlc3Ryb3kgPSBhc3luYyAoY2xlYXJQbHVnaW5zID0gZmFsc2UpID0+IHtcbiAgICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3N0YXR1cykgPT09IFwiRGVzdHJveWVkXCIgfHwgX19wcml2YXRlR2V0KHRoaXMsIF9zdGF0dXMpID09PSBcIk9uRGVzdHJveVwiKVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3N0YXR1cykgPT09IFwiT25DcmVhdGVcIikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUodGhpcy5kZXN0cm95KGNsZWFyUGx1Z2lucykpO1xuICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoY2xlYXJQbHVnaW5zKSBfX3ByaXZhdGVTZXQodGhpcywgX2NvbmZpZ3VyZUxpc3QsIFtdKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfc2V0U3RhdHVzKS5jYWxsKHRoaXMsIFwiT25EZXN0cm95XCIpO1xuICAgICAgYXdhaXQgX19wcml2YXRlR2V0KHRoaXMsIF9jbGVhbnVwKS5jYWxsKHRoaXMsIFsuLi5fX3ByaXZhdGVHZXQodGhpcywgX3VzclBsdWdpblN0b3JlKS5rZXlzKCldLCBjbGVhclBsdWdpbnMpO1xuICAgICAgYXdhaXQgX19wcml2YXRlR2V0KHRoaXMsIF9jbGVhbnVwSW50ZXJuYWwpLmNhbGwodGhpcyk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3NldFN0YXR1cykuY2FsbCh0aGlzLCBcIkRlc3Ryb3llZFwiKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5hY3Rpb24gPSAoYWN0aW9uKSA9PiBhY3Rpb24oX19wcml2YXRlR2V0KHRoaXMsIF9jdHgyKSk7XG4gICAgdGhpcy5pbnNwZWN0ID0gKCkgPT4ge1xuICAgICAgaWYgKCFfX3ByaXZhdGVHZXQodGhpcywgX2VuYWJsZUluc3BlY3RvcikpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIFwiW01pbGtkb3duXTogWW91IGFyZSB0cnlpbmcgdG8gY29sbGVjdCBpbnNwZWN0aW9uIHdoZW4gaW5zcGVjdG9yIGlzIGRpc2FibGVkLCBwbGVhc2UgZW5hYmxlIGluc3BlY3RvciBieSBgZWRpdG9yLmVuYWJsZUluc3BlY3RvcigpYCBmaXJzdC5cIlxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICByZXR1cm4gWy4uLl9fcHJpdmF0ZUdldCh0aGlzLCBfc3lzUGx1Z2luU3RvcmUpLnZhbHVlcygpLCAuLi5fX3ByaXZhdGVHZXQodGhpcywgX3VzclBsdWdpblN0b3JlKS52YWx1ZXMoKV0ubWFwKCh7IGN0eCB9KSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IGN0eCA9PSBudWxsID8gdm9pZCAwIDogY3R4Lmluc3BlY3RvcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnJlYWQoKTtcbiAgICAgIH0pLmZpbHRlcigoeCkgPT4gQm9vbGVhbih4KSk7XG4gICAgfTtcbiAgfVxuICAvLy8gQ3JlYXRlIGEgbmV3IGVkaXRvciBpbnN0YW5jZS5cbiAgc3RhdGljIG1ha2UoKSB7XG4gICAgcmV0dXJuIG5ldyBfRWRpdG9yKCk7XG4gIH1cbiAgLy8vIEdldCB0aGUgY3R4IG9mIHRoZSBlZGl0b3IuXG4gIGdldCBjdHgoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfY3R4Mik7XG4gIH1cbiAgLy8vIEdldCB0aGUgc3RhdHVzIG9mIHRoZSBlZGl0b3IuXG4gIGdldCBzdGF0dXMoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfc3RhdHVzKTtcbiAgfVxufTtcbl9lbmFibGVJbnNwZWN0b3IgPSBuZXcgV2Vha01hcCgpO1xuX3N0YXR1cyA9IG5ldyBXZWFrTWFwKCk7XG5fY29uZmlndXJlTGlzdCA9IG5ldyBXZWFrTWFwKCk7XG5fb25TdGF0dXNDaGFuZ2UgPSBuZXcgV2Vha01hcCgpO1xuX2NvbnRhaW5lcjIgPSBuZXcgV2Vha01hcCgpO1xuX2Nsb2NrID0gbmV3IFdlYWtNYXAoKTtcbl91c3JQbHVnaW5TdG9yZSA9IG5ldyBXZWFrTWFwKCk7XG5fc3lzUGx1Z2luU3RvcmUgPSBuZXcgV2Vha01hcCgpO1xuX2N0eDIgPSBuZXcgV2Vha01hcCgpO1xuX2xvYWRJbnRlcm5hbCA9IG5ldyBXZWFrTWFwKCk7XG5fcHJlcGFyZSA9IG5ldyBXZWFrTWFwKCk7XG5fY2xlYW51cCA9IG5ldyBXZWFrTWFwKCk7XG5fY2xlYW51cEludGVybmFsID0gbmV3IFdlYWtNYXAoKTtcbl9zZXRTdGF0dXMgPSBuZXcgV2Vha01hcCgpO1xuX2xvYWRQbHVnaW5JblN0b3JlID0gbmV3IFdlYWtNYXAoKTtcbmxldCBFZGl0b3IgPSBfRWRpdG9yO1xuZXhwb3J0IHtcbiAgQ29tbWFuZE1hbmFnZXIsXG4gIENvbW1hbmRzUmVhZHksXG4gIENvbmZpZ1JlYWR5LFxuICBFZGl0b3IsXG4gIEVkaXRvclN0YXRlUmVhZHksXG4gIEVkaXRvclN0YXR1cyxcbiAgRWRpdG9yVmlld1JlYWR5LFxuICBJbml0UmVhZHksXG4gIFBhcnNlclJlYWR5LFxuICBTY2hlbWFSZWFkeSxcbiAgU2VyaWFsaXplclJlYWR5LFxuICBjb21tYW5kcyxcbiAgY29tbWFuZHNDdHgsXG4gIGNvbW1hbmRzVGltZXJDdHgsXG4gIGNvbmZpZyxcbiAgY3JlYXRlQ21kS2V5LFxuICBkZWZhdWx0VmFsdWVDdHgsXG4gIGVkaXRvckN0eCxcbiAgZWRpdG9yU3RhdGUsXG4gIGVkaXRvclN0YXRlQ3R4LFxuICBlZGl0b3JTdGF0ZU9wdGlvbnNDdHgsXG4gIGVkaXRvclN0YXRlVGltZXJDdHgsXG4gIGVkaXRvclZpZXcsXG4gIGVkaXRvclZpZXdDdHgsXG4gIGVkaXRvclZpZXdPcHRpb25zQ3R4LFxuICBlZGl0b3JWaWV3VGltZXJDdHgsXG4gIGdldERvYyxcbiAgaW5pdCxcbiAgaW5pdFRpbWVyQ3R4LFxuICBpbnB1dFJ1bGVzQ3R4LFxuICBtYXJrVmlld0N0eCxcbiAgbWFya3NDdHgsXG4gIG5vZGVWaWV3Q3R4LFxuICBub2Rlc0N0eCxcbiAgcGFyc2VyLFxuICBwYXJzZXJDdHgsXG4gIHBhcnNlclRpbWVyQ3R4LFxuICBwcm9zZVBsdWdpbnNDdHgsXG4gIHJlbWFya0N0eCxcbiAgcmVtYXJrUGx1Z2luc0N0eCxcbiAgcmVtYXJrU3RyaW5naWZ5T3B0aW9uc0N0eCxcbiAgcm9vdEF0dHJzQ3R4LFxuICByb290Q3R4LFxuICByb290RE9NQ3R4LFxuICBzY2hlbWEsXG4gIHNjaGVtYUN0eCxcbiAgc2NoZW1hVGltZXJDdHgsXG4gIHNlcmlhbGl6ZXIsXG4gIHNlcmlhbGl6ZXJDdHgsXG4gIHNlcmlhbGl6ZXJUaW1lckN0eFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/core/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/ctx/lib/index.js":
/*!*************************************************!*\
  !*** ./node_modules/@milkdown/ctx/lib/index.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Clock: () => (/* binding */ Clock),\n/* harmony export */   Container: () => (/* binding */ Container),\n/* harmony export */   Ctx: () => (/* binding */ Ctx),\n/* harmony export */   Inspector: () => (/* binding */ Inspector),\n/* harmony export */   Slice: () => (/* binding */ Slice),\n/* harmony export */   SliceType: () => (/* binding */ SliceType),\n/* harmony export */   Timer: () => (/* binding */ Timer),\n/* harmony export */   TimerType: () => (/* binding */ TimerType),\n/* harmony export */   createSlice: () => (/* binding */ createSlice),\n/* harmony export */   createTimer: () => (/* binding */ createTimer)\n/* harmony export */ });\n/* harmony import */ var _milkdown_exception__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @milkdown/exception */ \"(ssr)/./node_modules/@milkdown/exception/lib/index.js\");\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\nvar _watchers, _value, _emit, _meta, _container, _clock, _injectedSlices, _consumedSlices, _recordedTimers, _waitTimers, _getSlice, _getTimer, _container2, _clock2, _meta2, _inspector, _promise, _listener, _eventUniqId, _status, _removeListener, _waitTimeout;\n\nclass Container {\n  constructor() {\n    this.sliceMap = /* @__PURE__ */ new Map();\n    this.get = (slice) => {\n      const context = typeof slice === \"string\" ? [...this.sliceMap.values()].find((x) => x.type.name === slice) : this.sliceMap.get(slice.id);\n      if (!context) {\n        const name = typeof slice === \"string\" ? slice : slice.name;\n        throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.contextNotFound)(name);\n      }\n      return context;\n    };\n    this.remove = (slice) => {\n      const context = typeof slice === \"string\" ? [...this.sliceMap.values()].find((x) => x.type.name === slice) : this.sliceMap.get(slice.id);\n      if (!context) return;\n      this.sliceMap.delete(context.type.id);\n    };\n    this.has = (slice) => {\n      if (typeof slice === \"string\")\n        return [...this.sliceMap.values()].some((x) => x.type.name === slice);\n      return this.sliceMap.has(slice.id);\n    };\n  }\n}\nclass Slice {\n  /// @internal\n  constructor(container, value, type) {\n    __privateAdd(this, _watchers);\n    /// @internal\n    __privateAdd(this, _value);\n    __privateAdd(this, _emit);\n    __privateSet(this, _watchers, []);\n    __privateSet(this, _emit, () => {\n      __privateGet(this, _watchers).forEach((watcher) => watcher(__privateGet(this, _value)));\n    });\n    this.set = (value2) => {\n      __privateSet(this, _value, value2);\n      __privateGet(this, _emit).call(this);\n    };\n    this.get = () => __privateGet(this, _value);\n    this.update = (updater) => {\n      __privateSet(this, _value, updater(__privateGet(this, _value)));\n      __privateGet(this, _emit).call(this);\n    };\n    this.type = type;\n    __privateSet(this, _value, value);\n    container.set(type.id, this);\n  }\n  /// Add a watcher for changes in the slice.\n  /// Returns a function to remove the watcher.\n  on(watcher) {\n    __privateGet(this, _watchers).push(watcher);\n    return () => {\n      __privateSet(this, _watchers, __privateGet(this, _watchers).filter((w) => w !== watcher));\n    };\n  }\n  /// Add a one-time watcher for changes in the slice.\n  /// The watcher will be removed after it is called.\n  /// Returns a function to remove the watcher.\n  once(watcher) {\n    const off = this.on((value) => {\n      watcher(value);\n      off();\n    });\n    return off;\n  }\n  /// Remove a watcher.\n  off(watcher) {\n    __privateSet(this, _watchers, __privateGet(this, _watchers).filter((w) => w !== watcher));\n  }\n  /// Remove all watchers.\n  offAll() {\n    __privateSet(this, _watchers, []);\n  }\n}\n_watchers = new WeakMap();\n_value = new WeakMap();\n_emit = new WeakMap();\nclass SliceType {\n  /// Create a slice type with a default value and a name.\n  /// The name should be unique in the container.\n  constructor(value, name) {\n    this.id = Symbol(`Context-${name}`);\n    this.name = name;\n    this._defaultValue = value;\n    this._typeInfo = () => {\n      throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.ctxCallOutOfScope)();\n    };\n  }\n  /// Create a slice with a container.\n  /// You can also pass a value to override the default value.\n  create(container, value = this._defaultValue) {\n    return new Slice(container, value, this);\n  }\n}\nconst createSlice = (value, name) => new SliceType(value, name);\nclass Inspector {\n  /// Create an inspector with container, clock and metadata.\n  constructor(container, clock, meta) {\n    /// @internal\n    __privateAdd(this, _meta);\n    /// @internal\n    __privateAdd(this, _container);\n    /// @internal\n    __privateAdd(this, _clock);\n    __privateAdd(this, _injectedSlices);\n    __privateAdd(this, _consumedSlices);\n    __privateAdd(this, _recordedTimers);\n    __privateAdd(this, _waitTimers);\n    __privateAdd(this, _getSlice);\n    __privateAdd(this, _getTimer);\n    __privateSet(this, _injectedSlices, /* @__PURE__ */ new Set());\n    __privateSet(this, _consumedSlices, /* @__PURE__ */ new Set());\n    __privateSet(this, _recordedTimers, /* @__PURE__ */ new Map());\n    __privateSet(this, _waitTimers, /* @__PURE__ */ new Map());\n    this.read = () => {\n      return {\n        metadata: __privateGet(this, _meta),\n        injectedSlices: [...__privateGet(this, _injectedSlices)].map((slice) => ({\n          name: typeof slice === \"string\" ? slice : slice.name,\n          value: __privateGet(this, _getSlice).call(this, slice)\n        })),\n        consumedSlices: [...__privateGet(this, _consumedSlices)].map((slice) => ({\n          name: typeof slice === \"string\" ? slice : slice.name,\n          value: __privateGet(this, _getSlice).call(this, slice)\n        })),\n        recordedTimers: [...__privateGet(this, _recordedTimers)].map(\n          ([timer, { duration }]) => ({\n            name: timer.name,\n            duration,\n            status: __privateGet(this, _getTimer).call(this, timer)\n          })\n        ),\n        waitTimers: [...__privateGet(this, _waitTimers)].map(([timer, { duration }]) => ({\n          name: timer.name,\n          duration,\n          status: __privateGet(this, _getTimer).call(this, timer)\n        }))\n      };\n    };\n    this.onRecord = (timerType) => {\n      __privateGet(this, _recordedTimers).set(timerType, { start: Date.now(), duration: 0 });\n    };\n    this.onClear = (timerType) => {\n      __privateGet(this, _recordedTimers).delete(timerType);\n    };\n    this.onDone = (timerType) => {\n      const timer = __privateGet(this, _recordedTimers).get(timerType);\n      if (!timer) return;\n      timer.duration = Date.now() - timer.start;\n    };\n    this.onWait = (timerType, promise) => {\n      const start = Date.now();\n      promise.finally(() => {\n        __privateGet(this, _waitTimers).set(timerType, { duration: Date.now() - start });\n      }).catch(console.error);\n    };\n    this.onInject = (sliceType) => {\n      __privateGet(this, _injectedSlices).add(sliceType);\n    };\n    this.onRemove = (sliceType) => {\n      __privateGet(this, _injectedSlices).delete(sliceType);\n    };\n    this.onUse = (sliceType) => {\n      __privateGet(this, _consumedSlices).add(sliceType);\n    };\n    __privateSet(this, _getSlice, (sliceType) => {\n      return __privateGet(this, _container).get(sliceType).get();\n    });\n    __privateSet(this, _getTimer, (timerType) => {\n      return __privateGet(this, _clock).get(timerType).status;\n    });\n    __privateSet(this, _container, container);\n    __privateSet(this, _clock, clock);\n    __privateSet(this, _meta, meta);\n  }\n}\n_meta = new WeakMap();\n_container = new WeakMap();\n_clock = new WeakMap();\n_injectedSlices = new WeakMap();\n_consumedSlices = new WeakMap();\n_recordedTimers = new WeakMap();\n_waitTimers = new WeakMap();\n_getSlice = new WeakMap();\n_getTimer = new WeakMap();\nconst _Ctx = class _Ctx {\n  /// Create a ctx object with container and clock.\n  constructor(container, clock, meta) {\n    /// @internal\n    __privateAdd(this, _container2);\n    /// @internal\n    __privateAdd(this, _clock2);\n    /// @internal\n    __privateAdd(this, _meta2);\n    /// @internal\n    __privateAdd(this, _inspector);\n    this.produce = (meta2) => {\n      if (meta2 && Object.keys(meta2).length)\n        return new _Ctx(__privateGet(this, _container2), __privateGet(this, _clock2), { ...meta2 });\n      return this;\n    };\n    this.inject = (sliceType, value) => {\n      var _a;\n      const slice = sliceType.create(__privateGet(this, _container2).sliceMap);\n      if (value != null) slice.set(value);\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onInject(sliceType);\n      return this;\n    };\n    this.remove = (sliceType) => {\n      var _a;\n      __privateGet(this, _container2).remove(sliceType);\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onRemove(sliceType);\n      return this;\n    };\n    this.record = (timerType) => {\n      var _a;\n      timerType.create(__privateGet(this, _clock2).store);\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onRecord(timerType);\n      return this;\n    };\n    this.clearTimer = (timerType) => {\n      var _a;\n      __privateGet(this, _clock2).remove(timerType);\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onClear(timerType);\n      return this;\n    };\n    this.isInjected = (sliceType) => __privateGet(this, _container2).has(sliceType);\n    this.isRecorded = (timerType) => __privateGet(this, _clock2).has(timerType);\n    this.use = (sliceType) => {\n      var _a;\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onUse(sliceType);\n      return __privateGet(this, _container2).get(sliceType);\n    };\n    this.get = (sliceType) => this.use(sliceType).get();\n    this.set = (sliceType, value) => this.use(sliceType).set(value);\n    this.update = (sliceType, updater) => this.use(sliceType).update(updater);\n    this.timer = (timer) => __privateGet(this, _clock2).get(timer);\n    this.done = (timer) => {\n      var _a;\n      this.timer(timer).done();\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onDone(timer);\n    };\n    this.wait = (timer) => {\n      var _a;\n      const promise = this.timer(timer).start();\n      (_a = __privateGet(this, _inspector)) == null ? void 0 : _a.onWait(timer, promise);\n      return promise;\n    };\n    this.waitTimers = async (slice) => {\n      await Promise.all(this.get(slice).map((x) => this.wait(x)));\n    };\n    __privateSet(this, _container2, container);\n    __privateSet(this, _clock2, clock);\n    __privateSet(this, _meta2, meta);\n    if (meta) __privateSet(this, _inspector, new Inspector(container, clock, meta));\n  }\n  /// Get metadata of the ctx.\n  get meta() {\n    return __privateGet(this, _meta2);\n  }\n  /// Get the inspector of the ctx.\n  get inspector() {\n    return __privateGet(this, _inspector);\n  }\n};\n_container2 = new WeakMap();\n_clock2 = new WeakMap();\n_meta2 = new WeakMap();\n_inspector = new WeakMap();\nlet Ctx = _Ctx;\nclass Clock {\n  constructor() {\n    this.store = /* @__PURE__ */ new Map();\n    this.get = (timer) => {\n      const meta = this.store.get(timer.id);\n      if (!meta) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.timerNotFound)(timer.name);\n      return meta;\n    };\n    this.remove = (timer) => {\n      this.store.delete(timer.id);\n    };\n    this.has = (timer) => {\n      return this.store.has(timer.id);\n    };\n  }\n}\nclass Timer {\n  /// @internal\n  constructor(clock, type) {\n    __privateAdd(this, _promise);\n    __privateAdd(this, _listener);\n    /// @internal\n    __privateAdd(this, _eventUniqId);\n    __privateAdd(this, _status);\n    __privateAdd(this, _removeListener);\n    __privateAdd(this, _waitTimeout);\n    __privateSet(this, _promise, null);\n    __privateSet(this, _listener, null);\n    __privateSet(this, _status, \"pending\");\n    this.start = () => {\n      __privateGet(this, _promise) ?? __privateSet(this, _promise, new Promise((resolve, reject) => {\n        __privateSet(this, _listener, (e) => {\n          if (!(e instanceof CustomEvent)) return;\n          if (e.detail.id === __privateGet(this, _eventUniqId)) {\n            __privateSet(this, _status, \"resolved\");\n            __privateGet(this, _removeListener).call(this);\n            e.stopImmediatePropagation();\n            resolve();\n          }\n        });\n        __privateGet(this, _waitTimeout).call(this, () => {\n          if (__privateGet(this, _status) === \"pending\") __privateSet(this, _status, \"rejected\");\n          __privateGet(this, _removeListener).call(this);\n          reject(new Error(`Timing ${this.type.name} timeout.`));\n        });\n        __privateSet(this, _status, \"pending\");\n        addEventListener(this.type.name, __privateGet(this, _listener));\n      }));\n      return __privateGet(this, _promise);\n    };\n    this.done = () => {\n      const event = new CustomEvent(this.type.name, {\n        detail: { id: __privateGet(this, _eventUniqId) }\n      });\n      dispatchEvent(event);\n    };\n    __privateSet(this, _removeListener, () => {\n      if (__privateGet(this, _listener)) removeEventListener(this.type.name, __privateGet(this, _listener));\n    });\n    __privateSet(this, _waitTimeout, (ifTimeout) => {\n      setTimeout(() => {\n        ifTimeout();\n      }, this.type.timeout);\n    });\n    __privateSet(this, _eventUniqId, Symbol(type.name));\n    this.type = type;\n    clock.set(type.id, this);\n  }\n  /// The status of the timer.\n  /// Can be `pending`, `resolved` or `rejected`.\n  get status() {\n    return __privateGet(this, _status);\n  }\n}\n_promise = new WeakMap();\n_listener = new WeakMap();\n_eventUniqId = new WeakMap();\n_status = new WeakMap();\n_removeListener = new WeakMap();\n_waitTimeout = new WeakMap();\nclass TimerType {\n  /// Create a timer type with a name and a timeout.\n  /// The name should be unique in the clock.\n  constructor(name, timeout = 3e3) {\n    this.create = (clock) => {\n      return new Timer(clock, this);\n    };\n    this.id = Symbol(`Timer-${name}`);\n    this.name = name;\n    this.timeout = timeout;\n  }\n}\nconst createTimer = (name, timeout = 3e3) => new TimerType(name, timeout);\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL2N0eC9saWIvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3dGO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxvRUFBZTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsS0FBSztBQUNyQztBQUNBO0FBQ0E7QUFDQSxZQUFZLHNFQUFpQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxxQkFBcUIsVUFBVTtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSx3RUFBd0UsVUFBVTtBQUNsRjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGdDQUFnQztBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsOEJBQThCO0FBQ3ZGLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RkFBd0YsVUFBVTtBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrRUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGdCQUFnQjtBQUNyRCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQixPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLEtBQUs7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yYWluMi9Eb2N1bWVudHMvbm90ZUNhcmQvbm9kZV9tb2R1bGVzL0BtaWxrZG93bi9jdHgvbGliL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX3R5cGVFcnJvciA9IChtc2cpID0+IHtcbiAgdGhyb3cgVHlwZUVycm9yKG1zZyk7XG59O1xudmFyIF9fYWNjZXNzQ2hlY2sgPSAob2JqLCBtZW1iZXIsIG1zZykgPT4gbWVtYmVyLmhhcyhvYmopIHx8IF9fdHlwZUVycm9yKFwiQ2Fubm90IFwiICsgbXNnKTtcbnZhciBfX3ByaXZhdGVHZXQgPSAob2JqLCBtZW1iZXIsIGdldHRlcikgPT4gKF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwicmVhZCBmcm9tIHByaXZhdGUgZmllbGRcIiksIGdldHRlciA/IGdldHRlci5jYWxsKG9iaikgOiBtZW1iZXIuZ2V0KG9iaikpO1xudmFyIF9fcHJpdmF0ZUFkZCA9IChvYmosIG1lbWJlciwgdmFsdWUpID0+IG1lbWJlci5oYXMob2JqKSA/IF9fdHlwZUVycm9yKFwiQ2Fubm90IGFkZCB0aGUgc2FtZSBwcml2YXRlIG1lbWJlciBtb3JlIHRoYW4gb25jZVwiKSA6IG1lbWJlciBpbnN0YW5jZW9mIFdlYWtTZXQgPyBtZW1iZXIuYWRkKG9iaikgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpO1xudmFyIF9fcHJpdmF0ZVNldCA9IChvYmosIG1lbWJlciwgdmFsdWUsIHNldHRlcikgPT4gKF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZFwiKSwgc2V0dGVyID8gc2V0dGVyLmNhbGwob2JqLCB2YWx1ZSkgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpLCB2YWx1ZSk7XG52YXIgX3dhdGNoZXJzLCBfdmFsdWUsIF9lbWl0LCBfbWV0YSwgX2NvbnRhaW5lciwgX2Nsb2NrLCBfaW5qZWN0ZWRTbGljZXMsIF9jb25zdW1lZFNsaWNlcywgX3JlY29yZGVkVGltZXJzLCBfd2FpdFRpbWVycywgX2dldFNsaWNlLCBfZ2V0VGltZXIsIF9jb250YWluZXIyLCBfY2xvY2syLCBfbWV0YTIsIF9pbnNwZWN0b3IsIF9wcm9taXNlLCBfbGlzdGVuZXIsIF9ldmVudFVuaXFJZCwgX3N0YXR1cywgX3JlbW92ZUxpc3RlbmVyLCBfd2FpdFRpbWVvdXQ7XG5pbXBvcnQgeyBjb250ZXh0Tm90Rm91bmQsIGN0eENhbGxPdXRPZlNjb3BlLCB0aW1lck5vdEZvdW5kIH0gZnJvbSBcIkBtaWxrZG93bi9leGNlcHRpb25cIjtcbmNsYXNzIENvbnRhaW5lciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2xpY2VNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHRoaXMuZ2V0ID0gKHNsaWNlKSA9PiB7XG4gICAgICBjb25zdCBjb250ZXh0ID0gdHlwZW9mIHNsaWNlID09PSBcInN0cmluZ1wiID8gWy4uLnRoaXMuc2xpY2VNYXAudmFsdWVzKCldLmZpbmQoKHgpID0+IHgudHlwZS5uYW1lID09PSBzbGljZSkgOiB0aGlzLnNsaWNlTWFwLmdldChzbGljZS5pZCk7XG4gICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHR5cGVvZiBzbGljZSA9PT0gXCJzdHJpbmdcIiA/IHNsaWNlIDogc2xpY2UubmFtZTtcbiAgICAgICAgdGhyb3cgY29udGV4dE5vdEZvdW5kKG5hbWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfTtcbiAgICB0aGlzLnJlbW92ZSA9IChzbGljZSkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHR5cGVvZiBzbGljZSA9PT0gXCJzdHJpbmdcIiA/IFsuLi50aGlzLnNsaWNlTWFwLnZhbHVlcygpXS5maW5kKCh4KSA9PiB4LnR5cGUubmFtZSA9PT0gc2xpY2UpIDogdGhpcy5zbGljZU1hcC5nZXQoc2xpY2UuaWQpO1xuICAgICAgaWYgKCFjb250ZXh0KSByZXR1cm47XG4gICAgICB0aGlzLnNsaWNlTWFwLmRlbGV0ZShjb250ZXh0LnR5cGUuaWQpO1xuICAgIH07XG4gICAgdGhpcy5oYXMgPSAoc2xpY2UpID0+IHtcbiAgICAgIGlmICh0eXBlb2Ygc2xpY2UgPT09IFwic3RyaW5nXCIpXG4gICAgICAgIHJldHVybiBbLi4udGhpcy5zbGljZU1hcC52YWx1ZXMoKV0uc29tZSgoeCkgPT4geC50eXBlLm5hbWUgPT09IHNsaWNlKTtcbiAgICAgIHJldHVybiB0aGlzLnNsaWNlTWFwLmhhcyhzbGljZS5pZCk7XG4gICAgfTtcbiAgfVxufVxuY2xhc3MgU2xpY2Uge1xuICAvLy8gQGludGVybmFsXG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgdmFsdWUsIHR5cGUpIHtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3dhdGNoZXJzKTtcbiAgICAvLy8gQGludGVybmFsXG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF92YWx1ZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9lbWl0KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3dhdGNoZXJzLCBbXSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9lbWl0LCAoKSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3dhdGNoZXJzKS5mb3JFYWNoKCh3YXRjaGVyKSA9PiB3YXRjaGVyKF9fcHJpdmF0ZUdldCh0aGlzLCBfdmFsdWUpKSk7XG4gICAgfSk7XG4gICAgdGhpcy5zZXQgPSAodmFsdWUyKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3ZhbHVlLCB2YWx1ZTIpO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9lbWl0KS5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgdGhpcy5nZXQgPSAoKSA9PiBfX3ByaXZhdGVHZXQodGhpcywgX3ZhbHVlKTtcbiAgICB0aGlzLnVwZGF0ZSA9ICh1cGRhdGVyKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3ZhbHVlLCB1cGRhdGVyKF9fcHJpdmF0ZUdldCh0aGlzLCBfdmFsdWUpKSk7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2VtaXQpLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfdmFsdWUsIHZhbHVlKTtcbiAgICBjb250YWluZXIuc2V0KHR5cGUuaWQsIHRoaXMpO1xuICB9XG4gIC8vLyBBZGQgYSB3YXRjaGVyIGZvciBjaGFuZ2VzIGluIHRoZSBzbGljZS5cbiAgLy8vIFJldHVybnMgYSBmdW5jdGlvbiB0byByZW1vdmUgdGhlIHdhdGNoZXIuXG4gIG9uKHdhdGNoZXIpIHtcbiAgICBfX3ByaXZhdGVHZXQodGhpcywgX3dhdGNoZXJzKS5wdXNoKHdhdGNoZXIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3dhdGNoZXJzLCBfX3ByaXZhdGVHZXQodGhpcywgX3dhdGNoZXJzKS5maWx0ZXIoKHcpID0+IHcgIT09IHdhdGNoZXIpKTtcbiAgICB9O1xuICB9XG4gIC8vLyBBZGQgYSBvbmUtdGltZSB3YXRjaGVyIGZvciBjaGFuZ2VzIGluIHRoZSBzbGljZS5cbiAgLy8vIFRoZSB3YXRjaGVyIHdpbGwgYmUgcmVtb3ZlZCBhZnRlciBpdCBpcyBjYWxsZWQuXG4gIC8vLyBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gcmVtb3ZlIHRoZSB3YXRjaGVyLlxuICBvbmNlKHdhdGNoZXIpIHtcbiAgICBjb25zdCBvZmYgPSB0aGlzLm9uKCh2YWx1ZSkgPT4ge1xuICAgICAgd2F0Y2hlcih2YWx1ZSk7XG4gICAgICBvZmYoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gb2ZmO1xuICB9XG4gIC8vLyBSZW1vdmUgYSB3YXRjaGVyLlxuICBvZmYod2F0Y2hlcikge1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfd2F0Y2hlcnMsIF9fcHJpdmF0ZUdldCh0aGlzLCBfd2F0Y2hlcnMpLmZpbHRlcigodykgPT4gdyAhPT0gd2F0Y2hlcikpO1xuICB9XG4gIC8vLyBSZW1vdmUgYWxsIHdhdGNoZXJzLlxuICBvZmZBbGwoKSB7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF93YXRjaGVycywgW10pO1xuICB9XG59XG5fd2F0Y2hlcnMgPSBuZXcgV2Vha01hcCgpO1xuX3ZhbHVlID0gbmV3IFdlYWtNYXAoKTtcbl9lbWl0ID0gbmV3IFdlYWtNYXAoKTtcbmNsYXNzIFNsaWNlVHlwZSB7XG4gIC8vLyBDcmVhdGUgYSBzbGljZSB0eXBlIHdpdGggYSBkZWZhdWx0IHZhbHVlIGFuZCBhIG5hbWUuXG4gIC8vLyBUaGUgbmFtZSBzaG91bGQgYmUgdW5pcXVlIGluIHRoZSBjb250YWluZXIuXG4gIGNvbnN0cnVjdG9yKHZhbHVlLCBuYW1lKSB7XG4gICAgdGhpcy5pZCA9IFN5bWJvbChgQ29udGV4dC0ke25hbWV9YCk7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9kZWZhdWx0VmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLl90eXBlSW5mbyA9ICgpID0+IHtcbiAgICAgIHRocm93IGN0eENhbGxPdXRPZlNjb3BlKCk7XG4gICAgfTtcbiAgfVxuICAvLy8gQ3JlYXRlIGEgc2xpY2Ugd2l0aCBhIGNvbnRhaW5lci5cbiAgLy8vIFlvdSBjYW4gYWxzbyBwYXNzIGEgdmFsdWUgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgdmFsdWUuXG4gIGNyZWF0ZShjb250YWluZXIsIHZhbHVlID0gdGhpcy5fZGVmYXVsdFZhbHVlKSB7XG4gICAgcmV0dXJuIG5ldyBTbGljZShjb250YWluZXIsIHZhbHVlLCB0aGlzKTtcbiAgfVxufVxuY29uc3QgY3JlYXRlU2xpY2UgPSAodmFsdWUsIG5hbWUpID0+IG5ldyBTbGljZVR5cGUodmFsdWUsIG5hbWUpO1xuY2xhc3MgSW5zcGVjdG9yIHtcbiAgLy8vIENyZWF0ZSBhbiBpbnNwZWN0b3Igd2l0aCBjb250YWluZXIsIGNsb2NrIGFuZCBtZXRhZGF0YS5cbiAgY29uc3RydWN0b3IoY29udGFpbmVyLCBjbG9jaywgbWV0YSkge1xuICAgIC8vLyBAaW50ZXJuYWxcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21ldGEpO1xuICAgIC8vLyBAaW50ZXJuYWxcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2NvbnRhaW5lcik7XG4gICAgLy8vIEBpbnRlcm5hbFxuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY2xvY2spO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaW5qZWN0ZWRTbGljZXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY29uc3VtZWRTbGljZXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcmVjb3JkZWRUaW1lcnMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfd2FpdFRpbWVycyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9nZXRTbGljZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9nZXRUaW1lcik7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9pbmplY3RlZFNsaWNlcywgLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jb25zdW1lZFNsaWNlcywgLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9yZWNvcmRlZFRpbWVycywgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF93YWl0VGltZXJzLCAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpKTtcbiAgICB0aGlzLnJlYWQgPSAoKSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXRhZGF0YTogX19wcml2YXRlR2V0KHRoaXMsIF9tZXRhKSxcbiAgICAgICAgaW5qZWN0ZWRTbGljZXM6IFsuLi5fX3ByaXZhdGVHZXQodGhpcywgX2luamVjdGVkU2xpY2VzKV0ubWFwKChzbGljZSkgPT4gKHtcbiAgICAgICAgICBuYW1lOiB0eXBlb2Ygc2xpY2UgPT09IFwic3RyaW5nXCIgPyBzbGljZSA6IHNsaWNlLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IF9fcHJpdmF0ZUdldCh0aGlzLCBfZ2V0U2xpY2UpLmNhbGwodGhpcywgc2xpY2UpXG4gICAgICAgIH0pKSxcbiAgICAgICAgY29uc3VtZWRTbGljZXM6IFsuLi5fX3ByaXZhdGVHZXQodGhpcywgX2NvbnN1bWVkU2xpY2VzKV0ubWFwKChzbGljZSkgPT4gKHtcbiAgICAgICAgICBuYW1lOiB0eXBlb2Ygc2xpY2UgPT09IFwic3RyaW5nXCIgPyBzbGljZSA6IHNsaWNlLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IF9fcHJpdmF0ZUdldCh0aGlzLCBfZ2V0U2xpY2UpLmNhbGwodGhpcywgc2xpY2UpXG4gICAgICAgIH0pKSxcbiAgICAgICAgcmVjb3JkZWRUaW1lcnM6IFsuLi5fX3ByaXZhdGVHZXQodGhpcywgX3JlY29yZGVkVGltZXJzKV0ubWFwKFxuICAgICAgICAgIChbdGltZXIsIHsgZHVyYXRpb24gfV0pID0+ICh7XG4gICAgICAgICAgICBuYW1lOiB0aW1lci5uYW1lLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBzdGF0dXM6IF9fcHJpdmF0ZUdldCh0aGlzLCBfZ2V0VGltZXIpLmNhbGwodGhpcywgdGltZXIpXG4gICAgICAgICAgfSlcbiAgICAgICAgKSxcbiAgICAgICAgd2FpdFRpbWVyczogWy4uLl9fcHJpdmF0ZUdldCh0aGlzLCBfd2FpdFRpbWVycyldLm1hcCgoW3RpbWVyLCB7IGR1cmF0aW9uIH1dKSA9PiAoe1xuICAgICAgICAgIG5hbWU6IHRpbWVyLm5hbWUsXG4gICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgc3RhdHVzOiBfX3ByaXZhdGVHZXQodGhpcywgX2dldFRpbWVyKS5jYWxsKHRoaXMsIHRpbWVyKVxuICAgICAgICB9KSlcbiAgICAgIH07XG4gICAgfTtcbiAgICB0aGlzLm9uUmVjb3JkID0gKHRpbWVyVHlwZSkgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9yZWNvcmRlZFRpbWVycykuc2V0KHRpbWVyVHlwZSwgeyBzdGFydDogRGF0ZS5ub3coKSwgZHVyYXRpb246IDAgfSk7XG4gICAgfTtcbiAgICB0aGlzLm9uQ2xlYXIgPSAodGltZXJUeXBlKSA9PiB7XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3JlY29yZGVkVGltZXJzKS5kZWxldGUodGltZXJUeXBlKTtcbiAgICB9O1xuICAgIHRoaXMub25Eb25lID0gKHRpbWVyVHlwZSkgPT4ge1xuICAgICAgY29uc3QgdGltZXIgPSBfX3ByaXZhdGVHZXQodGhpcywgX3JlY29yZGVkVGltZXJzKS5nZXQodGltZXJUeXBlKTtcbiAgICAgIGlmICghdGltZXIpIHJldHVybjtcbiAgICAgIHRpbWVyLmR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHRpbWVyLnN0YXJ0O1xuICAgIH07XG4gICAgdGhpcy5vbldhaXQgPSAodGltZXJUeXBlLCBwcm9taXNlKSA9PiB7XG4gICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICBwcm9taXNlLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3dhaXRUaW1lcnMpLnNldCh0aW1lclR5cGUsIHsgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydCB9KTtcbiAgICAgIH0pLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICAgIH07XG4gICAgdGhpcy5vbkluamVjdCA9IChzbGljZVR5cGUpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5qZWN0ZWRTbGljZXMpLmFkZChzbGljZVR5cGUpO1xuICAgIH07XG4gICAgdGhpcy5vblJlbW92ZSA9IChzbGljZVR5cGUpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5qZWN0ZWRTbGljZXMpLmRlbGV0ZShzbGljZVR5cGUpO1xuICAgIH07XG4gICAgdGhpcy5vblVzZSA9IChzbGljZVR5cGUpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29uc3VtZWRTbGljZXMpLmFkZChzbGljZVR5cGUpO1xuICAgIH07XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9nZXRTbGljZSwgKHNsaWNlVHlwZSkgPT4ge1xuICAgICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfY29udGFpbmVyKS5nZXQoc2xpY2VUeXBlKS5nZXQoKTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2dldFRpbWVyLCAodGltZXJUeXBlKSA9PiB7XG4gICAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9jbG9jaykuZ2V0KHRpbWVyVHlwZSkuc3RhdHVzO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY29udGFpbmVyLCBjb250YWluZXIpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY2xvY2ssIGNsb2NrKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX21ldGEsIG1ldGEpO1xuICB9XG59XG5fbWV0YSA9IG5ldyBXZWFrTWFwKCk7XG5fY29udGFpbmVyID0gbmV3IFdlYWtNYXAoKTtcbl9jbG9jayA9IG5ldyBXZWFrTWFwKCk7XG5faW5qZWN0ZWRTbGljZXMgPSBuZXcgV2Vha01hcCgpO1xuX2NvbnN1bWVkU2xpY2VzID0gbmV3IFdlYWtNYXAoKTtcbl9yZWNvcmRlZFRpbWVycyA9IG5ldyBXZWFrTWFwKCk7XG5fd2FpdFRpbWVycyA9IG5ldyBXZWFrTWFwKCk7XG5fZ2V0U2xpY2UgPSBuZXcgV2Vha01hcCgpO1xuX2dldFRpbWVyID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IF9DdHggPSBjbGFzcyBfQ3R4IHtcbiAgLy8vIENyZWF0ZSBhIGN0eCBvYmplY3Qgd2l0aCBjb250YWluZXIgYW5kIGNsb2NrLlxuICBjb25zdHJ1Y3Rvcihjb250YWluZXIsIGNsb2NrLCBtZXRhKSB7XG4gICAgLy8vIEBpbnRlcm5hbFxuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY29udGFpbmVyMik7XG4gICAgLy8vIEBpbnRlcm5hbFxuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfY2xvY2syKTtcbiAgICAvLy8gQGludGVybmFsXG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tZXRhMik7XG4gICAgLy8vIEBpbnRlcm5hbFxuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaW5zcGVjdG9yKTtcbiAgICB0aGlzLnByb2R1Y2UgPSAobWV0YTIpID0+IHtcbiAgICAgIGlmIChtZXRhMiAmJiBPYmplY3Qua2V5cyhtZXRhMikubGVuZ3RoKVxuICAgICAgICByZXR1cm4gbmV3IF9DdHgoX19wcml2YXRlR2V0KHRoaXMsIF9jb250YWluZXIyKSwgX19wcml2YXRlR2V0KHRoaXMsIF9jbG9jazIpLCB7IC4uLm1ldGEyIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLmluamVjdCA9IChzbGljZVR5cGUsIHZhbHVlKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICBjb25zdCBzbGljZSA9IHNsaWNlVHlwZS5jcmVhdGUoX19wcml2YXRlR2V0KHRoaXMsIF9jb250YWluZXIyKS5zbGljZU1hcCk7XG4gICAgICBpZiAodmFsdWUgIT0gbnVsbCkgc2xpY2Uuc2V0KHZhbHVlKTtcbiAgICAgIChfYSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5zcGVjdG9yKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9uSW5qZWN0KHNsaWNlVHlwZSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMucmVtb3ZlID0gKHNsaWNlVHlwZSkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9jb250YWluZXIyKS5yZW1vdmUoc2xpY2VUeXBlKTtcbiAgICAgIChfYSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5zcGVjdG9yKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9uUmVtb3ZlKHNsaWNlVHlwZSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMucmVjb3JkID0gKHRpbWVyVHlwZSkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgdGltZXJUeXBlLmNyZWF0ZShfX3ByaXZhdGVHZXQodGhpcywgX2Nsb2NrMikuc3RvcmUpO1xuICAgICAgKF9hID0gX19wcml2YXRlR2V0KHRoaXMsIF9pbnNwZWN0b3IpKSA9PSBudWxsID8gdm9pZCAwIDogX2Eub25SZWNvcmQodGltZXJUeXBlKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5jbGVhclRpbWVyID0gKHRpbWVyVHlwZSkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9jbG9jazIpLnJlbW92ZSh0aW1lclR5cGUpO1xuICAgICAgKF9hID0gX19wcml2YXRlR2V0KHRoaXMsIF9pbnNwZWN0b3IpKSA9PSBudWxsID8gdm9pZCAwIDogX2Eub25DbGVhcih0aW1lclR5cGUpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLmlzSW5qZWN0ZWQgPSAoc2xpY2VUeXBlKSA9PiBfX3ByaXZhdGVHZXQodGhpcywgX2NvbnRhaW5lcjIpLmhhcyhzbGljZVR5cGUpO1xuICAgIHRoaXMuaXNSZWNvcmRlZCA9ICh0aW1lclR5cGUpID0+IF9fcHJpdmF0ZUdldCh0aGlzLCBfY2xvY2syKS5oYXModGltZXJUeXBlKTtcbiAgICB0aGlzLnVzZSA9IChzbGljZVR5cGUpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIChfYSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5zcGVjdG9yKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9uVXNlKHNsaWNlVHlwZSk7XG4gICAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9jb250YWluZXIyKS5nZXQoc2xpY2VUeXBlKTtcbiAgICB9O1xuICAgIHRoaXMuZ2V0ID0gKHNsaWNlVHlwZSkgPT4gdGhpcy51c2Uoc2xpY2VUeXBlKS5nZXQoKTtcbiAgICB0aGlzLnNldCA9IChzbGljZVR5cGUsIHZhbHVlKSA9PiB0aGlzLnVzZShzbGljZVR5cGUpLnNldCh2YWx1ZSk7XG4gICAgdGhpcy51cGRhdGUgPSAoc2xpY2VUeXBlLCB1cGRhdGVyKSA9PiB0aGlzLnVzZShzbGljZVR5cGUpLnVwZGF0ZSh1cGRhdGVyKTtcbiAgICB0aGlzLnRpbWVyID0gKHRpbWVyKSA9PiBfX3ByaXZhdGVHZXQodGhpcywgX2Nsb2NrMikuZ2V0KHRpbWVyKTtcbiAgICB0aGlzLmRvbmUgPSAodGltZXIpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIHRoaXMudGltZXIodGltZXIpLmRvbmUoKTtcbiAgICAgIChfYSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5zcGVjdG9yKSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9uRG9uZSh0aW1lcik7XG4gICAgfTtcbiAgICB0aGlzLndhaXQgPSAodGltZXIpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLnRpbWVyKHRpbWVyKS5zdGFydCgpO1xuICAgICAgKF9hID0gX19wcml2YXRlR2V0KHRoaXMsIF9pbnNwZWN0b3IpKSA9PSBudWxsID8gdm9pZCAwIDogX2Eub25XYWl0KHRpbWVyLCBwcm9taXNlKTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG4gICAgdGhpcy53YWl0VGltZXJzID0gYXN5bmMgKHNsaWNlKSA9PiB7XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbCh0aGlzLmdldChzbGljZSkubWFwKCh4KSA9PiB0aGlzLndhaXQoeCkpKTtcbiAgICB9O1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY29udGFpbmVyMiwgY29udGFpbmVyKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2Nsb2NrMiwgY2xvY2spO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWV0YTIsIG1ldGEpO1xuICAgIGlmIChtZXRhKSBfX3ByaXZhdGVTZXQodGhpcywgX2luc3BlY3RvciwgbmV3IEluc3BlY3Rvcihjb250YWluZXIsIGNsb2NrLCBtZXRhKSk7XG4gIH1cbiAgLy8vIEdldCBtZXRhZGF0YSBvZiB0aGUgY3R4LlxuICBnZXQgbWV0YSgpIHtcbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9tZXRhMik7XG4gIH1cbiAgLy8vIEdldCB0aGUgaW5zcGVjdG9yIG9mIHRoZSBjdHguXG4gIGdldCBpbnNwZWN0b3IoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfaW5zcGVjdG9yKTtcbiAgfVxufTtcbl9jb250YWluZXIyID0gbmV3IFdlYWtNYXAoKTtcbl9jbG9jazIgPSBuZXcgV2Vha01hcCgpO1xuX21ldGEyID0gbmV3IFdlYWtNYXAoKTtcbl9pbnNwZWN0b3IgPSBuZXcgV2Vha01hcCgpO1xubGV0IEN0eCA9IF9DdHg7XG5jbGFzcyBDbG9jayB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3RvcmUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHRoaXMuZ2V0ID0gKHRpbWVyKSA9PiB7XG4gICAgICBjb25zdCBtZXRhID0gdGhpcy5zdG9yZS5nZXQodGltZXIuaWQpO1xuICAgICAgaWYgKCFtZXRhKSB0aHJvdyB0aW1lck5vdEZvdW5kKHRpbWVyLm5hbWUpO1xuICAgICAgcmV0dXJuIG1ldGE7XG4gICAgfTtcbiAgICB0aGlzLnJlbW92ZSA9ICh0aW1lcikgPT4ge1xuICAgICAgdGhpcy5zdG9yZS5kZWxldGUodGltZXIuaWQpO1xuICAgIH07XG4gICAgdGhpcy5oYXMgPSAodGltZXIpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnN0b3JlLmhhcyh0aW1lci5pZCk7XG4gICAgfTtcbiAgfVxufVxuY2xhc3MgVGltZXIge1xuICAvLy8gQGludGVybmFsXG4gIGNvbnN0cnVjdG9yKGNsb2NrLCB0eXBlKSB7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9wcm9taXNlKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2xpc3RlbmVyKTtcbiAgICAvLy8gQGludGVybmFsXG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9ldmVudFVuaXFJZCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9zdGF0dXMpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcmVtb3ZlTGlzdGVuZXIpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfd2FpdFRpbWVvdXQpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcHJvbWlzZSwgbnVsbCk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9saXN0ZW5lciwgbnVsbCk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9zdGF0dXMsIFwicGVuZGluZ1wiKTtcbiAgICB0aGlzLnN0YXJ0ID0gKCkgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9wcm9taXNlKSA/PyBfX3ByaXZhdGVTZXQodGhpcywgX3Byb21pc2UsIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9saXN0ZW5lciwgKGUpID0+IHtcbiAgICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgQ3VzdG9tRXZlbnQpKSByZXR1cm47XG4gICAgICAgICAgaWYgKGUuZGV0YWlsLmlkID09PSBfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50VW5pcUlkKSkge1xuICAgICAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9zdGF0dXMsIFwicmVzb2x2ZWRcIik7XG4gICAgICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3JlbW92ZUxpc3RlbmVyKS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3dhaXRUaW1lb3V0KS5jYWxsKHRoaXMsICgpID0+IHtcbiAgICAgICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9zdGF0dXMpID09PSBcInBlbmRpbmdcIikgX19wcml2YXRlU2V0KHRoaXMsIF9zdGF0dXMsIFwicmVqZWN0ZWRcIik7XG4gICAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9yZW1vdmVMaXN0ZW5lcikuY2FsbCh0aGlzKTtcbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBUaW1pbmcgJHt0aGlzLnR5cGUubmFtZX0gdGltZW91dC5gKSk7XG4gICAgICAgIH0pO1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX3N0YXR1cywgXCJwZW5kaW5nXCIpO1xuICAgICAgICBhZGRFdmVudExpc3RlbmVyKHRoaXMudHlwZS5uYW1lLCBfX3ByaXZhdGVHZXQodGhpcywgX2xpc3RlbmVyKSk7XG4gICAgICB9KSk7XG4gICAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9wcm9taXNlKTtcbiAgICB9O1xuICAgIHRoaXMuZG9uZSA9ICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KHRoaXMudHlwZS5uYW1lLCB7XG4gICAgICAgIGRldGFpbDogeyBpZDogX19wcml2YXRlR2V0KHRoaXMsIF9ldmVudFVuaXFJZCkgfVxuICAgICAgfSk7XG4gICAgICBkaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9O1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcmVtb3ZlTGlzdGVuZXIsICgpID0+IHtcbiAgICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX2xpc3RlbmVyKSkgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLnR5cGUubmFtZSwgX19wcml2YXRlR2V0KHRoaXMsIF9saXN0ZW5lcikpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfd2FpdFRpbWVvdXQsIChpZlRpbWVvdXQpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZlRpbWVvdXQoKTtcbiAgICAgIH0sIHRoaXMudHlwZS50aW1lb3V0KTtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX2V2ZW50VW5pcUlkLCBTeW1ib2wodHlwZS5uYW1lKSk7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICBjbG9jay5zZXQodHlwZS5pZCwgdGhpcyk7XG4gIH1cbiAgLy8vIFRoZSBzdGF0dXMgb2YgdGhlIHRpbWVyLlxuICAvLy8gQ2FuIGJlIGBwZW5kaW5nYCwgYHJlc29sdmVkYCBvciBgcmVqZWN0ZWRgLlxuICBnZXQgc3RhdHVzKCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX3N0YXR1cyk7XG4gIH1cbn1cbl9wcm9taXNlID0gbmV3IFdlYWtNYXAoKTtcbl9saXN0ZW5lciA9IG5ldyBXZWFrTWFwKCk7XG5fZXZlbnRVbmlxSWQgPSBuZXcgV2Vha01hcCgpO1xuX3N0YXR1cyA9IG5ldyBXZWFrTWFwKCk7XG5fcmVtb3ZlTGlzdGVuZXIgPSBuZXcgV2Vha01hcCgpO1xuX3dhaXRUaW1lb3V0ID0gbmV3IFdlYWtNYXAoKTtcbmNsYXNzIFRpbWVyVHlwZSB7XG4gIC8vLyBDcmVhdGUgYSB0aW1lciB0eXBlIHdpdGggYSBuYW1lIGFuZCBhIHRpbWVvdXQuXG4gIC8vLyBUaGUgbmFtZSBzaG91bGQgYmUgdW5pcXVlIGluIHRoZSBjbG9jay5cbiAgY29uc3RydWN0b3IobmFtZSwgdGltZW91dCA9IDNlMykge1xuICAgIHRoaXMuY3JlYXRlID0gKGNsb2NrKSA9PiB7XG4gICAgICByZXR1cm4gbmV3IFRpbWVyKGNsb2NrLCB0aGlzKTtcbiAgICB9O1xuICAgIHRoaXMuaWQgPSBTeW1ib2woYFRpbWVyLSR7bmFtZX1gKTtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMudGltZW91dCA9IHRpbWVvdXQ7XG4gIH1cbn1cbmNvbnN0IGNyZWF0ZVRpbWVyID0gKG5hbWUsIHRpbWVvdXQgPSAzZTMpID0+IG5ldyBUaW1lclR5cGUobmFtZSwgdGltZW91dCk7XG5leHBvcnQge1xuICBDbG9jayxcbiAgQ29udGFpbmVyLFxuICBDdHgsXG4gIEluc3BlY3RvcixcbiAgU2xpY2UsXG4gIFNsaWNlVHlwZSxcbiAgVGltZXIsXG4gIFRpbWVyVHlwZSxcbiAgY3JlYXRlU2xpY2UsXG4gIGNyZWF0ZVRpbWVyXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/ctx/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/exception/lib/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/@milkdown/exception/lib/index.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   callCommandBeforeEditorView: () => (/* binding */ callCommandBeforeEditorView),\n/* harmony export */   contextNotFound: () => (/* binding */ contextNotFound),\n/* harmony export */   createNodeInParserFail: () => (/* binding */ createNodeInParserFail),\n/* harmony export */   ctxCallOutOfScope: () => (/* binding */ ctxCallOutOfScope),\n/* harmony export */   ctxNotBind: () => (/* binding */ ctxNotBind),\n/* harmony export */   docTypeError: () => (/* binding */ docTypeError),\n/* harmony export */   expectDomTypeError: () => (/* binding */ expectDomTypeError),\n/* harmony export */   getAtomFromSchemaFail: () => (/* binding */ getAtomFromSchemaFail),\n/* harmony export */   missingMarkInSchema: () => (/* binding */ missingMarkInSchema),\n/* harmony export */   missingNodeInSchema: () => (/* binding */ missingNodeInSchema),\n/* harmony export */   missingRootElement: () => (/* binding */ missingRootElement),\n/* harmony export */   missingYjsDoc: () => (/* binding */ missingYjsDoc),\n/* harmony export */   parserMatchError: () => (/* binding */ parserMatchError),\n/* harmony export */   serializerMatchError: () => (/* binding */ serializerMatchError),\n/* harmony export */   stackOverFlow: () => (/* binding */ stackOverFlow),\n/* harmony export */   timerNotFound: () => (/* binding */ timerNotFound)\n/* harmony export */ });\nvar ErrorCode = /* @__PURE__ */ ((ErrorCode2) => {\n  ErrorCode2[\"docTypeError\"] = \"docTypeError\";\n  ErrorCode2[\"contextNotFound\"] = \"contextNotFound\";\n  ErrorCode2[\"timerNotFound\"] = \"timerNotFound\";\n  ErrorCode2[\"ctxCallOutOfScope\"] = \"ctxCallOutOfScope\";\n  ErrorCode2[\"createNodeInParserFail\"] = \"createNodeInParserFail\";\n  ErrorCode2[\"stackOverFlow\"] = \"stackOverFlow\";\n  ErrorCode2[\"parserMatchError\"] = \"parserMatchError\";\n  ErrorCode2[\"serializerMatchError\"] = \"serializerMatchError\";\n  ErrorCode2[\"getAtomFromSchemaFail\"] = \"getAtomFromSchemaFail\";\n  ErrorCode2[\"expectDomTypeError\"] = \"expectDomTypeError\";\n  ErrorCode2[\"callCommandBeforeEditorView\"] = \"callCommandBeforeEditorView\";\n  ErrorCode2[\"missingRootElement\"] = \"missingRootElement\";\n  ErrorCode2[\"missingNodeInSchema\"] = \"missingNodeInSchema\";\n  ErrorCode2[\"missingMarkInSchema\"] = \"missingMarkInSchema\";\n  ErrorCode2[\"ctxNotBind\"] = \"ctxNotBind\";\n  ErrorCode2[\"missingYjsDoc\"] = \"missingYjsDoc\";\n  return ErrorCode2;\n})(ErrorCode || {});\nclass MilkdownError extends Error {\n  constructor(code, message) {\n    super(message);\n    this.name = \"MilkdownError\";\n    this.code = code;\n  }\n}\nconst functionReplacer = (_, value) => typeof value === \"function\" ? \"[Function]\" : value;\nconst stringify = (x) => JSON.stringify(x, functionReplacer);\nfunction docTypeError(type) {\n  return new MilkdownError(\n    ErrorCode.docTypeError,\n    `Doc type error, unsupported type: ${stringify(type)}`\n  );\n}\nfunction contextNotFound(name) {\n  return new MilkdownError(\n    ErrorCode.contextNotFound,\n    `Context \"${name}\" not found, do you forget to inject it?`\n  );\n}\nfunction timerNotFound(name) {\n  return new MilkdownError(\n    ErrorCode.timerNotFound,\n    `Timer \"${name}\" not found, do you forget to record it?`\n  );\n}\nfunction ctxCallOutOfScope() {\n  return new MilkdownError(\n    ErrorCode.ctxCallOutOfScope,\n    \"Should not call a context out of the plugin.\"\n  );\n}\nfunction createNodeInParserFail(nodeType, attrs, content) {\n  const nodeTypeName = \"name\" in nodeType ? nodeType.name : nodeType;\n  const heading = `Cannot create node for ${nodeTypeName}`;\n  const serialize = (x) => {\n    if (x == null) return \"null\";\n    if (Array.isArray(x)) {\n      return `[${x.map(serialize).join(\", \")}]`;\n    }\n    if (typeof x === \"object\") {\n      if (\"toJSON\" in x && typeof x.toJSON === \"function\") {\n        return JSON.stringify(x.toJSON());\n      }\n      if (\"spec\" in x) {\n        return JSON.stringify(x.spec);\n      }\n      return JSON.stringify(x);\n    }\n    if (typeof x === \"string\" || typeof x === \"number\" || typeof x === \"boolean\") {\n      return JSON.stringify(x);\n    }\n    if (typeof x === \"function\") {\n      return `[Function: ${x.name || \"anonymous\"}]`;\n    }\n    try {\n      return String(x);\n    } catch {\n      return \"[Unserializable]\";\n    }\n  };\n  const headingMessage = [\"[Description]\", heading];\n  const attrsMessage = [\"[Attributes]\", attrs];\n  const contentMessage = [\n    \"[Content]\",\n    (content ?? []).map((node) => {\n      if (!node) return \"null\";\n      if (typeof node === \"object\" && \"type\" in node) {\n        return `${node}`;\n      }\n      return serialize(node);\n    })\n  ];\n  const messages = [headingMessage, attrsMessage, contentMessage].reduce(\n    (acc, [title, value]) => {\n      const message = `${title}: ${serialize(value)}.`;\n      return acc.concat(message);\n    },\n    []\n  );\n  return new MilkdownError(\n    ErrorCode.createNodeInParserFail,\n    messages.join(\"\\n\")\n  );\n}\nfunction stackOverFlow() {\n  return new MilkdownError(\n    ErrorCode.stackOverFlow,\n    \"Stack over flow, cannot pop on an empty stack.\"\n  );\n}\nfunction parserMatchError(node) {\n  return new MilkdownError(\n    ErrorCode.parserMatchError,\n    `Cannot match target parser for node: ${stringify(node)}.`\n  );\n}\nfunction serializerMatchError(node) {\n  return new MilkdownError(\n    ErrorCode.serializerMatchError,\n    `Cannot match target serializer for node: ${stringify(node)}.`\n  );\n}\nfunction getAtomFromSchemaFail(type, name) {\n  return new MilkdownError(\n    ErrorCode.getAtomFromSchemaFail,\n    `Cannot get ${type}: ${name} from schema.`\n  );\n}\nfunction expectDomTypeError(node) {\n  return new MilkdownError(\n    ErrorCode.expectDomTypeError,\n    `Expect to be a dom, but get: ${stringify(node)}.`\n  );\n}\nfunction callCommandBeforeEditorView() {\n  return new MilkdownError(\n    ErrorCode.callCommandBeforeEditorView,\n    \"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized\"\n  );\n}\nfunction missingRootElement() {\n  return new MilkdownError(\n    ErrorCode.missingRootElement,\n    \"Missing root element, milkdown cannot find root element of the editor.\"\n  );\n}\nfunction missingNodeInSchema(name) {\n  return new MilkdownError(\n    ErrorCode.missingNodeInSchema,\n    `Missing node in schema, milkdown cannot find \"${name}\" in schema.`\n  );\n}\nfunction missingMarkInSchema(name) {\n  return new MilkdownError(\n    ErrorCode.missingMarkInSchema,\n    `Missing mark in schema, milkdown cannot find \"${name}\" in schema.`\n  );\n}\nfunction ctxNotBind() {\n  return new MilkdownError(\n    ErrorCode.ctxNotBind,\n    \"Context not bind, please make sure the plugin has been initialized.\"\n  );\n}\nfunction missingYjsDoc() {\n  return new MilkdownError(\n    ErrorCode.missingYjsDoc,\n    \"Missing yjs doc, please make sure you have bind one.\"\n  );\n}\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL2V4Y2VwdGlvbi9saWIvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsaUJBQWlCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxnQkFBZ0I7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixLQUFLO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLEtBQUs7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsYUFBYTtBQUN6RDtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsNEJBQTRCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0JBQXNCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixLQUFLO0FBQ3ZCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLE1BQU0sSUFBSSxpQkFBaUI7QUFDcEQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsZ0JBQWdCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsZ0JBQWdCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsS0FBSyxJQUFJLE1BQU07QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnQkFBZ0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxLQUFLO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsS0FBSztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBa0JFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yYWluMi9Eb2N1bWVudHMvbm90ZUNhcmQvbm9kZV9tb2R1bGVzL0BtaWxrZG93bi9leGNlcHRpb24vbGliL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBFcnJvckNvZGUgPSAvKiBAX19QVVJFX18gKi8gKChFcnJvckNvZGUyKSA9PiB7XG4gIEVycm9yQ29kZTJbXCJkb2NUeXBlRXJyb3JcIl0gPSBcImRvY1R5cGVFcnJvclwiO1xuICBFcnJvckNvZGUyW1wiY29udGV4dE5vdEZvdW5kXCJdID0gXCJjb250ZXh0Tm90Rm91bmRcIjtcbiAgRXJyb3JDb2RlMltcInRpbWVyTm90Rm91bmRcIl0gPSBcInRpbWVyTm90Rm91bmRcIjtcbiAgRXJyb3JDb2RlMltcImN0eENhbGxPdXRPZlNjb3BlXCJdID0gXCJjdHhDYWxsT3V0T2ZTY29wZVwiO1xuICBFcnJvckNvZGUyW1wiY3JlYXRlTm9kZUluUGFyc2VyRmFpbFwiXSA9IFwiY3JlYXRlTm9kZUluUGFyc2VyRmFpbFwiO1xuICBFcnJvckNvZGUyW1wic3RhY2tPdmVyRmxvd1wiXSA9IFwic3RhY2tPdmVyRmxvd1wiO1xuICBFcnJvckNvZGUyW1wicGFyc2VyTWF0Y2hFcnJvclwiXSA9IFwicGFyc2VyTWF0Y2hFcnJvclwiO1xuICBFcnJvckNvZGUyW1wic2VyaWFsaXplck1hdGNoRXJyb3JcIl0gPSBcInNlcmlhbGl6ZXJNYXRjaEVycm9yXCI7XG4gIEVycm9yQ29kZTJbXCJnZXRBdG9tRnJvbVNjaGVtYUZhaWxcIl0gPSBcImdldEF0b21Gcm9tU2NoZW1hRmFpbFwiO1xuICBFcnJvckNvZGUyW1wiZXhwZWN0RG9tVHlwZUVycm9yXCJdID0gXCJleHBlY3REb21UeXBlRXJyb3JcIjtcbiAgRXJyb3JDb2RlMltcImNhbGxDb21tYW5kQmVmb3JlRWRpdG9yVmlld1wiXSA9IFwiY2FsbENvbW1hbmRCZWZvcmVFZGl0b3JWaWV3XCI7XG4gIEVycm9yQ29kZTJbXCJtaXNzaW5nUm9vdEVsZW1lbnRcIl0gPSBcIm1pc3NpbmdSb290RWxlbWVudFwiO1xuICBFcnJvckNvZGUyW1wibWlzc2luZ05vZGVJblNjaGVtYVwiXSA9IFwibWlzc2luZ05vZGVJblNjaGVtYVwiO1xuICBFcnJvckNvZGUyW1wibWlzc2luZ01hcmtJblNjaGVtYVwiXSA9IFwibWlzc2luZ01hcmtJblNjaGVtYVwiO1xuICBFcnJvckNvZGUyW1wiY3R4Tm90QmluZFwiXSA9IFwiY3R4Tm90QmluZFwiO1xuICBFcnJvckNvZGUyW1wibWlzc2luZ1lqc0RvY1wiXSA9IFwibWlzc2luZ1lqc0RvY1wiO1xuICByZXR1cm4gRXJyb3JDb2RlMjtcbn0pKEVycm9yQ29kZSB8fCB7fSk7XG5jbGFzcyBNaWxrZG93bkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJNaWxrZG93bkVycm9yXCI7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgfVxufVxuY29uc3QgZnVuY3Rpb25SZXBsYWNlciA9IChfLCB2YWx1ZSkgPT4gdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIgPyBcIltGdW5jdGlvbl1cIiA6IHZhbHVlO1xuY29uc3Qgc3RyaW5naWZ5ID0gKHgpID0+IEpTT04uc3RyaW5naWZ5KHgsIGZ1bmN0aW9uUmVwbGFjZXIpO1xuZnVuY3Rpb24gZG9jVHlwZUVycm9yKHR5cGUpIHtcbiAgcmV0dXJuIG5ldyBNaWxrZG93bkVycm9yKFxuICAgIEVycm9yQ29kZS5kb2NUeXBlRXJyb3IsXG4gICAgYERvYyB0eXBlIGVycm9yLCB1bnN1cHBvcnRlZCB0eXBlOiAke3N0cmluZ2lmeSh0eXBlKX1gXG4gICk7XG59XG5mdW5jdGlvbiBjb250ZXh0Tm90Rm91bmQobmFtZSkge1xuICByZXR1cm4gbmV3IE1pbGtkb3duRXJyb3IoXG4gICAgRXJyb3JDb2RlLmNvbnRleHROb3RGb3VuZCxcbiAgICBgQ29udGV4dCBcIiR7bmFtZX1cIiBub3QgZm91bmQsIGRvIHlvdSBmb3JnZXQgdG8gaW5qZWN0IGl0P2BcbiAgKTtcbn1cbmZ1bmN0aW9uIHRpbWVyTm90Rm91bmQobmFtZSkge1xuICByZXR1cm4gbmV3IE1pbGtkb3duRXJyb3IoXG4gICAgRXJyb3JDb2RlLnRpbWVyTm90Rm91bmQsXG4gICAgYFRpbWVyIFwiJHtuYW1lfVwiIG5vdCBmb3VuZCwgZG8geW91IGZvcmdldCB0byByZWNvcmQgaXQ/YFxuICApO1xufVxuZnVuY3Rpb24gY3R4Q2FsbE91dE9mU2NvcGUoKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUuY3R4Q2FsbE91dE9mU2NvcGUsXG4gICAgXCJTaG91bGQgbm90IGNhbGwgYSBjb250ZXh0IG91dCBvZiB0aGUgcGx1Z2luLlwiXG4gICk7XG59XG5mdW5jdGlvbiBjcmVhdGVOb2RlSW5QYXJzZXJGYWlsKG5vZGVUeXBlLCBhdHRycywgY29udGVudCkge1xuICBjb25zdCBub2RlVHlwZU5hbWUgPSBcIm5hbWVcIiBpbiBub2RlVHlwZSA/IG5vZGVUeXBlLm5hbWUgOiBub2RlVHlwZTtcbiAgY29uc3QgaGVhZGluZyA9IGBDYW5ub3QgY3JlYXRlIG5vZGUgZm9yICR7bm9kZVR5cGVOYW1lfWA7XG4gIGNvbnN0IHNlcmlhbGl6ZSA9ICh4KSA9PiB7XG4gICAgaWYgKHggPT0gbnVsbCkgcmV0dXJuIFwibnVsbFwiO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHgpKSB7XG4gICAgICByZXR1cm4gYFske3gubWFwKHNlcmlhbGl6ZSkuam9pbihcIiwgXCIpfV1gO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHggPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIGlmIChcInRvSlNPTlwiIGluIHggJiYgdHlwZW9mIHgudG9KU09OID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHgudG9KU09OKCkpO1xuICAgICAgfVxuICAgICAgaWYgKFwic3BlY1wiIGluIHgpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHguc3BlYyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoeCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgeCA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgeCA9PT0gXCJudW1iZXJcIiB8fCB0eXBlb2YgeCA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh4KTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB4ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiBgW0Z1bmN0aW9uOiAke3gubmFtZSB8fCBcImFub255bW91c1wifV1gO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIFN0cmluZyh4KTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBcIltVbnNlcmlhbGl6YWJsZV1cIjtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGhlYWRpbmdNZXNzYWdlID0gW1wiW0Rlc2NyaXB0aW9uXVwiLCBoZWFkaW5nXTtcbiAgY29uc3QgYXR0cnNNZXNzYWdlID0gW1wiW0F0dHJpYnV0ZXNdXCIsIGF0dHJzXTtcbiAgY29uc3QgY29udGVudE1lc3NhZ2UgPSBbXG4gICAgXCJbQ29udGVudF1cIixcbiAgICAoY29udGVudCA/PyBbXSkubWFwKChub2RlKSA9PiB7XG4gICAgICBpZiAoIW5vZGUpIHJldHVybiBcIm51bGxcIjtcbiAgICAgIGlmICh0eXBlb2Ygbm9kZSA9PT0gXCJvYmplY3RcIiAmJiBcInR5cGVcIiBpbiBub2RlKSB7XG4gICAgICAgIHJldHVybiBgJHtub2RlfWA7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2VyaWFsaXplKG5vZGUpO1xuICAgIH0pXG4gIF07XG4gIGNvbnN0IG1lc3NhZ2VzID0gW2hlYWRpbmdNZXNzYWdlLCBhdHRyc01lc3NhZ2UsIGNvbnRlbnRNZXNzYWdlXS5yZWR1Y2UoXG4gICAgKGFjYywgW3RpdGxlLCB2YWx1ZV0pID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHt0aXRsZX06ICR7c2VyaWFsaXplKHZhbHVlKX0uYDtcbiAgICAgIHJldHVybiBhY2MuY29uY2F0KG1lc3NhZ2UpO1xuICAgIH0sXG4gICAgW11cbiAgKTtcbiAgcmV0dXJuIG5ldyBNaWxrZG93bkVycm9yKFxuICAgIEVycm9yQ29kZS5jcmVhdGVOb2RlSW5QYXJzZXJGYWlsLFxuICAgIG1lc3NhZ2VzLmpvaW4oXCJcXG5cIilcbiAgKTtcbn1cbmZ1bmN0aW9uIHN0YWNrT3ZlckZsb3coKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUuc3RhY2tPdmVyRmxvdyxcbiAgICBcIlN0YWNrIG92ZXIgZmxvdywgY2Fubm90IHBvcCBvbiBhbiBlbXB0eSBzdGFjay5cIlxuICApO1xufVxuZnVuY3Rpb24gcGFyc2VyTWF0Y2hFcnJvcihub2RlKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUucGFyc2VyTWF0Y2hFcnJvcixcbiAgICBgQ2Fubm90IG1hdGNoIHRhcmdldCBwYXJzZXIgZm9yIG5vZGU6ICR7c3RyaW5naWZ5KG5vZGUpfS5gXG4gICk7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVyTWF0Y2hFcnJvcihub2RlKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUuc2VyaWFsaXplck1hdGNoRXJyb3IsXG4gICAgYENhbm5vdCBtYXRjaCB0YXJnZXQgc2VyaWFsaXplciBmb3Igbm9kZTogJHtzdHJpbmdpZnkobm9kZSl9LmBcbiAgKTtcbn1cbmZ1bmN0aW9uIGdldEF0b21Gcm9tU2NoZW1hRmFpbCh0eXBlLCBuYW1lKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUuZ2V0QXRvbUZyb21TY2hlbWFGYWlsLFxuICAgIGBDYW5ub3QgZ2V0ICR7dHlwZX06ICR7bmFtZX0gZnJvbSBzY2hlbWEuYFxuICApO1xufVxuZnVuY3Rpb24gZXhwZWN0RG9tVHlwZUVycm9yKG5vZGUpIHtcbiAgcmV0dXJuIG5ldyBNaWxrZG93bkVycm9yKFxuICAgIEVycm9yQ29kZS5leHBlY3REb21UeXBlRXJyb3IsXG4gICAgYEV4cGVjdCB0byBiZSBhIGRvbSwgYnV0IGdldDogJHtzdHJpbmdpZnkobm9kZSl9LmBcbiAgKTtcbn1cbmZ1bmN0aW9uIGNhbGxDb21tYW5kQmVmb3JlRWRpdG9yVmlldygpIHtcbiAgcmV0dXJuIG5ldyBNaWxrZG93bkVycm9yKFxuICAgIEVycm9yQ29kZS5jYWxsQ29tbWFuZEJlZm9yZUVkaXRvclZpZXcsXG4gICAgXCJZb3UncmUgdHJ5aW5nIHRvIGNhbGwgYSBjb21tYW5kIGJlZm9yZSBlZGl0b3IgdmlldyBpbml0aWFsaXplZCwgbWFrZSBzdXJlIHRvIGdldCBjb21tYW5kTWFuYWdlciBmcm9tIGN0eCBhZnRlciBlZGl0b3IgdmlldyBoYXMgYmVlbiBpbml0aWFsaXplZFwiXG4gICk7XG59XG5mdW5jdGlvbiBtaXNzaW5nUm9vdEVsZW1lbnQoKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUubWlzc2luZ1Jvb3RFbGVtZW50LFxuICAgIFwiTWlzc2luZyByb290IGVsZW1lbnQsIG1pbGtkb3duIGNhbm5vdCBmaW5kIHJvb3QgZWxlbWVudCBvZiB0aGUgZWRpdG9yLlwiXG4gICk7XG59XG5mdW5jdGlvbiBtaXNzaW5nTm9kZUluU2NoZW1hKG5hbWUpIHtcbiAgcmV0dXJuIG5ldyBNaWxrZG93bkVycm9yKFxuICAgIEVycm9yQ29kZS5taXNzaW5nTm9kZUluU2NoZW1hLFxuICAgIGBNaXNzaW5nIG5vZGUgaW4gc2NoZW1hLCBtaWxrZG93biBjYW5ub3QgZmluZCBcIiR7bmFtZX1cIiBpbiBzY2hlbWEuYFxuICApO1xufVxuZnVuY3Rpb24gbWlzc2luZ01hcmtJblNjaGVtYShuYW1lKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUubWlzc2luZ01hcmtJblNjaGVtYSxcbiAgICBgTWlzc2luZyBtYXJrIGluIHNjaGVtYSwgbWlsa2Rvd24gY2Fubm90IGZpbmQgXCIke25hbWV9XCIgaW4gc2NoZW1hLmBcbiAgKTtcbn1cbmZ1bmN0aW9uIGN0eE5vdEJpbmQoKSB7XG4gIHJldHVybiBuZXcgTWlsa2Rvd25FcnJvcihcbiAgICBFcnJvckNvZGUuY3R4Tm90QmluZCxcbiAgICBcIkNvbnRleHQgbm90IGJpbmQsIHBsZWFzZSBtYWtlIHN1cmUgdGhlIHBsdWdpbiBoYXMgYmVlbiBpbml0aWFsaXplZC5cIlxuICApO1xufVxuZnVuY3Rpb24gbWlzc2luZ1lqc0RvYygpIHtcbiAgcmV0dXJuIG5ldyBNaWxrZG93bkVycm9yKFxuICAgIEVycm9yQ29kZS5taXNzaW5nWWpzRG9jLFxuICAgIFwiTWlzc2luZyB5anMgZG9jLCBwbGVhc2UgbWFrZSBzdXJlIHlvdSBoYXZlIGJpbmQgb25lLlwiXG4gICk7XG59XG5leHBvcnQge1xuICBjYWxsQ29tbWFuZEJlZm9yZUVkaXRvclZpZXcsXG4gIGNvbnRleHROb3RGb3VuZCxcbiAgY3JlYXRlTm9kZUluUGFyc2VyRmFpbCxcbiAgY3R4Q2FsbE91dE9mU2NvcGUsXG4gIGN0eE5vdEJpbmQsXG4gIGRvY1R5cGVFcnJvcixcbiAgZXhwZWN0RG9tVHlwZUVycm9yLFxuICBnZXRBdG9tRnJvbVNjaGVtYUZhaWwsXG4gIG1pc3NpbmdNYXJrSW5TY2hlbWEsXG4gIG1pc3NpbmdOb2RlSW5TY2hlbWEsXG4gIG1pc3NpbmdSb290RWxlbWVudCxcbiAgbWlzc2luZ1lqc0RvYyxcbiAgcGFyc2VyTWF0Y2hFcnJvcixcbiAgc2VyaWFsaXplck1hdGNoRXJyb3IsXG4gIHN0YWNrT3ZlckZsb3csXG4gIHRpbWVyTm90Rm91bmRcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/exception/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/preset-commonmark/lib/index.js":
/*!***************************************************************!*\
  !*** ./node_modules/@milkdown/preset-commonmark/lib/index.js ***!
  \***************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   blockquoteAttr: () => (/* binding */ blockquoteAttr),\n/* harmony export */   blockquoteKeymap: () => (/* binding */ blockquoteKeymap),\n/* harmony export */   blockquoteSchema: () => (/* binding */ blockquoteSchema),\n/* harmony export */   bulletListAttr: () => (/* binding */ bulletListAttr),\n/* harmony export */   bulletListKeymap: () => (/* binding */ bulletListKeymap),\n/* harmony export */   bulletListSchema: () => (/* binding */ bulletListSchema),\n/* harmony export */   codeBlockAttr: () => (/* binding */ codeBlockAttr),\n/* harmony export */   codeBlockKeymap: () => (/* binding */ codeBlockKeymap),\n/* harmony export */   codeBlockSchema: () => (/* binding */ codeBlockSchema),\n/* harmony export */   commands: () => (/* binding */ commands),\n/* harmony export */   commonmark: () => (/* binding */ commonmark),\n/* harmony export */   createCodeBlockCommand: () => (/* binding */ createCodeBlockCommand),\n/* harmony export */   createCodeBlockInputRule: () => (/* binding */ createCodeBlockInputRule),\n/* harmony export */   docSchema: () => (/* binding */ docSchema),\n/* harmony export */   downgradeHeadingCommand: () => (/* binding */ downgradeHeadingCommand),\n/* harmony export */   emphasisAttr: () => (/* binding */ emphasisAttr),\n/* harmony export */   emphasisKeymap: () => (/* binding */ emphasisKeymap),\n/* harmony export */   emphasisSchema: () => (/* binding */ emphasisSchema),\n/* harmony export */   emphasisStarInputRule: () => (/* binding */ emphasisStarInputRule),\n/* harmony export */   emphasisUnderscoreInputRule: () => (/* binding */ emphasisUnderscoreInputRule),\n/* harmony export */   hardbreakAttr: () => (/* binding */ hardbreakAttr),\n/* harmony export */   hardbreakClearMarkPlugin: () => (/* binding */ hardbreakClearMarkPlugin),\n/* harmony export */   hardbreakFilterNodes: () => (/* binding */ hardbreakFilterNodes),\n/* harmony export */   hardbreakFilterPlugin: () => (/* binding */ hardbreakFilterPlugin),\n/* harmony export */   hardbreakKeymap: () => (/* binding */ hardbreakKeymap),\n/* harmony export */   hardbreakSchema: () => (/* binding */ hardbreakSchema),\n/* harmony export */   headingAttr: () => (/* binding */ headingAttr),\n/* harmony export */   headingIdGenerator: () => (/* binding */ headingIdGenerator),\n/* harmony export */   headingKeymap: () => (/* binding */ headingKeymap),\n/* harmony export */   headingSchema: () => (/* binding */ headingSchema),\n/* harmony export */   hrAttr: () => (/* binding */ hrAttr),\n/* harmony export */   hrSchema: () => (/* binding */ hrSchema),\n/* harmony export */   htmlAttr: () => (/* binding */ htmlAttr),\n/* harmony export */   htmlSchema: () => (/* binding */ htmlSchema),\n/* harmony export */   imageAttr: () => (/* binding */ imageAttr),\n/* harmony export */   imageSchema: () => (/* binding */ imageSchema),\n/* harmony export */   inlineCodeAttr: () => (/* binding */ inlineCodeAttr),\n/* harmony export */   inlineCodeInputRule: () => (/* binding */ inlineCodeInputRule),\n/* harmony export */   inlineCodeKeymap: () => (/* binding */ inlineCodeKeymap),\n/* harmony export */   inlineCodeSchema: () => (/* binding */ inlineCodeSchema),\n/* harmony export */   inlineNodesCursorPlugin: () => (/* binding */ inlineNodesCursorPlugin),\n/* harmony export */   inputRules: () => (/* binding */ inputRules),\n/* harmony export */   insertHardbreakCommand: () => (/* binding */ insertHardbreakCommand),\n/* harmony export */   insertHrCommand: () => (/* binding */ insertHrCommand),\n/* harmony export */   insertHrInputRule: () => (/* binding */ insertHrInputRule),\n/* harmony export */   insertImageCommand: () => (/* binding */ insertImageCommand),\n/* harmony export */   insertImageInputRule: () => (/* binding */ insertImageInputRule),\n/* harmony export */   keymap: () => (/* binding */ keymap),\n/* harmony export */   liftFirstListItemCommand: () => (/* binding */ liftFirstListItemCommand),\n/* harmony export */   liftListItemCommand: () => (/* binding */ liftListItemCommand),\n/* harmony export */   linkAttr: () => (/* binding */ linkAttr),\n/* harmony export */   linkSchema: () => (/* binding */ linkSchema),\n/* harmony export */   listItemAttr: () => (/* binding */ listItemAttr),\n/* harmony export */   listItemKeymap: () => (/* binding */ listItemKeymap),\n/* harmony export */   listItemSchema: () => (/* binding */ listItemSchema),\n/* harmony export */   markInputRules: () => (/* binding */ markInputRules),\n/* harmony export */   orderedListAttr: () => (/* binding */ orderedListAttr),\n/* harmony export */   orderedListKeymap: () => (/* binding */ orderedListKeymap),\n/* harmony export */   orderedListSchema: () => (/* binding */ orderedListSchema),\n/* harmony export */   paragraphAttr: () => (/* binding */ paragraphAttr),\n/* harmony export */   paragraphKeymap: () => (/* binding */ paragraphKeymap),\n/* harmony export */   paragraphSchema: () => (/* binding */ paragraphSchema),\n/* harmony export */   plugins: () => (/* binding */ plugins),\n/* harmony export */   remarkAddOrderInListPlugin: () => (/* binding */ remarkAddOrderInListPlugin),\n/* harmony export */   remarkHtmlTransformer: () => (/* binding */ remarkHtmlTransformer),\n/* harmony export */   remarkInlineLinkPlugin: () => (/* binding */ remarkInlineLinkPlugin),\n/* harmony export */   remarkLineBreak: () => (/* binding */ remarkLineBreak),\n/* harmony export */   remarkMarker: () => (/* binding */ remarkMarker),\n/* harmony export */   remarkPreserveEmptyLinePlugin: () => (/* binding */ remarkPreserveEmptyLinePlugin),\n/* harmony export */   schema: () => (/* binding */ schema),\n/* harmony export */   sinkListItemCommand: () => (/* binding */ sinkListItemCommand),\n/* harmony export */   splitListItemCommand: () => (/* binding */ splitListItemCommand),\n/* harmony export */   strongAttr: () => (/* binding */ strongAttr),\n/* harmony export */   strongInputRule: () => (/* binding */ strongInputRule),\n/* harmony export */   strongKeymap: () => (/* binding */ strongKeymap),\n/* harmony export */   strongSchema: () => (/* binding */ strongSchema),\n/* harmony export */   syncHeadingIdPlugin: () => (/* binding */ syncHeadingIdPlugin),\n/* harmony export */   syncListOrderPlugin: () => (/* binding */ syncListOrderPlugin),\n/* harmony export */   textSchema: () => (/* binding */ textSchema),\n/* harmony export */   toggleEmphasisCommand: () => (/* binding */ toggleEmphasisCommand),\n/* harmony export */   toggleInlineCodeCommand: () => (/* binding */ toggleInlineCodeCommand),\n/* harmony export */   toggleLinkCommand: () => (/* binding */ toggleLinkCommand),\n/* harmony export */   toggleStrongCommand: () => (/* binding */ toggleStrongCommand),\n/* harmony export */   turnIntoTextCommand: () => (/* binding */ turnIntoTextCommand),\n/* harmony export */   updateCodeBlockLanguageCommand: () => (/* binding */ updateCodeBlockLanguageCommand),\n/* harmony export */   updateImageCommand: () => (/* binding */ updateImageCommand),\n/* harmony export */   updateLinkCommand: () => (/* binding */ updateLinkCommand),\n/* harmony export */   wrapInBlockquoteCommand: () => (/* binding */ wrapInBlockquoteCommand),\n/* harmony export */   wrapInBlockquoteInputRule: () => (/* binding */ wrapInBlockquoteInputRule),\n/* harmony export */   wrapInBulletListCommand: () => (/* binding */ wrapInBulletListCommand),\n/* harmony export */   wrapInBulletListInputRule: () => (/* binding */ wrapInBulletListInputRule),\n/* harmony export */   wrapInHeadingCommand: () => (/* binding */ wrapInHeadingCommand),\n/* harmony export */   wrapInHeadingInputRule: () => (/* binding */ wrapInHeadingInputRule),\n/* harmony export */   wrapInOrderedListCommand: () => (/* binding */ wrapInOrderedListCommand),\n/* harmony export */   wrapInOrderedListInputRule: () => (/* binding */ wrapInOrderedListInputRule)\n/* harmony export */ });\n/* harmony import */ var _milkdown_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @milkdown/utils */ \"(ssr)/./node_modules/@milkdown/utils/lib/index.js\");\n/* harmony import */ var _milkdown_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @milkdown/core */ \"(ssr)/./node_modules/@milkdown/core/lib/index.js\");\n/* harmony import */ var _milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @milkdown/prose/commands */ \"(ssr)/./node_modules/prosemirror-commands/dist/index.js\");\n/* harmony import */ var unist_util_visit_parents__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! unist-util-visit-parents */ \"(ssr)/./node_modules/unist-util-visit-parents/lib/index.js\");\n/* harmony import */ var _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @milkdown/prose/model */ \"(ssr)/./node_modules/prosemirror-model/dist/index.js\");\n/* harmony import */ var _milkdown_exception__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @milkdown/exception */ \"(ssr)/./node_modules/@milkdown/exception/lib/index.js\");\n/* harmony import */ var _milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @milkdown/prose/inputrules */ \"(ssr)/./node_modules/prosemirror-inputrules/dist/index.js\");\n/* harmony import */ var _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @milkdown/prose/state */ \"(ssr)/./node_modules/prosemirror-state/dist/index.js\");\n/* harmony import */ var _milkdown_prose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @milkdown/prose */ \"(ssr)/./node_modules/@milkdown/prose/lib/index.js\");\n/* harmony import */ var _milkdown_prose_schema_list__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @milkdown/prose/schema-list */ \"(ssr)/./node_modules/prosemirror-schema-list/dist/index.js\");\n/* harmony import */ var _milkdown_prose_transform__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @milkdown/prose/transform */ \"(ssr)/./node_modules/prosemirror-transform/dist/index.js\");\n/* harmony import */ var _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @milkdown/prose/view */ \"(ssr)/./node_modules/prosemirror-view/dist/index.js\");\n/* harmony import */ var unist_util_visit__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! unist-util-visit */ \"(ssr)/./node_modules/unist-util-visit/lib/index.js\");\n/* harmony import */ var remark_inline_links__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! remark-inline-links */ \"(ssr)/./node_modules/remark-inline-links/lib/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction serializeText(state, node) {\n  var _a;\n  const lastIsHardBreak = node.childCount >= 1 && ((_a = node.lastChild) == null ? void 0 : _a.type.name) === \"hardbreak\";\n  if (!lastIsHardBreak) {\n    state.next(node.content);\n    return;\n  }\n  const contentArr = [];\n  node.content.forEach((n, _, i) => {\n    if (i === node.childCount - 1) return;\n    contentArr.push(n);\n  });\n  state.next(_milkdown_prose_model__WEBPACK_IMPORTED_MODULE_0__.Fragment.fromArray(contentArr));\n}\nfunction withMeta(plugin, meta) {\n  Object.assign(plugin, {\n    meta: {\n      package: \"@milkdown/preset-commonmark\",\n      ...meta\n    }\n  });\n  return plugin;\n}\nconst emphasisAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markAttr)(\"emphasis\");\nwithMeta(emphasisAttr, {\n  displayName: \"Attr<emphasis>\",\n  group: \"Emphasis\"\n});\nconst emphasisSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markSchema)(\"emphasis\", (ctx) => ({\n  attrs: {\n    marker: {\n      default: ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.remarkStringifyOptionsCtx).emphasis || \"*\",\n      validate: \"string\"\n    }\n  },\n  parseDOM: [\n    { tag: \"i\" },\n    { tag: \"em\" },\n    { style: \"font-style\", getAttrs: (value) => value === \"italic\" }\n  ],\n  toDOM: (mark) => [\"em\", ctx.get(emphasisAttr.key)(mark)],\n  parseMarkdown: {\n    match: (node) => node.type === \"emphasis\",\n    runner: (state, node, markType) => {\n      state.openMark(markType, { marker: node.marker });\n      state.next(node.children);\n      state.closeMark(markType);\n    }\n  },\n  toMarkdown: {\n    match: (mark) => mark.type.name === \"emphasis\",\n    runner: (state, mark) => {\n      state.withMark(mark, \"emphasis\", void 0, {\n        marker: mark.attrs.marker\n      });\n    }\n  }\n}));\nwithMeta(emphasisSchema.mark, {\n  displayName: \"MarkSchema<emphasis>\",\n  group: \"Emphasis\"\n});\nwithMeta(emphasisSchema.ctx, {\n  displayName: \"MarkSchemaCtx<emphasis>\",\n  group: \"Emphasis\"\n});\nconst toggleEmphasisCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\"ToggleEmphasis\", (ctx) => () => {\n  return (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.toggleMark)(emphasisSchema.type(ctx));\n});\nwithMeta(toggleEmphasisCommand, {\n  displayName: \"Command<toggleEmphasisCommand>\",\n  group: \"Emphasis\"\n});\nconst emphasisStarInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)((ctx) => {\n  return (0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_4__.markRule)(/(?:^|[^*])\\*([^*]+)\\*$/, emphasisSchema.type(ctx), {\n    getAttr: () => ({\n      marker: \"*\"\n    }),\n    updateCaptured: ({ fullMatch, start }) => !fullMatch.startsWith(\"*\") ? { fullMatch: fullMatch.slice(1), start: start + 1 } : {}\n  });\n});\nwithMeta(emphasisStarInputRule, {\n  displayName: \"InputRule<emphasis>|Star\",\n  group: \"Emphasis\"\n});\nconst emphasisUnderscoreInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)((ctx) => {\n  return (0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_4__.markRule)(/(?:^|[^_])_([^_]+)_$/, emphasisSchema.type(ctx), {\n    getAttr: () => ({\n      marker: \"_\"\n    }),\n    updateCaptured: ({ fullMatch, start }) => !fullMatch.startsWith(\"_\") ? { fullMatch: fullMatch.slice(1), start: start + 1 } : {}\n  });\n});\nwithMeta(emphasisUnderscoreInputRule, {\n  displayName: \"InputRule<emphasis>|Underscore\",\n  group: \"Emphasis\"\n});\nconst emphasisKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"emphasisKeymap\", {\n  ToggleEmphasis: {\n    shortcuts: \"Mod-i\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(toggleEmphasisCommand.key);\n    }\n  }\n});\nwithMeta(emphasisKeymap.ctx, {\n  displayName: \"KeymapCtx<emphasis>\",\n  group: \"Emphasis\"\n});\nwithMeta(emphasisKeymap.shortcuts, {\n  displayName: \"Keymap<emphasis>\",\n  group: \"Emphasis\"\n});\nconst strongAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markAttr)(\"strong\");\nwithMeta(strongAttr, {\n  displayName: \"Attr<strong>\",\n  group: \"Strong\"\n});\nconst strongSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markSchema)(\"strong\", (ctx) => ({\n  attrs: {\n    marker: {\n      default: ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.remarkStringifyOptionsCtx).strong || \"*\",\n      validate: \"string\"\n    }\n  },\n  parseDOM: [\n    // This works around a Google Docs misbehavior where\n    // pasted content will be inexplicably wrapped in `<b>`\n    // tags with a font-weight normal.\n    {\n      tag: \"b\",\n      getAttrs: (node) => node.style.fontWeight != \"normal\" && null\n    },\n    { tag: \"strong\" },\n    { style: \"font-style\", getAttrs: (value) => value === \"bold\" },\n    { style: \"font-weight=400\", clearMark: (m) => m.type.name == \"strong\" },\n    {\n      style: \"font-weight\",\n      getAttrs: (value) => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null\n    }\n  ],\n  toDOM: (mark) => [\"strong\", ctx.get(strongAttr.key)(mark)],\n  parseMarkdown: {\n    match: (node) => node.type === \"strong\",\n    runner: (state, node, markType) => {\n      state.openMark(markType, { marker: node.marker });\n      state.next(node.children);\n      state.closeMark(markType);\n    }\n  },\n  toMarkdown: {\n    match: (mark) => mark.type.name === \"strong\",\n    runner: (state, mark) => {\n      state.withMark(mark, \"strong\", void 0, {\n        marker: mark.attrs.marker\n      });\n    }\n  }\n}));\nwithMeta(strongSchema.mark, {\n  displayName: \"MarkSchema<strong>\",\n  group: \"Strong\"\n});\nwithMeta(strongSchema.ctx, {\n  displayName: \"MarkSchemaCtx<strong>\",\n  group: \"Strong\"\n});\nconst toggleStrongCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\"ToggleStrong\", (ctx) => () => {\n  return (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.toggleMark)(strongSchema.type(ctx));\n});\nwithMeta(toggleStrongCommand, {\n  displayName: \"Command<toggleStrongCommand>\",\n  group: \"Strong\"\n});\nconst strongInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)((ctx) => {\n  return (0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_4__.markRule)(/(?:\\*\\*|__)([^*_]+)(?:\\*\\*|__)$/, strongSchema.type(ctx), {\n    getAttr: (match) => {\n      return {\n        marker: match[0].startsWith(\"*\") ? \"*\" : \"_\"\n      };\n    }\n  });\n});\nwithMeta(strongInputRule, {\n  displayName: \"InputRule<strong>\",\n  group: \"Strong\"\n});\nconst strongKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"strongKeymap\", {\n  ToggleBold: {\n    shortcuts: [\"Mod-b\"],\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(toggleStrongCommand.key);\n    }\n  }\n});\nwithMeta(strongKeymap.ctx, {\n  displayName: \"KeymapCtx<strong>\",\n  group: \"Strong\"\n});\nwithMeta(strongKeymap.shortcuts, {\n  displayName: \"Keymap<strong>\",\n  group: \"Strong\"\n});\nconst inlineCodeAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markAttr)(\"inlineCode\");\nwithMeta(inlineCodeAttr, {\n  displayName: \"Attr<inlineCode>\",\n  group: \"InlineCode\"\n});\nconst inlineCodeSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markSchema)(\"inlineCode\", (ctx) => ({\n  priority: 100,\n  code: true,\n  parseDOM: [{ tag: \"code\" }],\n  toDOM: (mark) => [\"code\", ctx.get(inlineCodeAttr.key)(mark)],\n  parseMarkdown: {\n    match: (node) => node.type === \"inlineCode\",\n    runner: (state, node, markType) => {\n      state.openMark(markType);\n      state.addText(node.value);\n      state.closeMark(markType);\n    }\n  },\n  toMarkdown: {\n    match: (mark) => mark.type.name === \"inlineCode\",\n    runner: (state, mark, node) => {\n      state.withMark(mark, \"inlineCode\", node.text || \"\");\n    }\n  }\n}));\nwithMeta(inlineCodeSchema.mark, {\n  displayName: \"MarkSchema<inlineCode>\",\n  group: \"InlineCode\"\n});\nwithMeta(inlineCodeSchema.ctx, {\n  displayName: \"MarkSchemaCtx<inlineCode>\",\n  group: \"InlineCode\"\n});\nconst toggleInlineCodeCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"ToggleInlineCode\",\n  (ctx) => () => (state, dispatch) => {\n    const { selection, tr } = state;\n    if (selection.empty) return false;\n    const { from, to } = selection;\n    const has = state.doc.rangeHasMark(from, to, inlineCodeSchema.type(ctx));\n    if (has) {\n      dispatch == null ? void 0 : dispatch(tr.removeMark(from, to, inlineCodeSchema.type(ctx)));\n      return true;\n    }\n    const restMarksName = Object.keys(state.schema.marks).filter(\n      (x) => x !== inlineCodeSchema.type.name\n    );\n    restMarksName.map((name) => state.schema.marks[name]).forEach((t) => {\n      tr.removeMark(from, to, t);\n    });\n    dispatch == null ? void 0 : dispatch(tr.addMark(from, to, inlineCodeSchema.type(ctx).create()));\n    return true;\n  }\n);\nwithMeta(toggleInlineCodeCommand, {\n  displayName: \"Command<toggleInlineCodeCommand>\",\n  group: \"InlineCode\"\n});\nconst inlineCodeInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)((ctx) => {\n  return (0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_4__.markRule)(/(?:`)([^`]+)(?:`)$/, inlineCodeSchema.type(ctx));\n});\nwithMeta(inlineCodeInputRule, {\n  displayName: \"InputRule<inlineCodeInputRule>\",\n  group: \"InlineCode\"\n});\nconst inlineCodeKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"inlineCodeKeymap\", {\n  ToggleInlineCode: {\n    shortcuts: \"Mod-e\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(toggleInlineCodeCommand.key);\n    }\n  }\n});\nwithMeta(inlineCodeKeymap.ctx, {\n  displayName: \"KeymapCtx<inlineCode>\",\n  group: \"InlineCode\"\n});\nwithMeta(inlineCodeKeymap.shortcuts, {\n  displayName: \"Keymap<inlineCode>\",\n  group: \"InlineCode\"\n});\nconst linkAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markAttr)(\"link\");\nwithMeta(linkAttr, {\n  displayName: \"Attr<link>\",\n  group: \"Link\"\n});\nconst linkSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$markSchema)(\"link\", (ctx) => ({\n  attrs: {\n    href: { validate: \"string\" },\n    title: { default: null, validate: \"string|null\" }\n  },\n  parseDOM: [\n    {\n      tag: \"a[href]\",\n      getAttrs: (dom) => {\n        if (!(dom instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(dom);\n        return {\n          href: dom.getAttribute(\"href\"),\n          title: dom.getAttribute(\"title\")\n        };\n      }\n    }\n  ],\n  toDOM: (mark) => [\"a\", { ...ctx.get(linkAttr.key)(mark), ...mark.attrs }],\n  parseMarkdown: {\n    match: (node) => node.type === \"link\",\n    runner: (state, node, markType) => {\n      const url = node.url;\n      const title = node.title;\n      state.openMark(markType, { href: url, title });\n      state.next(node.children);\n      state.closeMark(markType);\n    }\n  },\n  toMarkdown: {\n    match: (mark) => mark.type.name === \"link\",\n    runner: (state, mark) => {\n      state.withMark(mark, \"link\", void 0, {\n        title: mark.attrs.title,\n        url: mark.attrs.href\n      });\n    }\n  }\n}));\nwithMeta(linkSchema.mark, {\n  displayName: \"MarkSchema<link>\",\n  group: \"Link\"\n});\nconst toggleLinkCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"ToggleLink\",\n  (ctx) => (payload = {}) => (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.toggleMark)(linkSchema.type(ctx), payload)\n);\nwithMeta(toggleLinkCommand, {\n  displayName: \"Command<toggleLinkCommand>\",\n  group: \"Link\"\n});\nconst updateLinkCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"UpdateLink\",\n  (ctx) => (payload = {}) => (state, dispatch) => {\n    if (!dispatch) return false;\n    let node;\n    let pos = -1;\n    const { selection } = state;\n    const { from, to } = selection;\n    state.doc.nodesBetween(from, from === to ? to + 1 : to, (n, p) => {\n      if (linkSchema.type(ctx).isInSet(n.marks)) {\n        node = n;\n        pos = p;\n        return false;\n      }\n      return void 0;\n    });\n    if (!node) return false;\n    const mark = node.marks.find(({ type }) => type === linkSchema.type(ctx));\n    if (!mark) return false;\n    const start = pos;\n    const end = pos + node.nodeSize;\n    const { tr } = state;\n    const linkMark = linkSchema.type(ctx).create({ ...mark.attrs, ...payload });\n    if (!linkMark) return false;\n    dispatch(\n      tr.removeMark(start, end, mark).addMark(start, end, linkMark).setSelection(new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.TextSelection(tr.selection.$anchor)).scrollIntoView()\n    );\n    return true;\n  }\n);\nwithMeta(updateLinkCommand, {\n  displayName: \"Command<updateLinkCommand>\",\n  group: \"Link\"\n});\nconst docSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$node)(\"doc\", () => ({\n  content: \"block+\",\n  parseMarkdown: {\n    match: ({ type }) => type === \"root\",\n    runner: (state, node, type) => {\n      state.injectRoot(node, type);\n    }\n  },\n  toMarkdown: {\n    match: (node) => node.type.name === \"doc\",\n    runner: (state, node) => {\n      state.openNode(\"root\");\n      state.next(node.content);\n    }\n  }\n}));\nwithMeta(docSchema, {\n  displayName: \"NodeSchema<doc>\",\n  group: \"Doc\"\n});\nfunction visitEmptyLine(ast) {\n  return (0,unist_util_visit_parents__WEBPACK_IMPORTED_MODULE_7__.visitParents)(\n    ast,\n    (node) => {\n      var _a;\n      return node.type === \"html\" && [\"<br />\", \"<br>\", \"<br >\", \"<br/>\"].includes(\n        (_a = node.value) == null ? void 0 : _a.trim()\n      );\n    },\n    (node, parents) => {\n      if (!parents.length) return;\n      const parent = parents[parents.length - 1];\n      if (!parent) return;\n      const index = parent.children.indexOf(node);\n      if (index === -1) return;\n      parent.children.splice(index, 1);\n    },\n    true\n  );\n}\nconst remarkPreserveEmptyLinePlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$remark)(\n  \"remark-preserve-empty-line\",\n  () => () => visitEmptyLine\n);\nwithMeta(remarkPreserveEmptyLinePlugin.plugin, {\n  displayName: \"Remark<remarkPreserveEmptyLine>\",\n  group: \"Remark\"\n});\nwithMeta(remarkPreserveEmptyLinePlugin.options, {\n  displayName: \"RemarkConfig<remarkPreserveEmptyLine>\",\n  group: \"Remark\"\n});\nconst paragraphAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"paragraph\");\nwithMeta(paragraphAttr, {\n  displayName: \"Attr<paragraph>\",\n  group: \"Paragraph\"\n});\nconst paragraphSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"paragraph\", (ctx) => ({\n  content: \"inline*\",\n  group: \"block\",\n  parseDOM: [{ tag: \"p\" }],\n  toDOM: (node) => [\"p\", ctx.get(paragraphAttr.key)(node), 0],\n  parseMarkdown: {\n    match: (node) => node.type === \"paragraph\",\n    runner: (state, node, type) => {\n      state.openNode(type);\n      if (node.children) state.next(node.children);\n      else state.addText(node.value || \"\");\n      state.closeNode();\n    }\n  },\n  toMarkdown: {\n    match: (node) => node.type.name === \"paragraph\",\n    runner: (state, node) => {\n      var _a;\n      const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n      const lastNode = (_a = view.state) == null ? void 0 : _a.doc.lastChild;\n      state.openNode(\"paragraph\");\n      if ((!node.content || node.content.size === 0) && node !== lastNode && shouldPreserveEmptyLine(ctx)) {\n        state.addNode(\"html\", void 0, \"<br />\");\n      } else {\n        serializeText(state, node);\n      }\n      state.closeNode();\n    }\n  }\n}));\nfunction shouldPreserveEmptyLine(ctx) {\n  let shouldPreserveEmptyLine2 = false;\n  try {\n    ctx.get(remarkPreserveEmptyLinePlugin.id);\n    shouldPreserveEmptyLine2 = true;\n  } catch {\n    shouldPreserveEmptyLine2 = false;\n  }\n  return shouldPreserveEmptyLine2;\n}\nwithMeta(paragraphSchema.node, {\n  displayName: \"NodeSchema<paragraph>\",\n  group: \"Paragraph\"\n});\nwithMeta(paragraphSchema.ctx, {\n  displayName: \"NodeSchemaCtx<paragraph>\",\n  group: \"Paragraph\"\n});\nconst turnIntoTextCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"TurnIntoText\",\n  (ctx) => () => (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.setBlockType)(paragraphSchema.type(ctx))\n);\nwithMeta(turnIntoTextCommand, {\n  displayName: \"Command<turnIntoTextCommand>\",\n  group: \"Paragraph\"\n});\nconst paragraphKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"paragraphKeymap\", {\n  TurnIntoText: {\n    shortcuts: \"Mod-Alt-0\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(turnIntoTextCommand.key);\n    }\n  }\n});\nwithMeta(paragraphKeymap.ctx, {\n  displayName: \"KeymapCtx<paragraph>\",\n  group: \"Paragraph\"\n});\nwithMeta(paragraphKeymap.shortcuts, {\n  displayName: \"Keymap<paragraph>\",\n  group: \"Paragraph\"\n});\nconst headingIndex = Array(6).fill(0).map((_, i) => i + 1);\nfunction defaultHeadingIdGenerator(node) {\n  return node.textContent.toLowerCase().trim().replace(/[^\\w\\s-]/g, \"\").replace(/\\s+/g, \"-\");\n}\nconst headingIdGenerator = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$ctx)(\n  defaultHeadingIdGenerator,\n  \"headingIdGenerator\"\n);\nwithMeta(headingIdGenerator, {\n  displayName: \"Ctx<HeadingIdGenerator>\",\n  group: \"Heading\"\n});\nconst headingAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"heading\");\nwithMeta(headingAttr, {\n  displayName: \"Attr<heading>\",\n  group: \"Heading\"\n});\nconst headingSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"heading\", (ctx) => {\n  const getId = ctx.get(headingIdGenerator.key);\n  return {\n    content: \"inline*\",\n    group: \"block\",\n    defining: true,\n    attrs: {\n      id: {\n        default: \"\",\n        validate: \"string\"\n      },\n      level: {\n        default: 1,\n        validate: \"number\"\n      }\n    },\n    parseDOM: headingIndex.map((x) => ({\n      tag: `h${x}`,\n      getAttrs: (node) => {\n        if (!(node instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(node);\n        return { level: x, id: node.id };\n      }\n    })),\n    toDOM: (node) => {\n      return [\n        `h${node.attrs.level}`,\n        {\n          ...ctx.get(headingAttr.key)(node),\n          id: node.attrs.id || getId(node)\n        },\n        0\n      ];\n    },\n    parseMarkdown: {\n      match: ({ type }) => type === \"heading\",\n      runner: (state, node, type) => {\n        const depth = node.depth;\n        state.openNode(type, { level: depth });\n        state.next(node.children);\n        state.closeNode();\n      }\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === \"heading\",\n      runner: (state, node) => {\n        state.openNode(\"heading\", void 0, { depth: node.attrs.level });\n        serializeText(state, node);\n        state.closeNode();\n      }\n    }\n  };\n});\nwithMeta(headingSchema.node, {\n  displayName: \"NodeSchema<heading>\",\n  group: \"Heading\"\n});\nwithMeta(headingSchema.ctx, {\n  displayName: \"NodeSchemaCtx<heading>\",\n  group: \"Heading\"\n});\nconst wrapInHeadingInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)((ctx) => {\n  return (0,_milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.textblockTypeInputRule)(\n    /^(?<hashes>#+)\\s$/,\n    headingSchema.type(ctx),\n    (match) => {\n      var _a, _b;\n      const x = ((_b = (_a = match.groups) == null ? void 0 : _a.hashes) == null ? void 0 : _b.length) || 0;\n      const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n      const { $from } = view.state.selection;\n      const node = $from.node();\n      if (node.type.name === \"heading\") {\n        let level = Number(node.attrs.level) + Number(x);\n        if (level > 6) level = 6;\n        return { level };\n      }\n      return { level: x };\n    }\n  );\n});\nwithMeta(wrapInHeadingInputRule, {\n  displayName: \"InputRule<wrapInHeadingInputRule>\",\n  group: \"Heading\"\n});\nconst wrapInHeadingCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\"WrapInHeading\", (ctx) => {\n  return (level) => {\n    level ?? (level = 1);\n    if (level < 1) return (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.setBlockType)(paragraphSchema.type(ctx));\n    return (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.setBlockType)(headingSchema.type(ctx), { level });\n  };\n});\nwithMeta(wrapInHeadingCommand, {\n  displayName: \"Command<wrapInHeadingCommand>\",\n  group: \"Heading\"\n});\nconst downgradeHeadingCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"DowngradeHeading\",\n  (ctx) => () => (state, dispatch, view) => {\n    const { $from } = state.selection;\n    const node = $from.node();\n    if (node.type !== headingSchema.type(ctx) || !state.selection.empty || $from.parentOffset !== 0)\n      return false;\n    const level = node.attrs.level - 1;\n    if (!level)\n      return (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.setBlockType)(paragraphSchema.type(ctx))(state, dispatch, view);\n    dispatch == null ? void 0 : dispatch(\n      state.tr.setNodeMarkup(state.selection.$from.before(), void 0, {\n        ...node.attrs,\n        level\n      })\n    );\n    return true;\n  }\n);\nwithMeta(downgradeHeadingCommand, {\n  displayName: \"Command<downgradeHeadingCommand>\",\n  group: \"Heading\"\n});\nconst headingKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"headingKeymap\", {\n  TurnIntoH1: {\n    shortcuts: \"Mod-Alt-1\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInHeadingCommand.key, 1);\n    }\n  },\n  TurnIntoH2: {\n    shortcuts: \"Mod-Alt-2\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInHeadingCommand.key, 2);\n    }\n  },\n  TurnIntoH3: {\n    shortcuts: \"Mod-Alt-3\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInHeadingCommand.key, 3);\n    }\n  },\n  TurnIntoH4: {\n    shortcuts: \"Mod-Alt-4\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInHeadingCommand.key, 4);\n    }\n  },\n  TurnIntoH5: {\n    shortcuts: \"Mod-Alt-5\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInHeadingCommand.key, 5);\n    }\n  },\n  TurnIntoH6: {\n    shortcuts: \"Mod-Alt-6\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInHeadingCommand.key, 6);\n    }\n  },\n  DowngradeHeading: {\n    shortcuts: [\"Delete\", \"Backspace\"],\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(downgradeHeadingCommand.key);\n    }\n  }\n});\nwithMeta(headingKeymap.ctx, {\n  displayName: \"KeymapCtx<heading>\",\n  group: \"Heading\"\n});\nwithMeta(headingKeymap.shortcuts, {\n  displayName: \"Keymap<heading>\",\n  group: \"Heading\"\n});\nconst blockquoteAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"blockquote\");\nwithMeta(blockquoteAttr, {\n  displayName: \"Attr<blockquote>\",\n  group: \"Blockquote\"\n});\nconst blockquoteSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\n  \"blockquote\",\n  (ctx) => ({\n    content: \"block+\",\n    group: \"block\",\n    defining: true,\n    parseDOM: [{ tag: \"blockquote\" }],\n    toDOM: (node) => [\"blockquote\", ctx.get(blockquoteAttr.key)(node), 0],\n    parseMarkdown: {\n      match: ({ type }) => type === \"blockquote\",\n      runner: (state, node, type) => {\n        state.openNode(type).next(node.children).closeNode();\n      }\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === \"blockquote\",\n      runner: (state, node) => {\n        state.openNode(\"blockquote\").next(node.content).closeNode();\n      }\n    }\n  })\n);\nwithMeta(blockquoteSchema.node, {\n  displayName: \"NodeSchema<blockquote>\",\n  group: \"Blockquote\"\n});\nwithMeta(blockquoteSchema.ctx, {\n  displayName: \"NodeSchemaCtx<blockquote>\",\n  group: \"Blockquote\"\n});\nconst wrapInBlockquoteInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)(\n  (ctx) => (0,_milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.wrappingInputRule)(/^\\s*>\\s$/, blockquoteSchema.type(ctx))\n);\nwithMeta(wrapInBlockquoteInputRule, {\n  displayName: \"InputRule<wrapInBlockquoteInputRule>\",\n  group: \"Blockquote\"\n});\nconst wrapInBlockquoteCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"WrapInBlockquote\",\n  (ctx) => () => (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.wrapIn)(blockquoteSchema.type(ctx))\n);\nwithMeta(wrapInBlockquoteCommand, {\n  displayName: \"Command<wrapInBlockquoteCommand>\",\n  group: \"Blockquote\"\n});\nconst blockquoteKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"blockquoteKeymap\", {\n  WrapInBlockquote: {\n    shortcuts: \"Mod-Shift-b\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInBlockquoteCommand.key);\n    }\n  }\n});\nwithMeta(blockquoteKeymap.ctx, {\n  displayName: \"KeymapCtx<blockquote>\",\n  group: \"Blockquote\"\n});\nwithMeta(blockquoteKeymap.shortcuts, {\n  displayName: \"Keymap<blockquote>\",\n  group: \"Blockquote\"\n});\nconst codeBlockAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"codeBlock\", () => ({\n  pre: {},\n  code: {}\n}));\nwithMeta(codeBlockAttr, {\n  displayName: \"Attr<codeBlock>\",\n  group: \"CodeBlock\"\n});\nconst codeBlockSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"code_block\", (ctx) => {\n  return {\n    content: \"text*\",\n    group: \"block\",\n    marks: \"\",\n    defining: true,\n    code: true,\n    attrs: {\n      language: {\n        default: \"\",\n        validate: \"string\"\n      }\n    },\n    parseDOM: [\n      {\n        tag: \"pre\",\n        preserveWhitespace: \"full\",\n        getAttrs: (dom) => {\n          if (!(dom instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(dom);\n          return { language: dom.dataset.language };\n        }\n      }\n    ],\n    toDOM: (node) => {\n      const attr = ctx.get(codeBlockAttr.key)(node);\n      return [\n        \"pre\",\n        {\n          ...attr.pre,\n          \"data-language\": node.attrs.language\n        },\n        [\"code\", attr.code, 0]\n      ];\n    },\n    parseMarkdown: {\n      match: ({ type }) => type === \"code\",\n      runner: (state, node, type) => {\n        const language = node.lang;\n        const value = node.value;\n        state.openNode(type, { language });\n        if (value) state.addText(value);\n        state.closeNode();\n      }\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === \"code_block\",\n      runner: (state, node) => {\n        var _a;\n        state.addNode(\"code\", void 0, ((_a = node.content.firstChild) == null ? void 0 : _a.text) || \"\", {\n          lang: node.attrs.language\n        });\n      }\n    }\n  };\n});\nwithMeta(codeBlockSchema.node, {\n  displayName: \"NodeSchema<codeBlock>\",\n  group: \"CodeBlock\"\n});\nwithMeta(codeBlockSchema.ctx, {\n  displayName: \"NodeSchemaCtx<codeBlock>\",\n  group: \"CodeBlock\"\n});\nconst createCodeBlockInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)(\n  (ctx) => (0,_milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.textblockTypeInputRule)(\n    /^```(?<language>[a-z]*)?[\\s\\n]$/,\n    codeBlockSchema.type(ctx),\n    (match) => {\n      var _a;\n      return {\n        language: ((_a = match.groups) == null ? void 0 : _a.language) ?? \"\"\n      };\n    }\n  )\n);\nwithMeta(createCodeBlockInputRule, {\n  displayName: \"InputRule<createCodeBlockInputRule>\",\n  group: \"CodeBlock\"\n});\nconst createCodeBlockCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"CreateCodeBlock\",\n  (ctx) => (language = \"\") => (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.setBlockType)(codeBlockSchema.type(ctx), { language })\n);\nwithMeta(createCodeBlockCommand, {\n  displayName: \"Command<createCodeBlockCommand>\",\n  group: \"CodeBlock\"\n});\nconst updateCodeBlockLanguageCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"UpdateCodeBlockLanguage\",\n  () => ({ pos, language } = {\n    pos: -1,\n    language: \"\"\n  }) => (state, dispatch) => {\n    if (pos >= 0) {\n      dispatch == null ? void 0 : dispatch(state.tr.setNodeAttribute(pos, \"language\", language));\n      return true;\n    }\n    return false;\n  }\n);\nwithMeta(updateCodeBlockLanguageCommand, {\n  displayName: \"Command<updateCodeBlockLanguageCommand>\",\n  group: \"CodeBlock\"\n});\nconst codeBlockKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"codeBlockKeymap\", {\n  CreateCodeBlock: {\n    shortcuts: \"Mod-Alt-c\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(createCodeBlockCommand.key);\n    }\n  }\n});\nwithMeta(codeBlockKeymap.ctx, {\n  displayName: \"KeymapCtx<codeBlock>\",\n  group: \"CodeBlock\"\n});\nwithMeta(codeBlockKeymap.shortcuts, {\n  displayName: \"Keymap<codeBlock>\",\n  group: \"CodeBlock\"\n});\nconst imageAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"image\");\nwithMeta(imageAttr, {\n  displayName: \"Attr<image>\",\n  group: \"Image\"\n});\nconst imageSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"image\", (ctx) => {\n  return {\n    inline: true,\n    group: \"inline\",\n    selectable: true,\n    draggable: true,\n    marks: \"\",\n    atom: true,\n    defining: true,\n    isolating: true,\n    attrs: {\n      src: { default: \"\", validate: \"string\" },\n      alt: { default: \"\", validate: \"string\" },\n      title: { default: \"\", validate: \"string\" }\n    },\n    parseDOM: [\n      {\n        tag: \"img[src]\",\n        getAttrs: (dom) => {\n          if (!(dom instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(dom);\n          return {\n            src: dom.getAttribute(\"src\") || \"\",\n            alt: dom.getAttribute(\"alt\") || \"\",\n            title: dom.getAttribute(\"title\") || dom.getAttribute(\"alt\") || \"\"\n          };\n        }\n      }\n    ],\n    toDOM: (node) => {\n      return [\"img\", { ...ctx.get(imageAttr.key)(node), ...node.attrs }];\n    },\n    parseMarkdown: {\n      match: ({ type }) => type === \"image\",\n      runner: (state, node, type) => {\n        const url = node.url;\n        const alt = node.alt;\n        const title = node.title;\n        state.addNode(type, {\n          src: url,\n          alt,\n          title\n        });\n      }\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === \"image\",\n      runner: (state, node) => {\n        state.addNode(\"image\", void 0, void 0, {\n          title: node.attrs.title,\n          url: node.attrs.src,\n          alt: node.attrs.alt\n        });\n      }\n    }\n  };\n});\nwithMeta(imageSchema.node, {\n  displayName: \"NodeSchema<image>\",\n  group: \"Image\"\n});\nwithMeta(imageSchema.ctx, {\n  displayName: \"NodeSchemaCtx<image>\",\n  group: \"Image\"\n});\nconst insertImageCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"InsertImage\",\n  (ctx) => (payload = {}) => (state, dispatch) => {\n    if (!dispatch) return true;\n    const { src = \"\", alt = \"\", title = \"\" } = payload;\n    const node = imageSchema.type(ctx).create({ src, alt, title });\n    if (!node) return true;\n    dispatch(state.tr.replaceSelectionWith(node).scrollIntoView());\n    return true;\n  }\n);\nwithMeta(insertImageCommand, {\n  displayName: \"Command<insertImageCommand>\",\n  group: \"Image\"\n});\nconst updateImageCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"UpdateImage\",\n  (ctx) => (payload = {}) => (state, dispatch) => {\n    const nodeWithPos = (0,_milkdown_prose__WEBPACK_IMPORTED_MODULE_4__.findSelectedNodeOfType)(\n      state.selection,\n      imageSchema.type(ctx)\n    );\n    if (!nodeWithPos) return false;\n    const { node, pos } = nodeWithPos;\n    const newAttrs = { ...node.attrs };\n    const { src, alt, title } = payload;\n    if (src !== void 0) newAttrs.src = src;\n    if (alt !== void 0) newAttrs.alt = alt;\n    if (title !== void 0) newAttrs.title = title;\n    dispatch == null ? void 0 : dispatch(\n      state.tr.setNodeMarkup(pos, void 0, newAttrs).scrollIntoView()\n    );\n    return true;\n  }\n);\nwithMeta(updateImageCommand, {\n  displayName: \"Command<updateImageCommand>\",\n  group: \"Image\"\n});\nconst insertImageInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)(\n  (ctx) => new _milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.InputRule(\n    /!\\[(?<alt>.*?)]\\((?<filename>.*?)\\s*(?=\"|\\))\"?(?<title>[^\"]+)?\"?\\)/,\n    (state, match, start, end) => {\n      const [matched, alt, src = \"\", title] = match;\n      if (matched)\n        return state.tr.replaceWith(\n          start,\n          end,\n          imageSchema.type(ctx).create({ src, alt, title })\n        );\n      return null;\n    }\n  )\n);\nwithMeta(insertImageInputRule, {\n  displayName: \"InputRule<insertImageInputRule>\",\n  group: \"Image\"\n});\nconst hardbreakAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"hardbreak\", (node) => {\n  return {\n    \"data-type\": \"hardbreak\",\n    \"data-is-inline\": node.attrs.isInline\n  };\n});\nwithMeta(hardbreakAttr, {\n  displayName: \"Attr<hardbreak>\",\n  group: \"Hardbreak\"\n});\nconst hardbreakSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"hardbreak\", (ctx) => ({\n  inline: true,\n  group: \"inline\",\n  attrs: {\n    isInline: {\n      default: false,\n      validate: \"boolean\"\n    }\n  },\n  selectable: false,\n  parseDOM: [\n    { tag: \"br\" },\n    {\n      tag: 'span[data-type=\"hardbreak\"]',\n      getAttrs: () => ({ isInline: true })\n    }\n  ],\n  toDOM: (node) => node.attrs.isInline ? [\"span\", ctx.get(hardbreakAttr.key)(node), \" \"] : [\"br\", ctx.get(hardbreakAttr.key)(node)],\n  parseMarkdown: {\n    match: ({ type }) => type === \"break\",\n    runner: (state, node, type) => {\n      var _a;\n      state.addNode(type, {\n        isInline: Boolean(\n          (_a = node.data) == null ? void 0 : _a.isInline\n        )\n      });\n    }\n  },\n  leafText: () => \"\\n\",\n  toMarkdown: {\n    match: (node) => node.type.name === \"hardbreak\",\n    runner: (state, node) => {\n      if (node.attrs.isInline) state.addNode(\"text\", void 0, \"\\n\");\n      else state.addNode(\"break\");\n    }\n  }\n}));\nwithMeta(hardbreakSchema.node, {\n  displayName: \"NodeSchema<hardbreak>\",\n  group: \"Hardbreak\"\n});\nwithMeta(hardbreakSchema.ctx, {\n  displayName: \"NodeSchemaCtx<hardbreak>\",\n  group: \"Hardbreak\"\n});\nconst insertHardbreakCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"InsertHardbreak\",\n  (ctx) => () => (state, dispatch) => {\n    var _a;\n    const { selection, tr } = state;\n    if (!(selection instanceof _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.TextSelection)) return false;\n    if (selection.empty) {\n      const node = selection.$from.node();\n      if (node.childCount > 0 && ((_a = node.lastChild) == null ? void 0 : _a.type.name) === \"hardbreak\") {\n        dispatch == null ? void 0 : dispatch(\n          tr.replaceRangeWith(\n            selection.to - 1,\n            selection.to,\n            state.schema.node(\"paragraph\")\n          ).setSelection(_milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Selection.near(tr.doc.resolve(selection.to))).scrollIntoView()\n        );\n        return true;\n      }\n    }\n    dispatch == null ? void 0 : dispatch(\n      tr.setMeta(\"hardbreak\", true).replaceSelectionWith(hardbreakSchema.type(ctx).create()).scrollIntoView()\n    );\n    return true;\n  }\n);\nwithMeta(insertHardbreakCommand, {\n  displayName: \"Command<insertHardbreakCommand>\",\n  group: \"Hardbreak\"\n});\nconst hardbreakKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"hardbreakKeymap\", {\n  InsertHardbreak: {\n    shortcuts: \"Shift-Enter\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(insertHardbreakCommand.key);\n    }\n  }\n});\nwithMeta(hardbreakKeymap.ctx, {\n  displayName: \"KeymapCtx<hardbreak>\",\n  group: \"Hardbreak\"\n});\nwithMeta(hardbreakKeymap.shortcuts, {\n  displayName: \"Keymap<hardbreak>\",\n  group: \"Hardbreak\"\n});\nconst hrAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"hr\");\nwithMeta(hrAttr, {\n  displayName: \"Attr<hr>\",\n  group: \"Hr\"\n});\nconst hrSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"hr\", (ctx) => ({\n  group: \"block\",\n  parseDOM: [{ tag: \"hr\" }],\n  toDOM: (node) => [\"hr\", ctx.get(hrAttr.key)(node)],\n  parseMarkdown: {\n    match: ({ type }) => type === \"thematicBreak\",\n    runner: (state, _, type) => {\n      state.addNode(type);\n    }\n  },\n  toMarkdown: {\n    match: (node) => node.type.name === \"hr\",\n    runner: (state) => {\n      state.addNode(\"thematicBreak\");\n    }\n  }\n}));\nwithMeta(hrSchema.node, {\n  displayName: \"NodeSchema<hr>\",\n  group: \"Hr\"\n});\nwithMeta(hrSchema.ctx, {\n  displayName: \"NodeSchemaCtx<hr>\",\n  group: \"Hr\"\n});\nconst insertHrInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)(\n  (ctx) => new _milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.InputRule(/^(?:---|___\\s|\\*\\*\\*\\s)$/, (state, match, start, end) => {\n    const { tr } = state;\n    if (match[0]) tr.replaceWith(start - 1, end, hrSchema.type(ctx).create());\n    return tr;\n  })\n);\nwithMeta(insertHrInputRule, {\n  displayName: \"InputRule<insertHrInputRule>\",\n  group: \"Hr\"\n});\nconst insertHrCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"InsertHr\",\n  (ctx) => () => (state, dispatch) => {\n    if (!dispatch) return true;\n    const paragraph = paragraphSchema.node.type(ctx).create();\n    const { tr, selection } = state;\n    const { from } = selection;\n    const node = hrSchema.type(ctx).create();\n    if (!node) return true;\n    const _tr = tr.replaceSelectionWith(node).insert(from, paragraph);\n    const sel = _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Selection.findFrom(_tr.doc.resolve(from), 1, true);\n    if (!sel) return true;\n    dispatch(_tr.setSelection(sel).scrollIntoView());\n    return true;\n  }\n);\nwithMeta(insertHrCommand, {\n  displayName: \"Command<insertHrCommand>\",\n  group: \"Hr\"\n});\nconst bulletListAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"bulletList\");\nwithMeta(bulletListAttr, {\n  displayName: \"Attr<bulletList>\",\n  group: \"BulletList\"\n});\nconst bulletListSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"bullet_list\", (ctx) => {\n  return {\n    content: \"listItem+\",\n    group: \"block\",\n    attrs: {\n      spread: {\n        default: false,\n        validate: \"boolean\"\n      }\n    },\n    parseDOM: [\n      {\n        tag: \"ul\",\n        getAttrs: (dom) => {\n          if (!(dom instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(dom);\n          return {\n            spread: dom.dataset.spread === \"true\"\n          };\n        }\n      }\n    ],\n    toDOM: (node) => {\n      return [\n        \"ul\",\n        {\n          ...ctx.get(bulletListAttr.key)(node),\n          \"data-spread\": node.attrs.spread\n        },\n        0\n      ];\n    },\n    parseMarkdown: {\n      match: ({ type, ordered }) => type === \"list\" && !ordered,\n      runner: (state, node, type) => {\n        const spread = node.spread != null ? `${node.spread}` : \"false\";\n        state.openNode(type, { spread }).next(node.children).closeNode();\n      }\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === \"bullet_list\",\n      runner: (state, node) => {\n        state.openNode(\"list\", void 0, {\n          ordered: false,\n          spread: node.attrs.spread\n        }).next(node.content).closeNode();\n      }\n    }\n  };\n});\nwithMeta(bulletListSchema.node, {\n  displayName: \"NodeSchema<bulletList>\",\n  group: \"BulletList\"\n});\nwithMeta(bulletListSchema.ctx, {\n  displayName: \"NodeSchemaCtx<bulletList>\",\n  group: \"BulletList\"\n});\nconst wrapInBulletListInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)(\n  (ctx) => (0,_milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.wrappingInputRule)(/^\\s*([-+*])\\s$/, bulletListSchema.type(ctx))\n);\nwithMeta(wrapInBulletListInputRule, {\n  displayName: \"InputRule<wrapInBulletListInputRule>\",\n  group: \"BulletList\"\n});\nconst wrapInBulletListCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"WrapInBulletList\",\n  (ctx) => () => (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.wrapIn)(bulletListSchema.type(ctx))\n);\nwithMeta(wrapInBulletListCommand, {\n  displayName: \"Command<wrapInBulletListCommand>\",\n  group: \"BulletList\"\n});\nconst bulletListKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"bulletListKeymap\", {\n  WrapInBulletList: {\n    shortcuts: \"Mod-Alt-8\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInBulletListCommand.key);\n    }\n  }\n});\nwithMeta(bulletListKeymap.ctx, {\n  displayName: \"KeymapCtx<bulletListKeymap>\",\n  group: \"BulletList\"\n});\nwithMeta(bulletListKeymap.shortcuts, {\n  displayName: \"Keymap<bulletListKeymap>\",\n  group: \"BulletList\"\n});\nconst orderedListAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"orderedList\");\nwithMeta(orderedListAttr, {\n  displayName: \"Attr<orderedList>\",\n  group: \"OrderedList\"\n});\nconst orderedListSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"ordered_list\", (ctx) => ({\n  content: \"listItem+\",\n  group: \"block\",\n  attrs: {\n    order: {\n      default: 1,\n      validate: \"number\"\n    },\n    spread: {\n      default: false,\n      validate: \"boolean\"\n    }\n  },\n  parseDOM: [\n    {\n      tag: \"ol\",\n      getAttrs: (dom) => {\n        if (!(dom instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(dom);\n        return {\n          spread: dom.dataset.spread,\n          order: dom.hasAttribute(\"start\") ? Number(dom.getAttribute(\"start\")) : 1\n        };\n      }\n    }\n  ],\n  toDOM: (node) => [\n    \"ol\",\n    {\n      ...ctx.get(orderedListAttr.key)(node),\n      ...node.attrs.order === 1 ? {} : node.attrs.order,\n      \"data-spread\": node.attrs.spread\n    },\n    0\n  ],\n  parseMarkdown: {\n    match: ({ type, ordered }) => type === \"list\" && !!ordered,\n    runner: (state, node, type) => {\n      const spread = node.spread != null ? `${node.spread}` : \"true\";\n      state.openNode(type, { spread }).next(node.children).closeNode();\n    }\n  },\n  toMarkdown: {\n    match: (node) => node.type.name === \"ordered_list\",\n    runner: (state, node) => {\n      state.openNode(\"list\", void 0, {\n        ordered: true,\n        start: 1,\n        spread: node.attrs.spread === \"true\"\n      });\n      state.next(node.content);\n      state.closeNode();\n    }\n  }\n}));\nwithMeta(orderedListSchema.node, {\n  displayName: \"NodeSchema<orderedList>\",\n  group: \"OrderedList\"\n});\nwithMeta(orderedListSchema.ctx, {\n  displayName: \"NodeSchemaCtx<orderedList>\",\n  group: \"OrderedList\"\n});\nconst wrapInOrderedListInputRule = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$inputRule)(\n  (ctx) => (0,_milkdown_prose_inputrules__WEBPACK_IMPORTED_MODULE_8__.wrappingInputRule)(\n    /^\\s*(\\d+)\\.\\s$/,\n    orderedListSchema.type(ctx),\n    (match) => ({ order: Number(match[1]) }),\n    (match, node) => node.childCount + node.attrs.order === Number(match[1])\n  )\n);\nwithMeta(wrapInOrderedListInputRule, {\n  displayName: \"InputRule<wrapInOrderedListInputRule>\",\n  group: \"OrderedList\"\n});\nconst wrapInOrderedListCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"WrapInOrderedList\",\n  (ctx) => () => (0,_milkdown_prose_commands__WEBPACK_IMPORTED_MODULE_3__.wrapIn)(orderedListSchema.type(ctx))\n);\nwithMeta(wrapInOrderedListCommand, {\n  displayName: \"Command<wrapInOrderedListCommand>\",\n  group: \"OrderedList\"\n});\nconst orderedListKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"orderedListKeymap\", {\n  WrapInOrderedList: {\n    shortcuts: \"Mod-Alt-7\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(wrapInOrderedListCommand.key);\n    }\n  }\n});\nwithMeta(orderedListKeymap.ctx, {\n  displayName: \"KeymapCtx<orderedList>\",\n  group: \"OrderedList\"\n});\nwithMeta(orderedListKeymap.shortcuts, {\n  displayName: \"Keymap<orderedList>\",\n  group: \"OrderedList\"\n});\nconst listItemAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"listItem\");\nwithMeta(listItemAttr, {\n  displayName: \"Attr<listItem>\",\n  group: \"ListItem\"\n});\nconst listItemSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"list_item\", (ctx) => ({\n  group: \"listItem\",\n  content: \"paragraph block*\",\n  attrs: {\n    label: {\n      default: \"•\",\n      validate: \"string\"\n    },\n    listType: {\n      default: \"bullet\",\n      validate: \"string\"\n    },\n    spread: {\n      default: true,\n      validate: \"boolean\"\n    }\n  },\n  defining: true,\n  parseDOM: [\n    {\n      tag: \"li\",\n      getAttrs: (dom) => {\n        if (!(dom instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_5__.expectDomTypeError)(dom);\n        return {\n          label: dom.dataset.label,\n          listType: dom.dataset.listType,\n          spread: dom.dataset.spread === \"true\"\n        };\n      }\n    }\n  ],\n  toDOM: (node) => [\n    \"li\",\n    {\n      ...ctx.get(listItemAttr.key)(node),\n      \"data-label\": node.attrs.label,\n      \"data-list-type\": node.attrs.listType,\n      \"data-spread\": node.attrs.spread\n    },\n    0\n  ],\n  parseMarkdown: {\n    match: ({ type }) => type === \"listItem\",\n    runner: (state, node, type) => {\n      const label = node.label != null ? `${node.label}.` : \"•\";\n      const listType = node.label != null ? \"ordered\" : \"bullet\";\n      const spread = node.spread != null ? `${node.spread}` : \"true\";\n      state.openNode(type, { label, listType, spread });\n      state.next(node.children);\n      state.closeNode();\n    }\n  },\n  toMarkdown: {\n    match: (node) => node.type.name === \"list_item\",\n    runner: (state, node) => {\n      state.openNode(\"listItem\", void 0, {\n        spread: node.attrs.spread\n      });\n      state.next(node.content);\n      state.closeNode();\n    }\n  }\n}));\nwithMeta(listItemSchema.node, {\n  displayName: \"NodeSchema<listItem>\",\n  group: \"ListItem\"\n});\nwithMeta(listItemSchema.ctx, {\n  displayName: \"NodeSchemaCtx<listItem>\",\n  group: \"ListItem\"\n});\nconst sinkListItemCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"SinkListItem\",\n  (ctx) => () => (0,_milkdown_prose_schema_list__WEBPACK_IMPORTED_MODULE_9__.sinkListItem)(listItemSchema.type(ctx))\n);\nwithMeta(sinkListItemCommand, {\n  displayName: \"Command<sinkListItemCommand>\",\n  group: \"ListItem\"\n});\nconst liftListItemCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"LiftListItem\",\n  (ctx) => () => (0,_milkdown_prose_schema_list__WEBPACK_IMPORTED_MODULE_9__.liftListItem)(listItemSchema.type(ctx))\n);\nwithMeta(liftListItemCommand, {\n  displayName: \"Command<liftListItemCommand>\",\n  group: \"ListItem\"\n});\nconst splitListItemCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"SplitListItem\",\n  (ctx) => () => (0,_milkdown_prose_schema_list__WEBPACK_IMPORTED_MODULE_9__.splitListItem)(listItemSchema.type(ctx))\n);\nwithMeta(splitListItemCommand, {\n  displayName: \"Command<splitListItemCommand>\",\n  group: \"ListItem\"\n});\nfunction liftFirstListItem(ctx) {\n  return (state, dispatch, view) => {\n    const { selection } = state;\n    if (!(selection instanceof _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.TextSelection)) return false;\n    const { empty, $from } = selection;\n    if (!empty || $from.parentOffset !== 0) return false;\n    const parentItem = $from.node(-1);\n    if (parentItem.type !== listItemSchema.type(ctx) || parentItem.firstChild !== $from.node())\n      return false;\n    const list = $from.node(-2);\n    if (list.childCount > 1) return false;\n    return (0,_milkdown_prose_schema_list__WEBPACK_IMPORTED_MODULE_9__.liftListItem)(listItemSchema.type(ctx))(state, dispatch, view);\n  };\n}\nconst liftFirstListItemCommand = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$command)(\n  \"LiftFirstListItem\",\n  (ctx) => () => liftFirstListItem(ctx)\n);\nwithMeta(liftFirstListItemCommand, {\n  displayName: \"Command<liftFirstListItemCommand>\",\n  group: \"ListItem\"\n});\nconst listItemKeymap = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$useKeymap)(\"listItemKeymap\", {\n  NextListItem: {\n    shortcuts: \"Enter\",\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(splitListItemCommand.key);\n    }\n  },\n  SinkListItem: {\n    shortcuts: [\"Tab\", \"Mod-]\"],\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(sinkListItemCommand.key);\n    }\n  },\n  LiftListItem: {\n    shortcuts: [\"Shift-Tab\", \"Mod-[\"],\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(liftListItemCommand.key);\n    }\n  },\n  LiftFirstListItem: {\n    shortcuts: [\"Backspace\", \"Delete\"],\n    command: (ctx) => {\n      const commands2 = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx);\n      return () => commands2.call(liftFirstListItemCommand.key);\n    }\n  }\n});\nwithMeta(listItemKeymap.ctx, {\n  displayName: \"KeymapCtx<listItem>\",\n  group: \"ListItem\"\n});\nwithMeta(listItemKeymap.shortcuts, {\n  displayName: \"Keymap<listItem>\",\n  group: \"ListItem\"\n});\nconst textSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$node)(\"text\", () => ({\n  group: \"inline\",\n  parseMarkdown: {\n    match: ({ type }) => type === \"text\",\n    runner: (state, node) => {\n      state.addText(node.value);\n    }\n  },\n  toMarkdown: {\n    match: (node) => node.type.name === \"text\",\n    runner: (state, node) => {\n      state.addNode(\"text\", void 0, node.text);\n    }\n  }\n}));\nwithMeta(textSchema, {\n  displayName: \"NodeSchema<text>\",\n  group: \"Text\"\n});\nconst htmlAttr = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeAttr)(\"html\");\nwithMeta(htmlAttr, {\n  displayName: \"Attr<html>\",\n  group: \"Html\"\n});\nconst htmlSchema = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$nodeSchema)(\"html\", (ctx) => {\n  return {\n    atom: true,\n    group: \"inline\",\n    inline: true,\n    attrs: {\n      value: {\n        default: \"\",\n        validate: \"string\"\n      }\n    },\n    toDOM: (node) => {\n      const span = document.createElement(\"span\");\n      const attr = {\n        ...ctx.get(htmlAttr.key)(node),\n        \"data-value\": node.attrs.value,\n        \"data-type\": \"html\"\n      };\n      span.textContent = node.attrs.value;\n      return [\"span\", attr, node.attrs.value];\n    },\n    parseDOM: [\n      {\n        tag: 'span[data-type=\"html\"]',\n        getAttrs: (dom) => {\n          return {\n            value: dom.dataset.value ?? \"\"\n          };\n        }\n      }\n    ],\n    parseMarkdown: {\n      match: ({ type }) => Boolean(type === \"html\"),\n      runner: (state, node, type) => {\n        state.addNode(type, { value: node.value });\n      }\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === \"html\",\n      runner: (state, node) => {\n        state.addNode(\"html\", void 0, node.attrs.value);\n      }\n    }\n  };\n});\nwithMeta(htmlSchema.node, {\n  displayName: \"NodeSchema<html>\",\n  group: \"Html\"\n});\nwithMeta(htmlSchema.ctx, {\n  displayName: \"NodeSchemaCtx<html>\",\n  group: \"Html\"\n});\nconst schema = [\n  docSchema,\n  paragraphAttr,\n  paragraphSchema,\n  headingIdGenerator,\n  headingAttr,\n  headingSchema,\n  hardbreakAttr,\n  hardbreakSchema,\n  blockquoteAttr,\n  blockquoteSchema,\n  codeBlockAttr,\n  codeBlockSchema,\n  hrAttr,\n  hrSchema,\n  imageAttr,\n  imageSchema,\n  bulletListAttr,\n  bulletListSchema,\n  orderedListAttr,\n  orderedListSchema,\n  listItemAttr,\n  listItemSchema,\n  emphasisAttr,\n  emphasisSchema,\n  strongAttr,\n  strongSchema,\n  inlineCodeAttr,\n  inlineCodeSchema,\n  linkAttr,\n  linkSchema,\n  htmlAttr,\n  htmlSchema,\n  textSchema\n].flat();\nconst inputRules = [\n  wrapInBlockquoteInputRule,\n  wrapInBulletListInputRule,\n  wrapInOrderedListInputRule,\n  createCodeBlockInputRule,\n  insertHrInputRule,\n  wrapInHeadingInputRule\n].flat();\nconst markInputRules = [\n  emphasisStarInputRule,\n  emphasisUnderscoreInputRule,\n  inlineCodeInputRule,\n  strongInputRule\n];\nconst commands = [\n  turnIntoTextCommand,\n  wrapInBlockquoteCommand,\n  wrapInHeadingCommand,\n  downgradeHeadingCommand,\n  createCodeBlockCommand,\n  insertHardbreakCommand,\n  insertHrCommand,\n  insertImageCommand,\n  updateImageCommand,\n  wrapInOrderedListCommand,\n  wrapInBulletListCommand,\n  sinkListItemCommand,\n  splitListItemCommand,\n  liftListItemCommand,\n  liftFirstListItemCommand,\n  toggleEmphasisCommand,\n  toggleInlineCodeCommand,\n  toggleStrongCommand,\n  toggleLinkCommand,\n  updateLinkCommand\n];\nconst keymap = [\n  blockquoteKeymap,\n  codeBlockKeymap,\n  hardbreakKeymap,\n  headingKeymap,\n  listItemKeymap,\n  orderedListKeymap,\n  bulletListKeymap,\n  paragraphKeymap,\n  emphasisKeymap,\n  inlineCodeKeymap,\n  strongKeymap\n].flat();\nconst remarkAddOrderInListPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$remark)(\n  \"remarkAddOrderInList\",\n  () => () => (tree) => {\n    (0,unist_util_visit__WEBPACK_IMPORTED_MODULE_10__.visit)(tree, \"list\", (node) => {\n      if (node.ordered) {\n        const start = node.start ?? 1;\n        node.children.forEach((child, index) => {\n          child.label = index + start;\n        });\n      }\n    });\n  }\n);\nwithMeta(remarkAddOrderInListPlugin.plugin, {\n  displayName: \"Remark<remarkAddOrderInListPlugin>\",\n  group: \"Remark\"\n});\nwithMeta(remarkAddOrderInListPlugin.options, {\n  displayName: \"RemarkConfig<remarkAddOrderInListPlugin>\",\n  group: \"Remark\"\n});\nconst remarkLineBreak = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$remark)(\n  \"remarkLineBreak\",\n  () => () => (tree) => {\n    const find = /[\\t ]*(?:\\r?\\n|\\r)/g;\n    (0,unist_util_visit__WEBPACK_IMPORTED_MODULE_10__.visit)(\n      tree,\n      \"text\",\n      (node, index, parent) => {\n        if (!node.value || typeof node.value !== \"string\") return;\n        const result = [];\n        let start = 0;\n        find.lastIndex = 0;\n        let match = find.exec(node.value);\n        while (match) {\n          const position = match.index;\n          if (start !== position)\n            result.push({\n              type: \"text\",\n              value: node.value.slice(start, position)\n            });\n          result.push({ type: \"break\", data: { isInline: true } });\n          start = position + match[0].length;\n          match = find.exec(node.value);\n        }\n        const hasResultAndIndex = result.length > 0 && parent && typeof index === \"number\";\n        if (!hasResultAndIndex) return;\n        if (start < node.value.length)\n          result.push({ type: \"text\", value: node.value.slice(start) });\n        parent.children.splice(index, 1, ...result);\n        return index + result.length;\n      }\n    );\n  }\n);\nwithMeta(remarkLineBreak.plugin, {\n  displayName: \"Remark<remarkLineBreak>\",\n  group: \"Remark\"\n});\nwithMeta(remarkLineBreak.options, {\n  displayName: \"RemarkConfig<remarkLineBreak>\",\n  group: \"Remark\"\n});\nconst remarkInlineLinkPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$remark)(\n  \"remarkInlineLink\",\n  () => remark_inline_links__WEBPACK_IMPORTED_MODULE_11__[\"default\"]\n);\nwithMeta(remarkInlineLinkPlugin.plugin, {\n  displayName: \"Remark<remarkInlineLinkPlugin>\",\n  group: \"Remark\"\n});\nwithMeta(remarkInlineLinkPlugin.options, {\n  displayName: \"RemarkConfig<remarkInlineLinkPlugin>\",\n  group: \"Remark\"\n});\nconst isParent = (node) => !!node.children;\nconst isHTML = (node) => node.type === \"html\";\nfunction flatMapWithDepth(ast, fn) {\n  return transform(ast, 0, null)[0];\n  function transform(node, index, parent) {\n    if (isParent(node)) {\n      const out = [];\n      for (let i = 0, n = node.children.length; i < n; i++) {\n        const nthChild = node.children[i];\n        if (nthChild) {\n          const xs = transform(nthChild, i, node);\n          if (xs) {\n            for (let j = 0, m = xs.length; j < m; j++) {\n              const item = xs[j];\n              if (item) out.push(item);\n            }\n          }\n        }\n      }\n      node.children = out;\n    }\n    return fn(node, index, parent);\n  }\n}\nconst remarkHtmlTransformer = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$remark)(\n  \"remarkHTMLTransformer\",\n  () => () => (tree) => {\n    flatMapWithDepth(tree, (node, _index, parent) => {\n      if (!isHTML(node)) return [node];\n      if ((parent == null ? void 0 : parent.type) === \"root\") {\n        node.children = [{ ...node }];\n        delete node.value;\n        node.type = \"paragraph\";\n      }\n      return [node];\n    });\n  }\n);\nwithMeta(remarkHtmlTransformer.plugin, {\n  displayName: \"Remark<remarkHtmlTransformer>\",\n  group: \"Remark\"\n});\nwithMeta(remarkHtmlTransformer.options, {\n  displayName: \"RemarkConfig<remarkHtmlTransformer>\",\n  group: \"Remark\"\n});\nconst remarkMarker = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$remark)(\n  \"remarkMarker\",\n  () => () => (tree, file) => {\n    const getMarker = (node) => {\n      return file.value.charAt(node.position.start.offset);\n    };\n    (0,unist_util_visit__WEBPACK_IMPORTED_MODULE_10__.visit)(\n      tree,\n      (node) => [\"strong\", \"emphasis\"].includes(node.type),\n      (node) => {\n        node.marker = getMarker(node);\n      }\n    );\n  }\n);\nwithMeta(remarkMarker.plugin, {\n  displayName: \"Remark<remarkMarker>\",\n  group: \"Remark\"\n});\nwithMeta(remarkMarker.options, {\n  displayName: \"RemarkConfig<remarkMarker>\",\n  group: \"Remark\"\n});\nconst inlineNodesCursorPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$prose)(() => {\n  let lock = false;\n  const inlineNodesCursorPluginKey = new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.PluginKey(\n    \"MILKDOWN_INLINE_NODES_CURSOR\"\n  );\n  const inlineNodesCursorPlugin2 = new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Plugin({\n    key: inlineNodesCursorPluginKey,\n    state: {\n      init() {\n        return false;\n      },\n      apply(tr) {\n        if (!tr.selection.empty) return false;\n        const pos = tr.selection.$from;\n        const left = pos.nodeBefore;\n        const right = pos.nodeAfter;\n        if (left && right && left.isInline && !left.isText && right.isInline && !right.isText)\n          return true;\n        return false;\n      }\n    },\n    props: {\n      handleDOMEvents: {\n        compositionend: (view, e) => {\n          if (lock) {\n            lock = false;\n            requestAnimationFrame(() => {\n              const active = inlineNodesCursorPlugin2.getState(view.state);\n              if (active) {\n                const from = view.state.selection.from;\n                e.preventDefault();\n                view.dispatch(view.state.tr.insertText(e.data || \"\", from));\n              }\n            });\n            return true;\n          }\n          return false;\n        },\n        compositionstart: (view) => {\n          const active = inlineNodesCursorPlugin2.getState(view.state);\n          if (active) lock = true;\n          return false;\n        },\n        beforeinput: (view, e) => {\n          const active = inlineNodesCursorPlugin2.getState(view.state);\n          if (active && e instanceof InputEvent && e.data && !lock) {\n            const from = view.state.selection.from;\n            e.preventDefault();\n            view.dispatch(view.state.tr.insertText(e.data || \"\", from));\n            return true;\n          }\n          return false;\n        }\n      },\n      decorations(state) {\n        const active = inlineNodesCursorPlugin2.getState(state);\n        if (active) {\n          const pos = state.selection.$from;\n          const position = pos.pos;\n          const left = document.createElement(\"span\");\n          const leftDec = _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__.Decoration.widget(position, left, {\n            side: -1\n          });\n          const right = document.createElement(\"span\");\n          const rightDec = _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__.Decoration.widget(position, right);\n          setTimeout(() => {\n            left.contentEditable = \"true\";\n            right.contentEditable = \"true\";\n          });\n          return _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__.DecorationSet.create(state.doc, [leftDec, rightDec]);\n        }\n        return _milkdown_prose_view__WEBPACK_IMPORTED_MODULE_12__.DecorationSet.empty;\n      }\n    }\n  });\n  return inlineNodesCursorPlugin2;\n});\nwithMeta(inlineNodesCursorPlugin, {\n  displayName: \"Prose<inlineNodesCursorPlugin>\",\n  group: \"Prose\"\n});\nconst hardbreakClearMarkPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$prose)((ctx) => {\n  return new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Plugin({\n    key: new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.PluginKey(\"MILKDOWN_HARDBREAK_MARKS\"),\n    appendTransaction: (trs, _oldState, newState) => {\n      if (!trs.length) return;\n      const [tr] = trs;\n      if (!tr) return;\n      const [step] = tr.steps;\n      const isInsertHr = tr.getMeta(\"hardbreak\");\n      if (isInsertHr) {\n        if (!(step instanceof _milkdown_prose_transform__WEBPACK_IMPORTED_MODULE_13__.ReplaceStep)) return;\n        const { from } = step;\n        return newState.tr.setNodeMarkup(\n          from,\n          hardbreakSchema.type(ctx),\n          void 0,\n          []\n        );\n      }\n      const isAddMarkStep = step instanceof _milkdown_prose_transform__WEBPACK_IMPORTED_MODULE_13__.AddMarkStep;\n      if (isAddMarkStep) {\n        let _tr = newState.tr;\n        const { from, to } = step;\n        newState.doc.nodesBetween(from, to, (node, pos) => {\n          if (node.type === hardbreakSchema.type(ctx))\n            _tr = _tr.setNodeMarkup(\n              pos,\n              hardbreakSchema.type(ctx),\n              void 0,\n              []\n            );\n        });\n        return _tr;\n      }\n      return void 0;\n    }\n  });\n});\nwithMeta(hardbreakClearMarkPlugin, {\n  displayName: \"Prose<hardbreakClearMarkPlugin>\",\n  group: \"Prose\"\n});\nconst hardbreakFilterNodes = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$ctx)(\n  [\"table\", \"code_block\"],\n  \"hardbreakFilterNodes\"\n);\nwithMeta(hardbreakFilterNodes, {\n  displayName: \"Ctx<hardbreakFilterNodes>\",\n  group: \"Prose\"\n});\nconst hardbreakFilterPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$prose)((ctx) => {\n  const notIn = ctx.get(hardbreakFilterNodes.key);\n  return new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Plugin({\n    key: new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.PluginKey(\"MILKDOWN_HARDBREAK_FILTER\"),\n    filterTransaction: (tr, state) => {\n      const isInsertHr = tr.getMeta(\"hardbreak\");\n      const [step] = tr.steps;\n      if (isInsertHr && step) {\n        const { from } = step;\n        const $from = state.doc.resolve(from);\n        let curDepth = $from.depth;\n        let canApply = true;\n        while (curDepth > 0) {\n          if (notIn.includes($from.node(curDepth).type.name)) canApply = false;\n          curDepth--;\n        }\n        return canApply;\n      }\n      return true;\n    }\n  });\n});\nwithMeta(hardbreakFilterPlugin, {\n  displayName: \"Prose<hardbreakFilterPlugin>\",\n  group: \"Prose\"\n});\nconst syncHeadingIdPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$prose)((ctx) => {\n  const headingIdPluginKey = new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.PluginKey(\"MILKDOWN_HEADING_ID\");\n  const updateId = (view) => {\n    if (view.composing) return;\n    const getId = ctx.get(headingIdGenerator.key);\n    const tr = view.state.tr.setMeta(\"addToHistory\", false);\n    let found = false;\n    const idMap = {};\n    view.state.doc.descendants((node, pos) => {\n      if (node.type === headingSchema.type(ctx)) {\n        if (node.textContent.trim().length === 0) return;\n        const attrs = node.attrs;\n        let id = getId(node);\n        if (idMap[id]) {\n          idMap[id] += 1;\n          id += `-#${idMap[id]}`;\n        } else {\n          idMap[id] = 1;\n        }\n        if (attrs.id !== id) {\n          found = true;\n          tr.setMeta(headingIdPluginKey, true).setNodeMarkup(pos, void 0, {\n            ...attrs,\n            id\n          });\n        }\n      }\n    });\n    if (found) view.dispatch(tr);\n  };\n  return new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Plugin({\n    key: headingIdPluginKey,\n    view: (view) => {\n      updateId(view);\n      return {\n        update: (view2, prevState) => {\n          if (view2.state.doc.eq(prevState.doc)) return;\n          updateId(view2);\n        }\n      };\n    }\n  });\n});\nwithMeta(syncHeadingIdPlugin, {\n  displayName: \"Prose<syncHeadingIdPlugin>\",\n  group: \"Prose\"\n});\nconst syncListOrderPlugin = (0,_milkdown_utils__WEBPACK_IMPORTED_MODULE_1__.$prose)((ctx) => {\n  const syncOrderLabel = (view) => {\n    if (view.composing || !view.editable) return;\n    const orderedListType = orderedListSchema.type(ctx);\n    const bulletListType = bulletListSchema.type(ctx);\n    const listItemType = listItemSchema.type(ctx);\n    const state = view.state;\n    const handleNodeItem = (attrs, index) => {\n      let changed = false;\n      const expectedLabel = `${index + 1}.`;\n      if (attrs.label !== expectedLabel) {\n        attrs.label = expectedLabel;\n        changed = true;\n      }\n      return changed;\n    };\n    let tr = state.tr;\n    let needDispatch = false;\n    state.doc.descendants((node, pos, parent, index) => {\n      if (node.type === bulletListType) {\n        const base = node.maybeChild(0);\n        if ((base == null ? void 0 : base.type) === listItemType && base.attrs.listType === \"ordered\") {\n          needDispatch = true;\n          tr.setNodeMarkup(pos, orderedListType, { spread: \"true\" });\n          node.descendants((child, pos2, _parent, index2) => {\n            if (child.type === listItemType) {\n              const attrs = { ...child.attrs };\n              const changed = handleNodeItem(attrs, index2);\n              if (changed) tr = tr.setNodeMarkup(pos2, void 0, attrs);\n            }\n            return false;\n          });\n        }\n      } else if (node.type === listItemType && (parent == null ? void 0 : parent.type) === orderedListType) {\n        const attrs = { ...node.attrs };\n        let changed = false;\n        if (attrs.listType !== \"ordered\") {\n          attrs.listType = \"ordered\";\n          changed = true;\n        }\n        const base = parent == null ? void 0 : parent.maybeChild(0);\n        if (base) changed = handleNodeItem(attrs, index);\n        if (changed) {\n          tr = tr.setNodeMarkup(pos, void 0, attrs);\n          needDispatch = true;\n        }\n      }\n    });\n    if (needDispatch) view.dispatch(tr.setMeta(\"addToHistory\", false));\n  };\n  return new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.Plugin({\n    key: new _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.PluginKey(\"MILKDOWN_KEEP_LIST_ORDER\"),\n    view: (view) => {\n      syncOrderLabel(view);\n      return {\n        update: (view2) => {\n          syncOrderLabel(view2);\n        }\n      };\n    }\n  });\n});\nwithMeta(syncListOrderPlugin, {\n  displayName: \"Prose<syncListOrderPlugin>\",\n  group: \"Prose\"\n});\nconst plugins = [\n  hardbreakClearMarkPlugin,\n  hardbreakFilterNodes,\n  hardbreakFilterPlugin,\n  inlineNodesCursorPlugin,\n  remarkAddOrderInListPlugin,\n  remarkInlineLinkPlugin,\n  remarkLineBreak,\n  remarkHtmlTransformer,\n  remarkMarker,\n  remarkPreserveEmptyLinePlugin,\n  syncHeadingIdPlugin,\n  syncListOrderPlugin\n].flat();\nconst commonmark = [\n  schema,\n  inputRules,\n  markInputRules,\n  commands,\n  keymap,\n  plugins\n].flat();\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3ByZXNldC1jb21tb25tYXJrL2xpYi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWlKO0FBQzFEO0FBQ1g7QUFDcEI7QUFDUDtBQUNRO0FBQ3lDO0FBQ2Q7QUFDakI7QUFDcUI7QUFDbkI7QUFDSjtBQUN4QjtBQUNXO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsYUFBYSwyREFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EscUJBQXFCLDBEQUFTO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCx1QkFBdUIsNERBQVc7QUFDbEM7QUFDQTtBQUNBLHVCQUF1QixxRUFBeUI7QUFDaEQ7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLE1BQU0sVUFBVTtBQUNoQixNQUFNLFdBQVc7QUFDakIsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMscUJBQXFCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCw4QkFBOEIseURBQVE7QUFDdEMsU0FBUyxvRUFBVTtBQUNuQixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDhCQUE4QiwyREFBVTtBQUN4QyxTQUFTLHlEQUFRO0FBQ2pCO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsdUJBQXVCLGtC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Q0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCw0QkFBNEIsdURBQU07QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixVQUFVO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGdCQUFnQjtBQUNuRTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsUUFBUTtBQUNSLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGFBQWEseURBQU07QUFDbkIsYUFBYSw0REFBUztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFpR0U7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JhaW4yL0RvY3VtZW50cy9ub3RlQ2FyZC9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3ByZXNldC1jb21tb25tYXJrL2xpYi9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyAkbWFya0F0dHIsICRtYXJrU2NoZW1hLCAkaW5wdXRSdWxlLCAkY29tbWFuZCwgJHVzZUtleW1hcCwgJG5vZGUsICRyZW1hcmssICRub2RlQXR0ciwgJG5vZGVTY2hlbWEsICRjdHgsICRwcm9zZSB9IGZyb20gXCJAbWlsa2Rvd24vdXRpbHNcIjtcbmltcG9ydCB7IHJlbWFya1N0cmluZ2lmeU9wdGlvbnNDdHgsIGNvbW1hbmRzQ3R4LCBlZGl0b3JWaWV3Q3R4IH0gZnJvbSBcIkBtaWxrZG93bi9jb3JlXCI7XG5pbXBvcnQgeyB0b2dnbGVNYXJrLCBzZXRCbG9ja1R5cGUsIHdyYXBJbiB9IGZyb20gXCJAbWlsa2Rvd24vcHJvc2UvY29tbWFuZHNcIjtcbmltcG9ydCB7IHZpc2l0UGFyZW50cyB9IGZyb20gXCJ1bmlzdC11dGlsLXZpc2l0LXBhcmVudHNcIjtcbmltcG9ydCB7IEZyYWdtZW50IH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZS9tb2RlbFwiO1xuaW1wb3J0IHsgZXhwZWN0RG9tVHlwZUVycm9yIH0gZnJvbSBcIkBtaWxrZG93bi9leGNlcHRpb25cIjtcbmltcG9ydCB7IHRleHRibG9ja1R5cGVJbnB1dFJ1bGUsIHdyYXBwaW5nSW5wdXRSdWxlLCBJbnB1dFJ1bGUgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL2lucHV0cnVsZXNcIjtcbmltcG9ydCB7IFRleHRTZWxlY3Rpb24sIFNlbGVjdGlvbiwgUGx1Z2luS2V5LCBQbHVnaW4gfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL3N0YXRlXCI7XG5pbXBvcnQgeyBtYXJrUnVsZSwgZmluZFNlbGVjdGVkTm9kZU9mVHlwZSB9IGZyb20gXCJAbWlsa2Rvd24vcHJvc2VcIjtcbmltcG9ydCB7IHNpbmtMaXN0SXRlbSwgc3BsaXRMaXN0SXRlbSwgbGlmdExpc3RJdGVtIH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZS9zY2hlbWEtbGlzdFwiO1xuaW1wb3J0IHsgUmVwbGFjZVN0ZXAsIEFkZE1hcmtTdGVwIH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZS90cmFuc2Zvcm1cIjtcbmltcG9ydCB7IERlY29yYXRpb24sIERlY29yYXRpb25TZXQgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL3ZpZXdcIjtcbmltcG9ydCB7IHZpc2l0IH0gZnJvbSBcInVuaXN0LXV0aWwtdmlzaXRcIjtcbmltcG9ydCByZW1hcmtJbmxpbmVMaW5rcyBmcm9tIFwicmVtYXJrLWlubGluZS1saW5rc1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplVGV4dChzdGF0ZSwgbm9kZSkge1xuICB2YXIgX2E7XG4gIGNvbnN0IGxhc3RJc0hhcmRCcmVhayA9IG5vZGUuY2hpbGRDb3VudCA+PSAxICYmICgoX2EgPSBub2RlLmxhc3RDaGlsZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnR5cGUubmFtZSkgPT09IFwiaGFyZGJyZWFrXCI7XG4gIGlmICghbGFzdElzSGFyZEJyZWFrKSB7XG4gICAgc3RhdGUubmV4dChub2RlLmNvbnRlbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjb250ZW50QXJyID0gW107XG4gIG5vZGUuY29udGVudC5mb3JFYWNoKChuLCBfLCBpKSA9PiB7XG4gICAgaWYgKGkgPT09IG5vZGUuY2hpbGRDb3VudCAtIDEpIHJldHVybjtcbiAgICBjb250ZW50QXJyLnB1c2gobik7XG4gIH0pO1xuICBzdGF0ZS5uZXh0KEZyYWdtZW50LmZyb21BcnJheShjb250ZW50QXJyKSk7XG59XG5mdW5jdGlvbiB3aXRoTWV0YShwbHVnaW4sIG1ldGEpIHtcbiAgT2JqZWN0LmFzc2lnbihwbHVnaW4sIHtcbiAgICBtZXRhOiB7XG4gICAgICBwYWNrYWdlOiBcIkBtaWxrZG93bi9wcmVzZXQtY29tbW9ubWFya1wiLFxuICAgICAgLi4ubWV0YVxuICAgIH1cbiAgfSk7XG4gIHJldHVybiBwbHVnaW47XG59XG5jb25zdCBlbXBoYXNpc0F0dHIgPSAkbWFya0F0dHIoXCJlbXBoYXNpc1wiKTtcbndpdGhNZXRhKGVtcGhhc2lzQXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGVtcGhhc2lzPlwiLFxuICBncm91cDogXCJFbXBoYXNpc1wiXG59KTtcbmNvbnN0IGVtcGhhc2lzU2NoZW1hID0gJG1hcmtTY2hlbWEoXCJlbXBoYXNpc1wiLCAoY3R4KSA9PiAoe1xuICBhdHRyczoge1xuICAgIG1hcmtlcjoge1xuICAgICAgZGVmYXVsdDogY3R4LmdldChyZW1hcmtTdHJpbmdpZnlPcHRpb25zQ3R4KS5lbXBoYXNpcyB8fCBcIipcIixcbiAgICAgIHZhbGlkYXRlOiBcInN0cmluZ1wiXG4gICAgfVxuICB9LFxuICBwYXJzZURPTTogW1xuICAgIHsgdGFnOiBcImlcIiB9LFxuICAgIHsgdGFnOiBcImVtXCIgfSxcbiAgICB7IHN0eWxlOiBcImZvbnQtc3R5bGVcIiwgZ2V0QXR0cnM6ICh2YWx1ZSkgPT4gdmFsdWUgPT09IFwiaXRhbGljXCIgfVxuICBdLFxuICB0b0RPTTogKG1hcmspID0+IFtcImVtXCIsIGN0eC5nZXQoZW1waGFzaXNBdHRyLmtleSkobWFyayldLFxuICBwYXJzZU1hcmtkb3duOiB7XG4gICAgbWF0Y2g6IChub2RlKSA9PiBub2RlLnR5cGUgPT09IFwiZW1waGFzaXNcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSwgbWFya1R5cGUpID0+IHtcbiAgICAgIHN0YXRlLm9wZW5NYXJrKG1hcmtUeXBlLCB7IG1hcmtlcjogbm9kZS5tYXJrZXIgfSk7XG4gICAgICBzdGF0ZS5uZXh0KG5vZGUuY2hpbGRyZW4pO1xuICAgICAgc3RhdGUuY2xvc2VNYXJrKG1hcmtUeXBlKTtcbiAgICB9XG4gIH0sXG4gIHRvTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG1hcmspID0+IG1hcmsudHlwZS5uYW1lID09PSBcImVtcGhhc2lzXCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG1hcmspID0+IHtcbiAgICAgIHN0YXRlLndpdGhNYXJrKG1hcmssIFwiZW1waGFzaXNcIiwgdm9pZCAwLCB7XG4gICAgICAgIG1hcmtlcjogbWFyay5hdHRycy5tYXJrZXJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkpO1xud2l0aE1ldGEoZW1waGFzaXNTY2hlbWEubWFyaywge1xuICBkaXNwbGF5TmFtZTogXCJNYXJrU2NoZW1hPGVtcGhhc2lzPlwiLFxuICBncm91cDogXCJFbXBoYXNpc1wiXG59KTtcbndpdGhNZXRhKGVtcGhhc2lzU2NoZW1hLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJNYXJrU2NoZW1hQ3R4PGVtcGhhc2lzPlwiLFxuICBncm91cDogXCJFbXBoYXNpc1wiXG59KTtcbmNvbnN0IHRvZ2dsZUVtcGhhc2lzQ29tbWFuZCA9ICRjb21tYW5kKFwiVG9nZ2xlRW1waGFzaXNcIiwgKGN0eCkgPT4gKCkgPT4ge1xuICByZXR1cm4gdG9nZ2xlTWFyayhlbXBoYXNpc1NjaGVtYS50eXBlKGN0eCkpO1xufSk7XG53aXRoTWV0YSh0b2dnbGVFbXBoYXNpc0NvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDx0b2dnbGVFbXBoYXNpc0NvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIkVtcGhhc2lzXCJcbn0pO1xuY29uc3QgZW1waGFzaXNTdGFySW5wdXRSdWxlID0gJGlucHV0UnVsZSgoY3R4KSA9PiB7XG4gIHJldHVybiBtYXJrUnVsZSgvKD86XnxbXipdKVxcKihbXipdKylcXCokLywgZW1waGFzaXNTY2hlbWEudHlwZShjdHgpLCB7XG4gICAgZ2V0QXR0cjogKCkgPT4gKHtcbiAgICAgIG1hcmtlcjogXCIqXCJcbiAgICB9KSxcbiAgICB1cGRhdGVDYXB0dXJlZDogKHsgZnVsbE1hdGNoLCBzdGFydCB9KSA9PiAhZnVsbE1hdGNoLnN0YXJ0c1dpdGgoXCIqXCIpID8geyBmdWxsTWF0Y2g6IGZ1bGxNYXRjaC5zbGljZSgxKSwgc3RhcnQ6IHN0YXJ0ICsgMSB9IDoge31cbiAgfSk7XG59KTtcbndpdGhNZXRhKGVtcGhhc2lzU3RhcklucHV0UnVsZSwge1xuICBkaXNwbGF5TmFtZTogXCJJbnB1dFJ1bGU8ZW1waGFzaXM+fFN0YXJcIixcbiAgZ3JvdXA6IFwiRW1waGFzaXNcIlxufSk7XG5jb25zdCBlbXBoYXNpc1VuZGVyc2NvcmVJbnB1dFJ1bGUgPSAkaW5wdXRSdWxlKChjdHgpID0+IHtcbiAgcmV0dXJuIG1hcmtSdWxlKC8oPzpefFteX10pXyhbXl9dKylfJC8sIGVtcGhhc2lzU2NoZW1hLnR5cGUoY3R4KSwge1xuICAgIGdldEF0dHI6ICgpID0+ICh7XG4gICAgICBtYXJrZXI6IFwiX1wiXG4gICAgfSksXG4gICAgdXBkYXRlQ2FwdHVyZWQ6ICh7IGZ1bGxNYXRjaCwgc3RhcnQgfSkgPT4gIWZ1bGxNYXRjaC5zdGFydHNXaXRoKFwiX1wiKSA/IHsgZnVsbE1hdGNoOiBmdWxsTWF0Y2guc2xpY2UoMSksIHN0YXJ0OiBzdGFydCArIDEgfSA6IHt9XG4gIH0pO1xufSk7XG53aXRoTWV0YShlbXBoYXNpc1VuZGVyc2NvcmVJbnB1dFJ1bGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiSW5wdXRSdWxlPGVtcGhhc2lzPnxVbmRlcnNjb3JlXCIsXG4gIGdyb3VwOiBcIkVtcGhhc2lzXCJcbn0pO1xuY29uc3QgZW1waGFzaXNLZXltYXAgPSAkdXNlS2V5bWFwKFwiZW1waGFzaXNLZXltYXBcIiwge1xuICBUb2dnbGVFbXBoYXNpczoge1xuICAgIHNob3J0Y3V0czogXCJNb2QtaVwiLFxuICAgIGNvbW1hbmQ6IChjdHgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1hbmRzMiA9IGN0eC5nZXQoY29tbWFuZHNDdHgpO1xuICAgICAgcmV0dXJuICgpID0+IGNvbW1hbmRzMi5jYWxsKHRvZ2dsZUVtcGhhc2lzQ29tbWFuZC5rZXkpO1xuICAgIH1cbiAgfVxufSk7XG53aXRoTWV0YShlbXBoYXNpc0tleW1hcC5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiS2V5bWFwQ3R4PGVtcGhhc2lzPlwiLFxuICBncm91cDogXCJFbXBoYXNpc1wiXG59KTtcbndpdGhNZXRhKGVtcGhhc2lzS2V5bWFwLnNob3J0Y3V0cywge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXA8ZW1waGFzaXM+XCIsXG4gIGdyb3VwOiBcIkVtcGhhc2lzXCJcbn0pO1xuY29uc3Qgc3Ryb25nQXR0ciA9ICRtYXJrQXR0cihcInN0cm9uZ1wiKTtcbndpdGhNZXRhKHN0cm9uZ0F0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxzdHJvbmc+XCIsXG4gIGdyb3VwOiBcIlN0cm9uZ1wiXG59KTtcbmNvbnN0IHN0cm9uZ1NjaGVtYSA9ICRtYXJrU2NoZW1hKFwic3Ryb25nXCIsIChjdHgpID0+ICh7XG4gIGF0dHJzOiB7XG4gICAgbWFya2VyOiB7XG4gICAgICBkZWZhdWx0OiBjdHguZ2V0KHJlbWFya1N0cmluZ2lmeU9wdGlvbnNDdHgpLnN0cm9uZyB8fCBcIipcIixcbiAgICAgIHZhbGlkYXRlOiBcInN0cmluZ1wiXG4gICAgfVxuICB9LFxuICBwYXJzZURPTTogW1xuICAgIC8vIFRoaXMgd29ya3MgYXJvdW5kIGEgR29vZ2xlIERvY3MgbWlzYmVoYXZpb3Igd2hlcmVcbiAgICAvLyBwYXN0ZWQgY29udGVudCB3aWxsIGJlIGluZXhwbGljYWJseSB3cmFwcGVkIGluIGA8Yj5gXG4gICAgLy8gdGFncyB3aXRoIGEgZm9udC13ZWlnaHQgbm9ybWFsLlxuICAgIHtcbiAgICAgIHRhZzogXCJiXCIsXG4gICAgICBnZXRBdHRyczogKG5vZGUpID0+IG5vZGUuc3R5bGUuZm9udFdlaWdodCAhPSBcIm5vcm1hbFwiICYmIG51bGxcbiAgICB9LFxuICAgIHsgdGFnOiBcInN0cm9uZ1wiIH0sXG4gICAgeyBzdHlsZTogXCJmb250LXN0eWxlXCIsIGdldEF0dHJzOiAodmFsdWUpID0+IHZhbHVlID09PSBcImJvbGRcIiB9LFxuICAgIHsgc3R5bGU6IFwiZm9udC13ZWlnaHQ9NDAwXCIsIGNsZWFyTWFyazogKG0pID0+IG0udHlwZS5uYW1lID09IFwic3Ryb25nXCIgfSxcbiAgICB7XG4gICAgICBzdHlsZTogXCJmb250LXdlaWdodFwiLFxuICAgICAgZ2V0QXR0cnM6ICh2YWx1ZSkgPT4gL14oYm9sZChlcik/fFs1LTldXFxkezIsfSkkLy50ZXN0KHZhbHVlKSAmJiBudWxsXG4gICAgfVxuICBdLFxuICB0b0RPTTogKG1hcmspID0+IFtcInN0cm9uZ1wiLCBjdHguZ2V0KHN0cm9uZ0F0dHIua2V5KShtYXJrKV0sXG4gIHBhcnNlTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZSA9PT0gXCJzdHJvbmdcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSwgbWFya1R5cGUpID0+IHtcbiAgICAgIHN0YXRlLm9wZW5NYXJrKG1hcmtUeXBlLCB7IG1hcmtlcjogbm9kZS5tYXJrZXIgfSk7XG4gICAgICBzdGF0ZS5uZXh0KG5vZGUuY2hpbGRyZW4pO1xuICAgICAgc3RhdGUuY2xvc2VNYXJrKG1hcmtUeXBlKTtcbiAgICB9XG4gIH0sXG4gIHRvTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG1hcmspID0+IG1hcmsudHlwZS5uYW1lID09PSBcInN0cm9uZ1wiLFxuICAgIHJ1bm5lcjogKHN0YXRlLCBtYXJrKSA9PiB7XG4gICAgICBzdGF0ZS53aXRoTWFyayhtYXJrLCBcInN0cm9uZ1wiLCB2b2lkIDAsIHtcbiAgICAgICAgbWFya2VyOiBtYXJrLmF0dHJzLm1hcmtlclxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSk7XG53aXRoTWV0YShzdHJvbmdTY2hlbWEubWFyaywge1xuICBkaXNwbGF5TmFtZTogXCJNYXJrU2NoZW1hPHN0cm9uZz5cIixcbiAgZ3JvdXA6IFwiU3Ryb25nXCJcbn0pO1xud2l0aE1ldGEoc3Ryb25nU2NoZW1hLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJNYXJrU2NoZW1hQ3R4PHN0cm9uZz5cIixcbiAgZ3JvdXA6IFwiU3Ryb25nXCJcbn0pO1xuY29uc3QgdG9nZ2xlU3Ryb25nQ29tbWFuZCA9ICRjb21tYW5kKFwiVG9nZ2xlU3Ryb25nXCIsIChjdHgpID0+ICgpID0+IHtcbiAgcmV0dXJuIHRvZ2dsZU1hcmsoc3Ryb25nU2NoZW1hLnR5cGUoY3R4KSk7XG59KTtcbndpdGhNZXRhKHRvZ2dsZVN0cm9uZ0NvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDx0b2dnbGVTdHJvbmdDb21tYW5kPlwiLFxuICBncm91cDogXCJTdHJvbmdcIlxufSk7XG5jb25zdCBzdHJvbmdJbnB1dFJ1bGUgPSAkaW5wdXRSdWxlKChjdHgpID0+IHtcbiAgcmV0dXJuIG1hcmtSdWxlKC8oPzpcXCpcXCp8X18pKFteKl9dKykoPzpcXCpcXCp8X18pJC8sIHN0cm9uZ1NjaGVtYS50eXBlKGN0eCksIHtcbiAgICBnZXRBdHRyOiAobWF0Y2gpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1hcmtlcjogbWF0Y2hbMF0uc3RhcnRzV2l0aChcIipcIikgPyBcIipcIiA6IFwiX1wiXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG59KTtcbndpdGhNZXRhKHN0cm9uZ0lucHV0UnVsZSwge1xuICBkaXNwbGF5TmFtZTogXCJJbnB1dFJ1bGU8c3Ryb25nPlwiLFxuICBncm91cDogXCJTdHJvbmdcIlxufSk7XG5jb25zdCBzdHJvbmdLZXltYXAgPSAkdXNlS2V5bWFwKFwic3Ryb25nS2V5bWFwXCIsIHtcbiAgVG9nZ2xlQm9sZDoge1xuICAgIHNob3J0Y3V0czogW1wiTW9kLWJcIl0sXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwodG9nZ2xlU3Ryb25nQ29tbWFuZC5rZXkpO1xuICAgIH1cbiAgfVxufSk7XG53aXRoTWV0YShzdHJvbmdLZXltYXAuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcEN0eDxzdHJvbmc+XCIsXG4gIGdyb3VwOiBcIlN0cm9uZ1wiXG59KTtcbndpdGhNZXRhKHN0cm9uZ0tleW1hcC5zaG9ydGN1dHMsIHtcbiAgZGlzcGxheU5hbWU6IFwiS2V5bWFwPHN0cm9uZz5cIixcbiAgZ3JvdXA6IFwiU3Ryb25nXCJcbn0pO1xuY29uc3QgaW5saW5lQ29kZUF0dHIgPSAkbWFya0F0dHIoXCJpbmxpbmVDb2RlXCIpO1xud2l0aE1ldGEoaW5saW5lQ29kZUF0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxpbmxpbmVDb2RlPlwiLFxuICBncm91cDogXCJJbmxpbmVDb2RlXCJcbn0pO1xuY29uc3QgaW5saW5lQ29kZVNjaGVtYSA9ICRtYXJrU2NoZW1hKFwiaW5saW5lQ29kZVwiLCAoY3R4KSA9PiAoe1xuICBwcmlvcml0eTogMTAwLFxuICBjb2RlOiB0cnVlLFxuICBwYXJzZURPTTogW3sgdGFnOiBcImNvZGVcIiB9XSxcbiAgdG9ET006IChtYXJrKSA9PiBbXCJjb2RlXCIsIGN0eC5nZXQoaW5saW5lQ29kZUF0dHIua2V5KShtYXJrKV0sXG4gIHBhcnNlTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZSA9PT0gXCJpbmxpbmVDb2RlXCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUsIG1hcmtUeXBlKSA9PiB7XG4gICAgICBzdGF0ZS5vcGVuTWFyayhtYXJrVHlwZSk7XG4gICAgICBzdGF0ZS5hZGRUZXh0KG5vZGUudmFsdWUpO1xuICAgICAgc3RhdGUuY2xvc2VNYXJrKG1hcmtUeXBlKTtcbiAgICB9XG4gIH0sXG4gIHRvTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG1hcmspID0+IG1hcmsudHlwZS5uYW1lID09PSBcImlubGluZUNvZGVcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgbWFyaywgbm9kZSkgPT4ge1xuICAgICAgc3RhdGUud2l0aE1hcmsobWFyaywgXCJpbmxpbmVDb2RlXCIsIG5vZGUudGV4dCB8fCBcIlwiKTtcbiAgICB9XG4gIH1cbn0pKTtcbndpdGhNZXRhKGlubGluZUNvZGVTY2hlbWEubWFyaywge1xuICBkaXNwbGF5TmFtZTogXCJNYXJrU2NoZW1hPGlubGluZUNvZGU+XCIsXG4gIGdyb3VwOiBcIklubGluZUNvZGVcIlxufSk7XG53aXRoTWV0YShpbmxpbmVDb2RlU2NoZW1hLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJNYXJrU2NoZW1hQ3R4PGlubGluZUNvZGU+XCIsXG4gIGdyb3VwOiBcIklubGluZUNvZGVcIlxufSk7XG5jb25zdCB0b2dnbGVJbmxpbmVDb2RlQ29tbWFuZCA9ICRjb21tYW5kKFxuICBcIlRvZ2dsZUlubGluZUNvZGVcIixcbiAgKGN0eCkgPT4gKCkgPT4gKHN0YXRlLCBkaXNwYXRjaCkgPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0aW9uLCB0ciB9ID0gc3RhdGU7XG4gICAgaWYgKHNlbGVjdGlvbi5lbXB0eSkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHsgZnJvbSwgdG8gfSA9IHNlbGVjdGlvbjtcbiAgICBjb25zdCBoYXMgPSBzdGF0ZS5kb2MucmFuZ2VIYXNNYXJrKGZyb20sIHRvLCBpbmxpbmVDb2RlU2NoZW1hLnR5cGUoY3R4KSk7XG4gICAgaWYgKGhhcykge1xuICAgICAgZGlzcGF0Y2ggPT0gbnVsbCA/IHZvaWQgMCA6IGRpc3BhdGNoKHRyLnJlbW92ZU1hcmsoZnJvbSwgdG8sIGlubGluZUNvZGVTY2hlbWEudHlwZShjdHgpKSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY29uc3QgcmVzdE1hcmtzTmFtZSA9IE9iamVjdC5rZXlzKHN0YXRlLnNjaGVtYS5tYXJrcykuZmlsdGVyKFxuICAgICAgKHgpID0+IHggIT09IGlubGluZUNvZGVTY2hlbWEudHlwZS5uYW1lXG4gICAgKTtcbiAgICByZXN0TWFya3NOYW1lLm1hcCgobmFtZSkgPT4gc3RhdGUuc2NoZW1hLm1hcmtzW25hbWVdKS5mb3JFYWNoKCh0KSA9PiB7XG4gICAgICB0ci5yZW1vdmVNYXJrKGZyb20sIHRvLCB0KTtcbiAgICB9KTtcbiAgICBkaXNwYXRjaCA9PSBudWxsID8gdm9pZCAwIDogZGlzcGF0Y2godHIuYWRkTWFyayhmcm9tLCB0bywgaW5saW5lQ29kZVNjaGVtYS50eXBlKGN0eCkuY3JlYXRlKCkpKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuKTtcbndpdGhNZXRhKHRvZ2dsZUlubGluZUNvZGVDb21tYW5kLCB7XG4gIGRpc3BsYXlOYW1lOiBcIkNvbW1hbmQ8dG9nZ2xlSW5saW5lQ29kZUNvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIklubGluZUNvZGVcIlxufSk7XG5jb25zdCBpbmxpbmVDb2RlSW5wdXRSdWxlID0gJGlucHV0UnVsZSgoY3R4KSA9PiB7XG4gIHJldHVybiBtYXJrUnVsZSgvKD86YCkoW15gXSspKD86YCkkLywgaW5saW5lQ29kZVNjaGVtYS50eXBlKGN0eCkpO1xufSk7XG53aXRoTWV0YShpbmxpbmVDb2RlSW5wdXRSdWxlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIklucHV0UnVsZTxpbmxpbmVDb2RlSW5wdXRSdWxlPlwiLFxuICBncm91cDogXCJJbmxpbmVDb2RlXCJcbn0pO1xuY29uc3QgaW5saW5lQ29kZUtleW1hcCA9ICR1c2VLZXltYXAoXCJpbmxpbmVDb2RlS2V5bWFwXCIsIHtcbiAgVG9nZ2xlSW5saW5lQ29kZToge1xuICAgIHNob3J0Y3V0czogXCJNb2QtZVwiLFxuICAgIGNvbW1hbmQ6IChjdHgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1hbmRzMiA9IGN0eC5nZXQoY29tbWFuZHNDdHgpO1xuICAgICAgcmV0dXJuICgpID0+IGNvbW1hbmRzMi5jYWxsKHRvZ2dsZUlubGluZUNvZGVDb21tYW5kLmtleSk7XG4gICAgfVxuICB9XG59KTtcbndpdGhNZXRhKGlubGluZUNvZGVLZXltYXAuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcEN0eDxpbmxpbmVDb2RlPlwiLFxuICBncm91cDogXCJJbmxpbmVDb2RlXCJcbn0pO1xud2l0aE1ldGEoaW5saW5lQ29kZUtleW1hcC5zaG9ydGN1dHMsIHtcbiAgZGlzcGxheU5hbWU6IFwiS2V5bWFwPGlubGluZUNvZGU+XCIsXG4gIGdyb3VwOiBcIklubGluZUNvZGVcIlxufSk7XG5jb25zdCBsaW5rQXR0ciA9ICRtYXJrQXR0cihcImxpbmtcIik7XG53aXRoTWV0YShsaW5rQXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGxpbms+XCIsXG4gIGdyb3VwOiBcIkxpbmtcIlxufSk7XG5jb25zdCBsaW5rU2NoZW1hID0gJG1hcmtTY2hlbWEoXCJsaW5rXCIsIChjdHgpID0+ICh7XG4gIGF0dHJzOiB7XG4gICAgaHJlZjogeyB2YWxpZGF0ZTogXCJzdHJpbmdcIiB9LFxuICAgIHRpdGxlOiB7IGRlZmF1bHQ6IG51bGwsIHZhbGlkYXRlOiBcInN0cmluZ3xudWxsXCIgfVxuICB9LFxuICBwYXJzZURPTTogW1xuICAgIHtcbiAgICAgIHRhZzogXCJhW2hyZWZdXCIsXG4gICAgICBnZXRBdHRyczogKGRvbSkgPT4ge1xuICAgICAgICBpZiAoIShkb20gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHRocm93IGV4cGVjdERvbVR5cGVFcnJvcihkb20pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGhyZWY6IGRvbS5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpLFxuICAgICAgICAgIHRpdGxlOiBkb20uZ2V0QXR0cmlidXRlKFwidGl0bGVcIilcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIF0sXG4gIHRvRE9NOiAobWFyaykgPT4gW1wiYVwiLCB7IC4uLmN0eC5nZXQobGlua0F0dHIua2V5KShtYXJrKSwgLi4ubWFyay5hdHRycyB9XSxcbiAgcGFyc2VNYXJrZG93bjoge1xuICAgIG1hdGNoOiAobm9kZSkgPT4gbm9kZS50eXBlID09PSBcImxpbmtcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSwgbWFya1R5cGUpID0+IHtcbiAgICAgIGNvbnN0IHVybCA9IG5vZGUudXJsO1xuICAgICAgY29uc3QgdGl0bGUgPSBub2RlLnRpdGxlO1xuICAgICAgc3RhdGUub3Blbk1hcmsobWFya1R5cGUsIHsgaHJlZjogdXJsLCB0aXRsZSB9KTtcbiAgICAgIHN0YXRlLm5leHQobm9kZS5jaGlsZHJlbik7XG4gICAgICBzdGF0ZS5jbG9zZU1hcmsobWFya1R5cGUpO1xuICAgIH1cbiAgfSxcbiAgdG9NYXJrZG93bjoge1xuICAgIG1hdGNoOiAobWFyaykgPT4gbWFyay50eXBlLm5hbWUgPT09IFwibGlua1wiLFxuICAgIHJ1bm5lcjogKHN0YXRlLCBtYXJrKSA9PiB7XG4gICAgICBzdGF0ZS53aXRoTWFyayhtYXJrLCBcImxpbmtcIiwgdm9pZCAwLCB7XG4gICAgICAgIHRpdGxlOiBtYXJrLmF0dHJzLnRpdGxlLFxuICAgICAgICB1cmw6IG1hcmsuYXR0cnMuaHJlZlxuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSk7XG53aXRoTWV0YShsaW5rU2NoZW1hLm1hcmssIHtcbiAgZGlzcGxheU5hbWU6IFwiTWFya1NjaGVtYTxsaW5rPlwiLFxuICBncm91cDogXCJMaW5rXCJcbn0pO1xuY29uc3QgdG9nZ2xlTGlua0NvbW1hbmQgPSAkY29tbWFuZChcbiAgXCJUb2dnbGVMaW5rXCIsXG4gIChjdHgpID0+IChwYXlsb2FkID0ge30pID0+IHRvZ2dsZU1hcmsobGlua1NjaGVtYS50eXBlKGN0eCksIHBheWxvYWQpXG4pO1xud2l0aE1ldGEodG9nZ2xlTGlua0NvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDx0b2dnbGVMaW5rQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiTGlua1wiXG59KTtcbmNvbnN0IHVwZGF0ZUxpbmtDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiVXBkYXRlTGlua1wiLFxuICAoY3R4KSA9PiAocGF5bG9hZCA9IHt9KSA9PiAoc3RhdGUsIGRpc3BhdGNoKSA9PiB7XG4gICAgaWYgKCFkaXNwYXRjaCkgcmV0dXJuIGZhbHNlO1xuICAgIGxldCBub2RlO1xuICAgIGxldCBwb3MgPSAtMTtcbiAgICBjb25zdCB7IHNlbGVjdGlvbiB9ID0gc3RhdGU7XG4gICAgY29uc3QgeyBmcm9tLCB0byB9ID0gc2VsZWN0aW9uO1xuICAgIHN0YXRlLmRvYy5ub2Rlc0JldHdlZW4oZnJvbSwgZnJvbSA9PT0gdG8gPyB0byArIDEgOiB0bywgKG4sIHApID0+IHtcbiAgICAgIGlmIChsaW5rU2NoZW1hLnR5cGUoY3R4KS5pc0luU2V0KG4ubWFya3MpKSB7XG4gICAgICAgIG5vZGUgPSBuO1xuICAgICAgICBwb3MgPSBwO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH0pO1xuICAgIGlmICghbm9kZSkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IG1hcmsgPSBub2RlLm1hcmtzLmZpbmQoKHsgdHlwZSB9KSA9PiB0eXBlID09PSBsaW5rU2NoZW1hLnR5cGUoY3R4KSk7XG4gICAgaWYgKCFtYXJrKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3Qgc3RhcnQgPSBwb3M7XG4gICAgY29uc3QgZW5kID0gcG9zICsgbm9kZS5ub2RlU2l6ZTtcbiAgICBjb25zdCB7IHRyIH0gPSBzdGF0ZTtcbiAgICBjb25zdCBsaW5rTWFyayA9IGxpbmtTY2hlbWEudHlwZShjdHgpLmNyZWF0ZSh7IC4uLm1hcmsuYXR0cnMsIC4uLnBheWxvYWQgfSk7XG4gICAgaWYgKCFsaW5rTWFyaykgcmV0dXJuIGZhbHNlO1xuICAgIGRpc3BhdGNoKFxuICAgICAgdHIucmVtb3ZlTWFyayhzdGFydCwgZW5kLCBtYXJrKS5hZGRNYXJrKHN0YXJ0LCBlbmQsIGxpbmtNYXJrKS5zZXRTZWxlY3Rpb24obmV3IFRleHRTZWxlY3Rpb24odHIuc2VsZWN0aW9uLiRhbmNob3IpKS5zY3JvbGxJbnRvVmlldygpXG4gICAgKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuKTtcbndpdGhNZXRhKHVwZGF0ZUxpbmtDb21tYW5kLCB7XG4gIGRpc3BsYXlOYW1lOiBcIkNvbW1hbmQ8dXBkYXRlTGlua0NvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIkxpbmtcIlxufSk7XG5jb25zdCBkb2NTY2hlbWEgPSAkbm9kZShcImRvY1wiLCAoKSA9PiAoe1xuICBjb250ZW50OiBcImJsb2NrK1wiLFxuICBwYXJzZU1hcmtkb3duOiB7XG4gICAgbWF0Y2g6ICh7IHR5cGUgfSkgPT4gdHlwZSA9PT0gXCJyb290XCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUsIHR5cGUpID0+IHtcbiAgICAgIHN0YXRlLmluamVjdFJvb3Qobm9kZSwgdHlwZSk7XG4gICAgfVxuICB9LFxuICB0b01hcmtkb3duOiB7XG4gICAgbWF0Y2g6IChub2RlKSA9PiBub2RlLnR5cGUubmFtZSA9PT0gXCJkb2NcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSkgPT4ge1xuICAgICAgc3RhdGUub3Blbk5vZGUoXCJyb290XCIpO1xuICAgICAgc3RhdGUubmV4dChub2RlLmNvbnRlbnQpO1xuICAgIH1cbiAgfVxufSkpO1xud2l0aE1ldGEoZG9jU2NoZW1hLCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWE8ZG9jPlwiLFxuICBncm91cDogXCJEb2NcIlxufSk7XG5mdW5jdGlvbiB2aXNpdEVtcHR5TGluZShhc3QpIHtcbiAgcmV0dXJuIHZpc2l0UGFyZW50cyhcbiAgICBhc3QsXG4gICAgKG5vZGUpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIHJldHVybiBub2RlLnR5cGUgPT09IFwiaHRtbFwiICYmIFtcIjxiciAvPlwiLCBcIjxicj5cIiwgXCI8YnIgPlwiLCBcIjxici8+XCJdLmluY2x1ZGVzKFxuICAgICAgICAoX2EgPSBub2RlLnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2EudHJpbSgpXG4gICAgICApO1xuICAgIH0sXG4gICAgKG5vZGUsIHBhcmVudHMpID0+IHtcbiAgICAgIGlmICghcGFyZW50cy5sZW5ndGgpIHJldHVybjtcbiAgICAgIGNvbnN0IHBhcmVudCA9IHBhcmVudHNbcGFyZW50cy5sZW5ndGggLSAxXTtcbiAgICAgIGlmICghcGFyZW50KSByZXR1cm47XG4gICAgICBjb25zdCBpbmRleCA9IHBhcmVudC5jaGlsZHJlbi5pbmRleE9mKG5vZGUpO1xuICAgICAgaWYgKGluZGV4ID09PSAtMSkgcmV0dXJuO1xuICAgICAgcGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgfSxcbiAgICB0cnVlXG4gICk7XG59XG5jb25zdCByZW1hcmtQcmVzZXJ2ZUVtcHR5TGluZVBsdWdpbiA9ICRyZW1hcmsoXG4gIFwicmVtYXJrLXByZXNlcnZlLWVtcHR5LWxpbmVcIixcbiAgKCkgPT4gKCkgPT4gdmlzaXRFbXB0eUxpbmVcbik7XG53aXRoTWV0YShyZW1hcmtQcmVzZXJ2ZUVtcHR5TGluZVBsdWdpbi5wbHVnaW4sIHtcbiAgZGlzcGxheU5hbWU6IFwiUmVtYXJrPHJlbWFya1ByZXNlcnZlRW1wdHlMaW5lPlwiLFxuICBncm91cDogXCJSZW1hcmtcIlxufSk7XG53aXRoTWV0YShyZW1hcmtQcmVzZXJ2ZUVtcHR5TGluZVBsdWdpbi5vcHRpb25zLCB7XG4gIGRpc3BsYXlOYW1lOiBcIlJlbWFya0NvbmZpZzxyZW1hcmtQcmVzZXJ2ZUVtcHR5TGluZT5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xuY29uc3QgcGFyYWdyYXBoQXR0ciA9ICRub2RlQXR0cihcInBhcmFncmFwaFwiKTtcbndpdGhNZXRhKHBhcmFncmFwaEF0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxwYXJhZ3JhcGg+XCIsXG4gIGdyb3VwOiBcIlBhcmFncmFwaFwiXG59KTtcbmNvbnN0IHBhcmFncmFwaFNjaGVtYSA9ICRub2RlU2NoZW1hKFwicGFyYWdyYXBoXCIsIChjdHgpID0+ICh7XG4gIGNvbnRlbnQ6IFwiaW5saW5lKlwiLFxuICBncm91cDogXCJibG9ja1wiLFxuICBwYXJzZURPTTogW3sgdGFnOiBcInBcIiB9XSxcbiAgdG9ET006IChub2RlKSA9PiBbXCJwXCIsIGN0eC5nZXQocGFyYWdyYXBoQXR0ci5rZXkpKG5vZGUpLCAwXSxcbiAgcGFyc2VNYXJrZG93bjoge1xuICAgIG1hdGNoOiAobm9kZSkgPT4gbm9kZS50eXBlID09PSBcInBhcmFncmFwaFwiLFxuICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlLCB0eXBlKSA9PiB7XG4gICAgICBzdGF0ZS5vcGVuTm9kZSh0eXBlKTtcbiAgICAgIGlmIChub2RlLmNoaWxkcmVuKSBzdGF0ZS5uZXh0KG5vZGUuY2hpbGRyZW4pO1xuICAgICAgZWxzZSBzdGF0ZS5hZGRUZXh0KG5vZGUudmFsdWUgfHwgXCJcIik7XG4gICAgICBzdGF0ZS5jbG9zZU5vZGUoKTtcbiAgICB9XG4gIH0sXG4gIHRvTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZS5uYW1lID09PSBcInBhcmFncmFwaFwiLFxuICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICBjb25zdCB2aWV3ID0gY3R4LmdldChlZGl0b3JWaWV3Q3R4KTtcbiAgICAgIGNvbnN0IGxhc3ROb2RlID0gKF9hID0gdmlldy5zdGF0ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmRvYy5sYXN0Q2hpbGQ7XG4gICAgICBzdGF0ZS5vcGVuTm9kZShcInBhcmFncmFwaFwiKTtcbiAgICAgIGlmICgoIW5vZGUuY29udGVudCB8fCBub2RlLmNvbnRlbnQuc2l6ZSA9PT0gMCkgJiYgbm9kZSAhPT0gbGFzdE5vZGUgJiYgc2hvdWxkUHJlc2VydmVFbXB0eUxpbmUoY3R4KSkge1xuICAgICAgICBzdGF0ZS5hZGROb2RlKFwiaHRtbFwiLCB2b2lkIDAsIFwiPGJyIC8+XCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VyaWFsaXplVGV4dChzdGF0ZSwgbm9kZSk7XG4gICAgICB9XG4gICAgICBzdGF0ZS5jbG9zZU5vZGUoKTtcbiAgICB9XG4gIH1cbn0pKTtcbmZ1bmN0aW9uIHNob3VsZFByZXNlcnZlRW1wdHlMaW5lKGN0eCkge1xuICBsZXQgc2hvdWxkUHJlc2VydmVFbXB0eUxpbmUyID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgY3R4LmdldChyZW1hcmtQcmVzZXJ2ZUVtcHR5TGluZVBsdWdpbi5pZCk7XG4gICAgc2hvdWxkUHJlc2VydmVFbXB0eUxpbmUyID0gdHJ1ZTtcbiAgfSBjYXRjaCB7XG4gICAgc2hvdWxkUHJlc2VydmVFbXB0eUxpbmUyID0gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHNob3VsZFByZXNlcnZlRW1wdHlMaW5lMjtcbn1cbndpdGhNZXRhKHBhcmFncmFwaFNjaGVtYS5ub2RlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWE8cGFyYWdyYXBoPlwiLFxuICBncm91cDogXCJQYXJhZ3JhcGhcIlxufSk7XG53aXRoTWV0YShwYXJhZ3JhcGhTY2hlbWEuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWFDdHg8cGFyYWdyYXBoPlwiLFxuICBncm91cDogXCJQYXJhZ3JhcGhcIlxufSk7XG5jb25zdCB0dXJuSW50b1RleHRDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiVHVybkludG9UZXh0XCIsXG4gIChjdHgpID0+ICgpID0+IHNldEJsb2NrVHlwZShwYXJhZ3JhcGhTY2hlbWEudHlwZShjdHgpKVxuKTtcbndpdGhNZXRhKHR1cm5JbnRvVGV4dENvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDx0dXJuSW50b1RleHRDb21tYW5kPlwiLFxuICBncm91cDogXCJQYXJhZ3JhcGhcIlxufSk7XG5jb25zdCBwYXJhZ3JhcGhLZXltYXAgPSAkdXNlS2V5bWFwKFwicGFyYWdyYXBoS2V5bWFwXCIsIHtcbiAgVHVybkludG9UZXh0OiB7XG4gICAgc2hvcnRjdXRzOiBcIk1vZC1BbHQtMFwiLFxuICAgIGNvbW1hbmQ6IChjdHgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1hbmRzMiA9IGN0eC5nZXQoY29tbWFuZHNDdHgpO1xuICAgICAgcmV0dXJuICgpID0+IGNvbW1hbmRzMi5jYWxsKHR1cm5JbnRvVGV4dENvbW1hbmQua2V5KTtcbiAgICB9XG4gIH1cbn0pO1xud2l0aE1ldGEocGFyYWdyYXBoS2V5bWFwLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXBDdHg8cGFyYWdyYXBoPlwiLFxuICBncm91cDogXCJQYXJhZ3JhcGhcIlxufSk7XG53aXRoTWV0YShwYXJhZ3JhcGhLZXltYXAuc2hvcnRjdXRzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcDxwYXJhZ3JhcGg+XCIsXG4gIGdyb3VwOiBcIlBhcmFncmFwaFwiXG59KTtcbmNvbnN0IGhlYWRpbmdJbmRleCA9IEFycmF5KDYpLmZpbGwoMCkubWFwKChfLCBpKSA9PiBpICsgMSk7XG5mdW5jdGlvbiBkZWZhdWx0SGVhZGluZ0lkR2VuZXJhdG9yKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKS50cmltKCkucmVwbGFjZSgvW15cXHdcXHMtXS9nLCBcIlwiKS5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKTtcbn1cbmNvbnN0IGhlYWRpbmdJZEdlbmVyYXRvciA9ICRjdHgoXG4gIGRlZmF1bHRIZWFkaW5nSWRHZW5lcmF0b3IsXG4gIFwiaGVhZGluZ0lkR2VuZXJhdG9yXCJcbik7XG53aXRoTWV0YShoZWFkaW5nSWRHZW5lcmF0b3IsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ3R4PEhlYWRpbmdJZEdlbmVyYXRvcj5cIixcbiAgZ3JvdXA6IFwiSGVhZGluZ1wiXG59KTtcbmNvbnN0IGhlYWRpbmdBdHRyID0gJG5vZGVBdHRyKFwiaGVhZGluZ1wiKTtcbndpdGhNZXRhKGhlYWRpbmdBdHRyLCB7XG4gIGRpc3BsYXlOYW1lOiBcIkF0dHI8aGVhZGluZz5cIixcbiAgZ3JvdXA6IFwiSGVhZGluZ1wiXG59KTtcbmNvbnN0IGhlYWRpbmdTY2hlbWEgPSAkbm9kZVNjaGVtYShcImhlYWRpbmdcIiwgKGN0eCkgPT4ge1xuICBjb25zdCBnZXRJZCA9IGN0eC5nZXQoaGVhZGluZ0lkR2VuZXJhdG9yLmtleSk7XG4gIHJldHVybiB7XG4gICAgY29udGVudDogXCJpbmxpbmUqXCIsXG4gICAgZ3JvdXA6IFwiYmxvY2tcIixcbiAgICBkZWZpbmluZzogdHJ1ZSxcbiAgICBhdHRyczoge1xuICAgICAgaWQ6IHtcbiAgICAgICAgZGVmYXVsdDogXCJcIixcbiAgICAgICAgdmFsaWRhdGU6IFwic3RyaW5nXCJcbiAgICAgIH0sXG4gICAgICBsZXZlbDoge1xuICAgICAgICBkZWZhdWx0OiAxLFxuICAgICAgICB2YWxpZGF0ZTogXCJudW1iZXJcIlxuICAgICAgfVxuICAgIH0sXG4gICAgcGFyc2VET006IGhlYWRpbmdJbmRleC5tYXAoKHgpID0+ICh7XG4gICAgICB0YWc6IGBoJHt4fWAsXG4gICAgICBnZXRBdHRyczogKG5vZGUpID0+IHtcbiAgICAgICAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgdGhyb3cgZXhwZWN0RG9tVHlwZUVycm9yKG5vZGUpO1xuICAgICAgICByZXR1cm4geyBsZXZlbDogeCwgaWQ6IG5vZGUuaWQgfTtcbiAgICAgIH1cbiAgICB9KSksXG4gICAgdG9ET006IChub2RlKSA9PiB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBgaCR7bm9kZS5hdHRycy5sZXZlbH1gLFxuICAgICAgICB7XG4gICAgICAgICAgLi4uY3R4LmdldChoZWFkaW5nQXR0ci5rZXkpKG5vZGUpLFxuICAgICAgICAgIGlkOiBub2RlLmF0dHJzLmlkIHx8IGdldElkKG5vZGUpXG4gICAgICAgIH0sXG4gICAgICAgIDBcbiAgICAgIF07XG4gICAgfSxcbiAgICBwYXJzZU1hcmtkb3duOiB7XG4gICAgICBtYXRjaDogKHsgdHlwZSB9KSA9PiB0eXBlID09PSBcImhlYWRpbmdcIixcbiAgICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlLCB0eXBlKSA9PiB7XG4gICAgICAgIGNvbnN0IGRlcHRoID0gbm9kZS5kZXB0aDtcbiAgICAgICAgc3RhdGUub3Blbk5vZGUodHlwZSwgeyBsZXZlbDogZGVwdGggfSk7XG4gICAgICAgIHN0YXRlLm5leHQobm9kZS5jaGlsZHJlbik7XG4gICAgICAgIHN0YXRlLmNsb3NlTm9kZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdG9NYXJrZG93bjoge1xuICAgICAgbWF0Y2g6IChub2RlKSA9PiBub2RlLnR5cGUubmFtZSA9PT0gXCJoZWFkaW5nXCIsXG4gICAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSkgPT4ge1xuICAgICAgICBzdGF0ZS5vcGVuTm9kZShcImhlYWRpbmdcIiwgdm9pZCAwLCB7IGRlcHRoOiBub2RlLmF0dHJzLmxldmVsIH0pO1xuICAgICAgICBzZXJpYWxpemVUZXh0KHN0YXRlLCBub2RlKTtcbiAgICAgICAgc3RhdGUuY2xvc2VOb2RlKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufSk7XG53aXRoTWV0YShoZWFkaW5nU2NoZW1hLm5vZGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYTxoZWFkaW5nPlwiLFxuICBncm91cDogXCJIZWFkaW5nXCJcbn0pO1xud2l0aE1ldGEoaGVhZGluZ1NjaGVtYS5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYUN0eDxoZWFkaW5nPlwiLFxuICBncm91cDogXCJIZWFkaW5nXCJcbn0pO1xuY29uc3Qgd3JhcEluSGVhZGluZ0lucHV0UnVsZSA9ICRpbnB1dFJ1bGUoKGN0eCkgPT4ge1xuICByZXR1cm4gdGV4dGJsb2NrVHlwZUlucHV0UnVsZShcbiAgICAvXig/PGhhc2hlcz4jKylcXHMkLyxcbiAgICBoZWFkaW5nU2NoZW1hLnR5cGUoY3R4KSxcbiAgICAobWF0Y2gpID0+IHtcbiAgICAgIHZhciBfYSwgX2I7XG4gICAgICBjb25zdCB4ID0gKChfYiA9IChfYSA9IG1hdGNoLmdyb3VwcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmhhc2hlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLmxlbmd0aCkgfHwgMDtcbiAgICAgIGNvbnN0IHZpZXcgPSBjdHguZ2V0KGVkaXRvclZpZXdDdHgpO1xuICAgICAgY29uc3QgeyAkZnJvbSB9ID0gdmlldy5zdGF0ZS5zZWxlY3Rpb247XG4gICAgICBjb25zdCBub2RlID0gJGZyb20ubm9kZSgpO1xuICAgICAgaWYgKG5vZGUudHlwZS5uYW1lID09PSBcImhlYWRpbmdcIikge1xuICAgICAgICBsZXQgbGV2ZWwgPSBOdW1iZXIobm9kZS5hdHRycy5sZXZlbCkgKyBOdW1iZXIoeCk7XG4gICAgICAgIGlmIChsZXZlbCA+IDYpIGxldmVsID0gNjtcbiAgICAgICAgcmV0dXJuIHsgbGV2ZWwgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7IGxldmVsOiB4IH07XG4gICAgfVxuICApO1xufSk7XG53aXRoTWV0YSh3cmFwSW5IZWFkaW5nSW5wdXRSdWxlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIklucHV0UnVsZTx3cmFwSW5IZWFkaW5nSW5wdXRSdWxlPlwiLFxuICBncm91cDogXCJIZWFkaW5nXCJcbn0pO1xuY29uc3Qgd3JhcEluSGVhZGluZ0NvbW1hbmQgPSAkY29tbWFuZChcIldyYXBJbkhlYWRpbmdcIiwgKGN0eCkgPT4ge1xuICByZXR1cm4gKGxldmVsKSA9PiB7XG4gICAgbGV2ZWwgPz8gKGxldmVsID0gMSk7XG4gICAgaWYgKGxldmVsIDwgMSkgcmV0dXJuIHNldEJsb2NrVHlwZShwYXJhZ3JhcGhTY2hlbWEudHlwZShjdHgpKTtcbiAgICByZXR1cm4gc2V0QmxvY2tUeXBlKGhlYWRpbmdTY2hlbWEudHlwZShjdHgpLCB7IGxldmVsIH0pO1xuICB9O1xufSk7XG53aXRoTWV0YSh3cmFwSW5IZWFkaW5nQ29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPHdyYXBJbkhlYWRpbmdDb21tYW5kPlwiLFxuICBncm91cDogXCJIZWFkaW5nXCJcbn0pO1xuY29uc3QgZG93bmdyYWRlSGVhZGluZ0NvbW1hbmQgPSAkY29tbWFuZChcbiAgXCJEb3duZ3JhZGVIZWFkaW5nXCIsXG4gIChjdHgpID0+ICgpID0+IChzdGF0ZSwgZGlzcGF0Y2gsIHZpZXcpID0+IHtcbiAgICBjb25zdCB7ICRmcm9tIH0gPSBzdGF0ZS5zZWxlY3Rpb247XG4gICAgY29uc3Qgbm9kZSA9ICRmcm9tLm5vZGUoKTtcbiAgICBpZiAobm9kZS50eXBlICE9PSBoZWFkaW5nU2NoZW1hLnR5cGUoY3R4KSB8fCAhc3RhdGUuc2VsZWN0aW9uLmVtcHR5IHx8ICRmcm9tLnBhcmVudE9mZnNldCAhPT0gMClcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBsZXZlbCA9IG5vZGUuYXR0cnMubGV2ZWwgLSAxO1xuICAgIGlmICghbGV2ZWwpXG4gICAgICByZXR1cm4gc2V0QmxvY2tUeXBlKHBhcmFncmFwaFNjaGVtYS50eXBlKGN0eCkpKHN0YXRlLCBkaXNwYXRjaCwgdmlldyk7XG4gICAgZGlzcGF0Y2ggPT0gbnVsbCA/IHZvaWQgMCA6IGRpc3BhdGNoKFxuICAgICAgc3RhdGUudHIuc2V0Tm9kZU1hcmt1cChzdGF0ZS5zZWxlY3Rpb24uJGZyb20uYmVmb3JlKCksIHZvaWQgMCwge1xuICAgICAgICAuLi5ub2RlLmF0dHJzLFxuICAgICAgICBsZXZlbFxuICAgICAgfSlcbiAgICApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4pO1xud2l0aE1ldGEoZG93bmdyYWRlSGVhZGluZ0NvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDxkb3duZ3JhZGVIZWFkaW5nQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiSGVhZGluZ1wiXG59KTtcbmNvbnN0IGhlYWRpbmdLZXltYXAgPSAkdXNlS2V5bWFwKFwiaGVhZGluZ0tleW1hcFwiLCB7XG4gIFR1cm5JbnRvSDE6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC0xXCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluSGVhZGluZ0NvbW1hbmQua2V5LCAxKTtcbiAgICB9XG4gIH0sXG4gIFR1cm5JbnRvSDI6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC0yXCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluSGVhZGluZ0NvbW1hbmQua2V5LCAyKTtcbiAgICB9XG4gIH0sXG4gIFR1cm5JbnRvSDM6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC0zXCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluSGVhZGluZ0NvbW1hbmQua2V5LCAzKTtcbiAgICB9XG4gIH0sXG4gIFR1cm5JbnRvSDQ6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC00XCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluSGVhZGluZ0NvbW1hbmQua2V5LCA0KTtcbiAgICB9XG4gIH0sXG4gIFR1cm5JbnRvSDU6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC01XCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluSGVhZGluZ0NvbW1hbmQua2V5LCA1KTtcbiAgICB9XG4gIH0sXG4gIFR1cm5JbnRvSDY6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC02XCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluSGVhZGluZ0NvbW1hbmQua2V5LCA2KTtcbiAgICB9XG4gIH0sXG4gIERvd25ncmFkZUhlYWRpbmc6IHtcbiAgICBzaG9ydGN1dHM6IFtcIkRlbGV0ZVwiLCBcIkJhY2tzcGFjZVwiXSxcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbChkb3duZ3JhZGVIZWFkaW5nQ29tbWFuZC5rZXkpO1xuICAgIH1cbiAgfVxufSk7XG53aXRoTWV0YShoZWFkaW5nS2V5bWFwLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXBDdHg8aGVhZGluZz5cIixcbiAgZ3JvdXA6IFwiSGVhZGluZ1wiXG59KTtcbndpdGhNZXRhKGhlYWRpbmdLZXltYXAuc2hvcnRjdXRzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcDxoZWFkaW5nPlwiLFxuICBncm91cDogXCJIZWFkaW5nXCJcbn0pO1xuY29uc3QgYmxvY2txdW90ZUF0dHIgPSAkbm9kZUF0dHIoXCJibG9ja3F1b3RlXCIpO1xud2l0aE1ldGEoYmxvY2txdW90ZUF0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxibG9ja3F1b3RlPlwiLFxuICBncm91cDogXCJCbG9ja3F1b3RlXCJcbn0pO1xuY29uc3QgYmxvY2txdW90ZVNjaGVtYSA9ICRub2RlU2NoZW1hKFxuICBcImJsb2NrcXVvdGVcIixcbiAgKGN0eCkgPT4gKHtcbiAgICBjb250ZW50OiBcImJsb2NrK1wiLFxuICAgIGdyb3VwOiBcImJsb2NrXCIsXG4gICAgZGVmaW5pbmc6IHRydWUsXG4gICAgcGFyc2VET006IFt7IHRhZzogXCJibG9ja3F1b3RlXCIgfV0sXG4gICAgdG9ET006IChub2RlKSA9PiBbXCJibG9ja3F1b3RlXCIsIGN0eC5nZXQoYmxvY2txdW90ZUF0dHIua2V5KShub2RlKSwgMF0sXG4gICAgcGFyc2VNYXJrZG93bjoge1xuICAgICAgbWF0Y2g6ICh7IHR5cGUgfSkgPT4gdHlwZSA9PT0gXCJibG9ja3F1b3RlXCIsXG4gICAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSwgdHlwZSkgPT4ge1xuICAgICAgICBzdGF0ZS5vcGVuTm9kZSh0eXBlKS5uZXh0KG5vZGUuY2hpbGRyZW4pLmNsb3NlTm9kZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdG9NYXJrZG93bjoge1xuICAgICAgbWF0Y2g6IChub2RlKSA9PiBub2RlLnR5cGUubmFtZSA9PT0gXCJibG9ja3F1b3RlXCIsXG4gICAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSkgPT4ge1xuICAgICAgICBzdGF0ZS5vcGVuTm9kZShcImJsb2NrcXVvdGVcIikubmV4dChub2RlLmNvbnRlbnQpLmNsb3NlTm9kZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSlcbik7XG53aXRoTWV0YShibG9ja3F1b3RlU2NoZW1hLm5vZGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYTxibG9ja3F1b3RlPlwiLFxuICBncm91cDogXCJCbG9ja3F1b3RlXCJcbn0pO1xud2l0aE1ldGEoYmxvY2txdW90ZVNjaGVtYS5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYUN0eDxibG9ja3F1b3RlPlwiLFxuICBncm91cDogXCJCbG9ja3F1b3RlXCJcbn0pO1xuY29uc3Qgd3JhcEluQmxvY2txdW90ZUlucHV0UnVsZSA9ICRpbnB1dFJ1bGUoXG4gIChjdHgpID0+IHdyYXBwaW5nSW5wdXRSdWxlKC9eXFxzKj5cXHMkLywgYmxvY2txdW90ZVNjaGVtYS50eXBlKGN0eCkpXG4pO1xud2l0aE1ldGEod3JhcEluQmxvY2txdW90ZUlucHV0UnVsZSwge1xuICBkaXNwbGF5TmFtZTogXCJJbnB1dFJ1bGU8d3JhcEluQmxvY2txdW90ZUlucHV0UnVsZT5cIixcbiAgZ3JvdXA6IFwiQmxvY2txdW90ZVwiXG59KTtcbmNvbnN0IHdyYXBJbkJsb2NrcXVvdGVDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiV3JhcEluQmxvY2txdW90ZVwiLFxuICAoY3R4KSA9PiAoKSA9PiB3cmFwSW4oYmxvY2txdW90ZVNjaGVtYS50eXBlKGN0eCkpXG4pO1xud2l0aE1ldGEod3JhcEluQmxvY2txdW90ZUNvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDx3cmFwSW5CbG9ja3F1b3RlQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiQmxvY2txdW90ZVwiXG59KTtcbmNvbnN0IGJsb2NrcXVvdGVLZXltYXAgPSAkdXNlS2V5bWFwKFwiYmxvY2txdW90ZUtleW1hcFwiLCB7XG4gIFdyYXBJbkJsb2NrcXVvdGU6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLVNoaWZ0LWJcIixcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbCh3cmFwSW5CbG9ja3F1b3RlQ29tbWFuZC5rZXkpO1xuICAgIH1cbiAgfVxufSk7XG53aXRoTWV0YShibG9ja3F1b3RlS2V5bWFwLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXBDdHg8YmxvY2txdW90ZT5cIixcbiAgZ3JvdXA6IFwiQmxvY2txdW90ZVwiXG59KTtcbndpdGhNZXRhKGJsb2NrcXVvdGVLZXltYXAuc2hvcnRjdXRzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcDxibG9ja3F1b3RlPlwiLFxuICBncm91cDogXCJCbG9ja3F1b3RlXCJcbn0pO1xuY29uc3QgY29kZUJsb2NrQXR0ciA9ICRub2RlQXR0cihcImNvZGVCbG9ja1wiLCAoKSA9PiAoe1xuICBwcmU6IHt9LFxuICBjb2RlOiB7fVxufSkpO1xud2l0aE1ldGEoY29kZUJsb2NrQXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGNvZGVCbG9jaz5cIixcbiAgZ3JvdXA6IFwiQ29kZUJsb2NrXCJcbn0pO1xuY29uc3QgY29kZUJsb2NrU2NoZW1hID0gJG5vZGVTY2hlbWEoXCJjb2RlX2Jsb2NrXCIsIChjdHgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBjb250ZW50OiBcInRleHQqXCIsXG4gICAgZ3JvdXA6IFwiYmxvY2tcIixcbiAgICBtYXJrczogXCJcIixcbiAgICBkZWZpbmluZzogdHJ1ZSxcbiAgICBjb2RlOiB0cnVlLFxuICAgIGF0dHJzOiB7XG4gICAgICBsYW5ndWFnZToge1xuICAgICAgICBkZWZhdWx0OiBcIlwiLFxuICAgICAgICB2YWxpZGF0ZTogXCJzdHJpbmdcIlxuICAgICAgfVxuICAgIH0sXG4gICAgcGFyc2VET006IFtcbiAgICAgIHtcbiAgICAgICAgdGFnOiBcInByZVwiLFxuICAgICAgICBwcmVzZXJ2ZVdoaXRlc3BhY2U6IFwiZnVsbFwiLFxuICAgICAgICBnZXRBdHRyczogKGRvbSkgPT4ge1xuICAgICAgICAgIGlmICghKGRvbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgdGhyb3cgZXhwZWN0RG9tVHlwZUVycm9yKGRvbSk7XG4gICAgICAgICAgcmV0dXJuIHsgbGFuZ3VhZ2U6IGRvbS5kYXRhc2V0Lmxhbmd1YWdlIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdLFxuICAgIHRvRE9NOiAobm9kZSkgPT4ge1xuICAgICAgY29uc3QgYXR0ciA9IGN0eC5nZXQoY29kZUJsb2NrQXR0ci5rZXkpKG5vZGUpO1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgXCJwcmVcIixcbiAgICAgICAge1xuICAgICAgICAgIC4uLmF0dHIucHJlLFxuICAgICAgICAgIFwiZGF0YS1sYW5ndWFnZVwiOiBub2RlLmF0dHJzLmxhbmd1YWdlXG4gICAgICAgIH0sXG4gICAgICAgIFtcImNvZGVcIiwgYXR0ci5jb2RlLCAwXVxuICAgICAgXTtcbiAgICB9LFxuICAgIHBhcnNlTWFya2Rvd246IHtcbiAgICAgIG1hdGNoOiAoeyB0eXBlIH0pID0+IHR5cGUgPT09IFwiY29kZVwiLFxuICAgICAgcnVubmVyOiAoc3RhdGUsIG5vZGUsIHR5cGUpID0+IHtcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2UgPSBub2RlLmxhbmc7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gbm9kZS52YWx1ZTtcbiAgICAgICAgc3RhdGUub3Blbk5vZGUodHlwZSwgeyBsYW5ndWFnZSB9KTtcbiAgICAgICAgaWYgKHZhbHVlKSBzdGF0ZS5hZGRUZXh0KHZhbHVlKTtcbiAgICAgICAgc3RhdGUuY2xvc2VOb2RlKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICB0b01hcmtkb3duOiB7XG4gICAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZS5uYW1lID09PSBcImNvZGVfYmxvY2tcIixcbiAgICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgc3RhdGUuYWRkTm9kZShcImNvZGVcIiwgdm9pZCAwLCAoKF9hID0gbm9kZS5jb250ZW50LmZpcnN0Q2hpbGQpID09IG51bGwgPyB2b2lkIDAgOiBfYS50ZXh0KSB8fCBcIlwiLCB7XG4gICAgICAgICAgbGFuZzogbm9kZS5hdHRycy5sYW5ndWFnZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59KTtcbndpdGhNZXRhKGNvZGVCbG9ja1NjaGVtYS5ub2RlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWE8Y29kZUJsb2NrPlwiLFxuICBncm91cDogXCJDb2RlQmxvY2tcIlxufSk7XG53aXRoTWV0YShjb2RlQmxvY2tTY2hlbWEuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWFDdHg8Y29kZUJsb2NrPlwiLFxuICBncm91cDogXCJDb2RlQmxvY2tcIlxufSk7XG5jb25zdCBjcmVhdGVDb2RlQmxvY2tJbnB1dFJ1bGUgPSAkaW5wdXRSdWxlKFxuICAoY3R4KSA9PiB0ZXh0YmxvY2tUeXBlSW5wdXRSdWxlKFxuICAgIC9eYGBgKD88bGFuZ3VhZ2U+W2Etel0qKT9bXFxzXFxuXSQvLFxuICAgIGNvZGVCbG9ja1NjaGVtYS50eXBlKGN0eCksXG4gICAgKG1hdGNoKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBsYW5ndWFnZTogKChfYSA9IG1hdGNoLmdyb3VwcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmxhbmd1YWdlKSA/PyBcIlwiXG4gICAgICB9O1xuICAgIH1cbiAgKVxuKTtcbndpdGhNZXRhKGNyZWF0ZUNvZGVCbG9ja0lucHV0UnVsZSwge1xuICBkaXNwbGF5TmFtZTogXCJJbnB1dFJ1bGU8Y3JlYXRlQ29kZUJsb2NrSW5wdXRSdWxlPlwiLFxuICBncm91cDogXCJDb2RlQmxvY2tcIlxufSk7XG5jb25zdCBjcmVhdGVDb2RlQmxvY2tDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiQ3JlYXRlQ29kZUJsb2NrXCIsXG4gIChjdHgpID0+IChsYW5ndWFnZSA9IFwiXCIpID0+IHNldEJsb2NrVHlwZShjb2RlQmxvY2tTY2hlbWEudHlwZShjdHgpLCB7IGxhbmd1YWdlIH0pXG4pO1xud2l0aE1ldGEoY3JlYXRlQ29kZUJsb2NrQ29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPGNyZWF0ZUNvZGVCbG9ja0NvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIkNvZGVCbG9ja1wiXG59KTtcbmNvbnN0IHVwZGF0ZUNvZGVCbG9ja0xhbmd1YWdlQ29tbWFuZCA9ICRjb21tYW5kKFxuICBcIlVwZGF0ZUNvZGVCbG9ja0xhbmd1YWdlXCIsXG4gICgpID0+ICh7IHBvcywgbGFuZ3VhZ2UgfSA9IHtcbiAgICBwb3M6IC0xLFxuICAgIGxhbmd1YWdlOiBcIlwiXG4gIH0pID0+IChzdGF0ZSwgZGlzcGF0Y2gpID0+IHtcbiAgICBpZiAocG9zID49IDApIHtcbiAgICAgIGRpc3BhdGNoID09IG51bGwgPyB2b2lkIDAgOiBkaXNwYXRjaChzdGF0ZS50ci5zZXROb2RlQXR0cmlidXRlKHBvcywgXCJsYW5ndWFnZVwiLCBsYW5ndWFnZSkpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuKTtcbndpdGhNZXRhKHVwZGF0ZUNvZGVCbG9ja0xhbmd1YWdlQ29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPHVwZGF0ZUNvZGVCbG9ja0xhbmd1YWdlQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiQ29kZUJsb2NrXCJcbn0pO1xuY29uc3QgY29kZUJsb2NrS2V5bWFwID0gJHVzZUtleW1hcChcImNvZGVCbG9ja0tleW1hcFwiLCB7XG4gIENyZWF0ZUNvZGVCbG9jazoge1xuICAgIHNob3J0Y3V0czogXCJNb2QtQWx0LWNcIixcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbChjcmVhdGVDb2RlQmxvY2tDb21tYW5kLmtleSk7XG4gICAgfVxuICB9XG59KTtcbndpdGhNZXRhKGNvZGVCbG9ja0tleW1hcC5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiS2V5bWFwQ3R4PGNvZGVCbG9jaz5cIixcbiAgZ3JvdXA6IFwiQ29kZUJsb2NrXCJcbn0pO1xud2l0aE1ldGEoY29kZUJsb2NrS2V5bWFwLnNob3J0Y3V0cywge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXA8Y29kZUJsb2NrPlwiLFxuICBncm91cDogXCJDb2RlQmxvY2tcIlxufSk7XG5jb25zdCBpbWFnZUF0dHIgPSAkbm9kZUF0dHIoXCJpbWFnZVwiKTtcbndpdGhNZXRhKGltYWdlQXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGltYWdlPlwiLFxuICBncm91cDogXCJJbWFnZVwiXG59KTtcbmNvbnN0IGltYWdlU2NoZW1hID0gJG5vZGVTY2hlbWEoXCJpbWFnZVwiLCAoY3R4KSA9PiB7XG4gIHJldHVybiB7XG4gICAgaW5saW5lOiB0cnVlLFxuICAgIGdyb3VwOiBcImlubGluZVwiLFxuICAgIHNlbGVjdGFibGU6IHRydWUsXG4gICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgIG1hcmtzOiBcIlwiLFxuICAgIGF0b206IHRydWUsXG4gICAgZGVmaW5pbmc6IHRydWUsXG4gICAgaXNvbGF0aW5nOiB0cnVlLFxuICAgIGF0dHJzOiB7XG4gICAgICBzcmM6IHsgZGVmYXVsdDogXCJcIiwgdmFsaWRhdGU6IFwic3RyaW5nXCIgfSxcbiAgICAgIGFsdDogeyBkZWZhdWx0OiBcIlwiLCB2YWxpZGF0ZTogXCJzdHJpbmdcIiB9LFxuICAgICAgdGl0bGU6IHsgZGVmYXVsdDogXCJcIiwgdmFsaWRhdGU6IFwic3RyaW5nXCIgfVxuICAgIH0sXG4gICAgcGFyc2VET006IFtcbiAgICAgIHtcbiAgICAgICAgdGFnOiBcImltZ1tzcmNdXCIsXG4gICAgICAgIGdldEF0dHJzOiAoZG9tKSA9PiB7XG4gICAgICAgICAgaWYgKCEoZG9tIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB0aHJvdyBleHBlY3REb21UeXBlRXJyb3IoZG9tKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3JjOiBkb20uZ2V0QXR0cmlidXRlKFwic3JjXCIpIHx8IFwiXCIsXG4gICAgICAgICAgICBhbHQ6IGRvbS5nZXRBdHRyaWJ1dGUoXCJhbHRcIikgfHwgXCJcIixcbiAgICAgICAgICAgIHRpdGxlOiBkb20uZ2V0QXR0cmlidXRlKFwidGl0bGVcIikgfHwgZG9tLmdldEF0dHJpYnV0ZShcImFsdFwiKSB8fCBcIlwiXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF0sXG4gICAgdG9ET006IChub2RlKSA9PiB7XG4gICAgICByZXR1cm4gW1wiaW1nXCIsIHsgLi4uY3R4LmdldChpbWFnZUF0dHIua2V5KShub2RlKSwgLi4ubm9kZS5hdHRycyB9XTtcbiAgICB9LFxuICAgIHBhcnNlTWFya2Rvd246IHtcbiAgICAgIG1hdGNoOiAoeyB0eXBlIH0pID0+IHR5cGUgPT09IFwiaW1hZ2VcIixcbiAgICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlLCB0eXBlKSA9PiB7XG4gICAgICAgIGNvbnN0IHVybCA9IG5vZGUudXJsO1xuICAgICAgICBjb25zdCBhbHQgPSBub2RlLmFsdDtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBub2RlLnRpdGxlO1xuICAgICAgICBzdGF0ZS5hZGROb2RlKHR5cGUsIHtcbiAgICAgICAgICBzcmM6IHVybCxcbiAgICAgICAgICBhbHQsXG4gICAgICAgICAgdGl0bGVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICB0b01hcmtkb3duOiB7XG4gICAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZS5uYW1lID09PSBcImltYWdlXCIsXG4gICAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSkgPT4ge1xuICAgICAgICBzdGF0ZS5hZGROb2RlKFwiaW1hZ2VcIiwgdm9pZCAwLCB2b2lkIDAsIHtcbiAgICAgICAgICB0aXRsZTogbm9kZS5hdHRycy50aXRsZSxcbiAgICAgICAgICB1cmw6IG5vZGUuYXR0cnMuc3JjLFxuICAgICAgICAgIGFsdDogbm9kZS5hdHRycy5hbHRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufSk7XG53aXRoTWV0YShpbWFnZVNjaGVtYS5ub2RlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWE8aW1hZ2U+XCIsXG4gIGdyb3VwOiBcIkltYWdlXCJcbn0pO1xud2l0aE1ldGEoaW1hZ2VTY2hlbWEuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWFDdHg8aW1hZ2U+XCIsXG4gIGdyb3VwOiBcIkltYWdlXCJcbn0pO1xuY29uc3QgaW5zZXJ0SW1hZ2VDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiSW5zZXJ0SW1hZ2VcIixcbiAgKGN0eCkgPT4gKHBheWxvYWQgPSB7fSkgPT4gKHN0YXRlLCBkaXNwYXRjaCkgPT4ge1xuICAgIGlmICghZGlzcGF0Y2gpIHJldHVybiB0cnVlO1xuICAgIGNvbnN0IHsgc3JjID0gXCJcIiwgYWx0ID0gXCJcIiwgdGl0bGUgPSBcIlwiIH0gPSBwYXlsb2FkO1xuICAgIGNvbnN0IG5vZGUgPSBpbWFnZVNjaGVtYS50eXBlKGN0eCkuY3JlYXRlKHsgc3JjLCBhbHQsIHRpdGxlIH0pO1xuICAgIGlmICghbm9kZSkgcmV0dXJuIHRydWU7XG4gICAgZGlzcGF0Y2goc3RhdGUudHIucmVwbGFjZVNlbGVjdGlvbldpdGgobm9kZSkuc2Nyb2xsSW50b1ZpZXcoKSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbik7XG53aXRoTWV0YShpbnNlcnRJbWFnZUNvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDxpbnNlcnRJbWFnZUNvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIkltYWdlXCJcbn0pO1xuY29uc3QgdXBkYXRlSW1hZ2VDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiVXBkYXRlSW1hZ2VcIixcbiAgKGN0eCkgPT4gKHBheWxvYWQgPSB7fSkgPT4gKHN0YXRlLCBkaXNwYXRjaCkgPT4ge1xuICAgIGNvbnN0IG5vZGVXaXRoUG9zID0gZmluZFNlbGVjdGVkTm9kZU9mVHlwZShcbiAgICAgIHN0YXRlLnNlbGVjdGlvbixcbiAgICAgIGltYWdlU2NoZW1hLnR5cGUoY3R4KVxuICAgICk7XG4gICAgaWYgKCFub2RlV2l0aFBvcykgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHsgbm9kZSwgcG9zIH0gPSBub2RlV2l0aFBvcztcbiAgICBjb25zdCBuZXdBdHRycyA9IHsgLi4ubm9kZS5hdHRycyB9O1xuICAgIGNvbnN0IHsgc3JjLCBhbHQsIHRpdGxlIH0gPSBwYXlsb2FkO1xuICAgIGlmIChzcmMgIT09IHZvaWQgMCkgbmV3QXR0cnMuc3JjID0gc3JjO1xuICAgIGlmIChhbHQgIT09IHZvaWQgMCkgbmV3QXR0cnMuYWx0ID0gYWx0O1xuICAgIGlmICh0aXRsZSAhPT0gdm9pZCAwKSBuZXdBdHRycy50aXRsZSA9IHRpdGxlO1xuICAgIGRpc3BhdGNoID09IG51bGwgPyB2b2lkIDAgOiBkaXNwYXRjaChcbiAgICAgIHN0YXRlLnRyLnNldE5vZGVNYXJrdXAocG9zLCB2b2lkIDAsIG5ld0F0dHJzKS5zY3JvbGxJbnRvVmlldygpXG4gICAgKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuKTtcbndpdGhNZXRhKHVwZGF0ZUltYWdlQ29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPHVwZGF0ZUltYWdlQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiSW1hZ2VcIlxufSk7XG5jb25zdCBpbnNlcnRJbWFnZUlucHV0UnVsZSA9ICRpbnB1dFJ1bGUoXG4gIChjdHgpID0+IG5ldyBJbnB1dFJ1bGUoXG4gICAgLyFcXFsoPzxhbHQ+Lio/KV1cXCgoPzxmaWxlbmFtZT4uKj8pXFxzKig/PVwifFxcKSlcIj8oPzx0aXRsZT5bXlwiXSspP1wiP1xcKS8sXG4gICAgKHN0YXRlLCBtYXRjaCwgc3RhcnQsIGVuZCkgPT4ge1xuICAgICAgY29uc3QgW21hdGNoZWQsIGFsdCwgc3JjID0gXCJcIiwgdGl0bGVdID0gbWF0Y2g7XG4gICAgICBpZiAobWF0Y2hlZClcbiAgICAgICAgcmV0dXJuIHN0YXRlLnRyLnJlcGxhY2VXaXRoKFxuICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgIGVuZCxcbiAgICAgICAgICBpbWFnZVNjaGVtYS50eXBlKGN0eCkuY3JlYXRlKHsgc3JjLCBhbHQsIHRpdGxlIH0pXG4gICAgICAgICk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIClcbik7XG53aXRoTWV0YShpbnNlcnRJbWFnZUlucHV0UnVsZSwge1xuICBkaXNwbGF5TmFtZTogXCJJbnB1dFJ1bGU8aW5zZXJ0SW1hZ2VJbnB1dFJ1bGU+XCIsXG4gIGdyb3VwOiBcIkltYWdlXCJcbn0pO1xuY29uc3QgaGFyZGJyZWFrQXR0ciA9ICRub2RlQXR0cihcImhhcmRicmVha1wiLCAobm9kZSkgPT4ge1xuICByZXR1cm4ge1xuICAgIFwiZGF0YS10eXBlXCI6IFwiaGFyZGJyZWFrXCIsXG4gICAgXCJkYXRhLWlzLWlubGluZVwiOiBub2RlLmF0dHJzLmlzSW5saW5lXG4gIH07XG59KTtcbndpdGhNZXRhKGhhcmRicmVha0F0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxoYXJkYnJlYWs+XCIsXG4gIGdyb3VwOiBcIkhhcmRicmVha1wiXG59KTtcbmNvbnN0IGhhcmRicmVha1NjaGVtYSA9ICRub2RlU2NoZW1hKFwiaGFyZGJyZWFrXCIsIChjdHgpID0+ICh7XG4gIGlubGluZTogdHJ1ZSxcbiAgZ3JvdXA6IFwiaW5saW5lXCIsXG4gIGF0dHJzOiB7XG4gICAgaXNJbmxpbmU6IHtcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgdmFsaWRhdGU6IFwiYm9vbGVhblwiXG4gICAgfVxuICB9LFxuICBzZWxlY3RhYmxlOiBmYWxzZSxcbiAgcGFyc2VET006IFtcbiAgICB7IHRhZzogXCJiclwiIH0sXG4gICAge1xuICAgICAgdGFnOiAnc3BhbltkYXRhLXR5cGU9XCJoYXJkYnJlYWtcIl0nLFxuICAgICAgZ2V0QXR0cnM6ICgpID0+ICh7IGlzSW5saW5lOiB0cnVlIH0pXG4gICAgfVxuICBdLFxuICB0b0RPTTogKG5vZGUpID0+IG5vZGUuYXR0cnMuaXNJbmxpbmUgPyBbXCJzcGFuXCIsIGN0eC5nZXQoaGFyZGJyZWFrQXR0ci5rZXkpKG5vZGUpLCBcIiBcIl0gOiBbXCJiclwiLCBjdHguZ2V0KGhhcmRicmVha0F0dHIua2V5KShub2RlKV0sXG4gIHBhcnNlTWFya2Rvd246IHtcbiAgICBtYXRjaDogKHsgdHlwZSB9KSA9PiB0eXBlID09PSBcImJyZWFrXCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUsIHR5cGUpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIHN0YXRlLmFkZE5vZGUodHlwZSwge1xuICAgICAgICBpc0lubGluZTogQm9vbGVhbihcbiAgICAgICAgICAoX2EgPSBub2RlLmRhdGEpID09IG51bGwgPyB2b2lkIDAgOiBfYS5pc0lubGluZVxuICAgICAgICApXG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG4gIGxlYWZUZXh0OiAoKSA9PiBcIlxcblwiLFxuICB0b01hcmtkb3duOiB7XG4gICAgbWF0Y2g6IChub2RlKSA9PiBub2RlLnR5cGUubmFtZSA9PT0gXCJoYXJkYnJlYWtcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSkgPT4ge1xuICAgICAgaWYgKG5vZGUuYXR0cnMuaXNJbmxpbmUpIHN0YXRlLmFkZE5vZGUoXCJ0ZXh0XCIsIHZvaWQgMCwgXCJcXG5cIik7XG4gICAgICBlbHNlIHN0YXRlLmFkZE5vZGUoXCJicmVha1wiKTtcbiAgICB9XG4gIH1cbn0pKTtcbndpdGhNZXRhKGhhcmRicmVha1NjaGVtYS5ub2RlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWE8aGFyZGJyZWFrPlwiLFxuICBncm91cDogXCJIYXJkYnJlYWtcIlxufSk7XG53aXRoTWV0YShoYXJkYnJlYWtTY2hlbWEuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWFDdHg8aGFyZGJyZWFrPlwiLFxuICBncm91cDogXCJIYXJkYnJlYWtcIlxufSk7XG5jb25zdCBpbnNlcnRIYXJkYnJlYWtDb21tYW5kID0gJGNvbW1hbmQoXG4gIFwiSW5zZXJ0SGFyZGJyZWFrXCIsXG4gIChjdHgpID0+ICgpID0+IChzdGF0ZSwgZGlzcGF0Y2gpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgeyBzZWxlY3Rpb24sIHRyIH0gPSBzdGF0ZTtcbiAgICBpZiAoIShzZWxlY3Rpb24gaW5zdGFuY2VvZiBUZXh0U2VsZWN0aW9uKSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChzZWxlY3Rpb24uZW1wdHkpIHtcbiAgICAgIGNvbnN0IG5vZGUgPSBzZWxlY3Rpb24uJGZyb20ubm9kZSgpO1xuICAgICAgaWYgKG5vZGUuY2hpbGRDb3VudCA+IDAgJiYgKChfYSA9IG5vZGUubGFzdENoaWxkKSA9PSBudWxsID8gdm9pZCAwIDogX2EudHlwZS5uYW1lKSA9PT0gXCJoYXJkYnJlYWtcIikge1xuICAgICAgICBkaXNwYXRjaCA9PSBudWxsID8gdm9pZCAwIDogZGlzcGF0Y2goXG4gICAgICAgICAgdHIucmVwbGFjZVJhbmdlV2l0aChcbiAgICAgICAgICAgIHNlbGVjdGlvbi50byAtIDEsXG4gICAgICAgICAgICBzZWxlY3Rpb24udG8sXG4gICAgICAgICAgICBzdGF0ZS5zY2hlbWEubm9kZShcInBhcmFncmFwaFwiKVxuICAgICAgICAgICkuc2V0U2VsZWN0aW9uKFNlbGVjdGlvbi5uZWFyKHRyLmRvYy5yZXNvbHZlKHNlbGVjdGlvbi50bykpKS5zY3JvbGxJbnRvVmlldygpXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICBkaXNwYXRjaCA9PSBudWxsID8gdm9pZCAwIDogZGlzcGF0Y2goXG4gICAgICB0ci5zZXRNZXRhKFwiaGFyZGJyZWFrXCIsIHRydWUpLnJlcGxhY2VTZWxlY3Rpb25XaXRoKGhhcmRicmVha1NjaGVtYS50eXBlKGN0eCkuY3JlYXRlKCkpLnNjcm9sbEludG9WaWV3KClcbiAgICApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4pO1xud2l0aE1ldGEoaW5zZXJ0SGFyZGJyZWFrQ29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPGluc2VydEhhcmRicmVha0NvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIkhhcmRicmVha1wiXG59KTtcbmNvbnN0IGhhcmRicmVha0tleW1hcCA9ICR1c2VLZXltYXAoXCJoYXJkYnJlYWtLZXltYXBcIiwge1xuICBJbnNlcnRIYXJkYnJlYWs6IHtcbiAgICBzaG9ydGN1dHM6IFwiU2hpZnQtRW50ZXJcIixcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbChpbnNlcnRIYXJkYnJlYWtDb21tYW5kLmtleSk7XG4gICAgfVxuICB9XG59KTtcbndpdGhNZXRhKGhhcmRicmVha0tleW1hcC5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiS2V5bWFwQ3R4PGhhcmRicmVhaz5cIixcbiAgZ3JvdXA6IFwiSGFyZGJyZWFrXCJcbn0pO1xud2l0aE1ldGEoaGFyZGJyZWFrS2V5bWFwLnNob3J0Y3V0cywge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXA8aGFyZGJyZWFrPlwiLFxuICBncm91cDogXCJIYXJkYnJlYWtcIlxufSk7XG5jb25zdCBockF0dHIgPSAkbm9kZUF0dHIoXCJoclwiKTtcbndpdGhNZXRhKGhyQXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGhyPlwiLFxuICBncm91cDogXCJIclwiXG59KTtcbmNvbnN0IGhyU2NoZW1hID0gJG5vZGVTY2hlbWEoXCJoclwiLCAoY3R4KSA9PiAoe1xuICBncm91cDogXCJibG9ja1wiLFxuICBwYXJzZURPTTogW3sgdGFnOiBcImhyXCIgfV0sXG4gIHRvRE9NOiAobm9kZSkgPT4gW1wiaHJcIiwgY3R4LmdldChockF0dHIua2V5KShub2RlKV0sXG4gIHBhcnNlTWFya2Rvd246IHtcbiAgICBtYXRjaDogKHsgdHlwZSB9KSA9PiB0eXBlID09PSBcInRoZW1hdGljQnJlYWtcIixcbiAgICBydW5uZXI6IChzdGF0ZSwgXywgdHlwZSkgPT4ge1xuICAgICAgc3RhdGUuYWRkTm9kZSh0eXBlKTtcbiAgICB9XG4gIH0sXG4gIHRvTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZS5uYW1lID09PSBcImhyXCIsXG4gICAgcnVubmVyOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmFkZE5vZGUoXCJ0aGVtYXRpY0JyZWFrXCIpO1xuICAgIH1cbiAgfVxufSkpO1xud2l0aE1ldGEoaHJTY2hlbWEubm9kZSwge1xuICBkaXNwbGF5TmFtZTogXCJOb2RlU2NoZW1hPGhyPlwiLFxuICBncm91cDogXCJIclwiXG59KTtcbndpdGhNZXRhKGhyU2NoZW1hLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJOb2RlU2NoZW1hQ3R4PGhyPlwiLFxuICBncm91cDogXCJIclwiXG59KTtcbmNvbnN0IGluc2VydEhySW5wdXRSdWxlID0gJGlucHV0UnVsZShcbiAgKGN0eCkgPT4gbmV3IElucHV0UnVsZSgvXig/Oi0tLXxfX19cXHN8XFwqXFwqXFwqXFxzKSQvLCAoc3RhdGUsIG1hdGNoLCBzdGFydCwgZW5kKSA9PiB7XG4gICAgY29uc3QgeyB0ciB9ID0gc3RhdGU7XG4gICAgaWYgKG1hdGNoWzBdKSB0ci5yZXBsYWNlV2l0aChzdGFydCAtIDEsIGVuZCwgaHJTY2hlbWEudHlwZShjdHgpLmNyZWF0ZSgpKTtcbiAgICByZXR1cm4gdHI7XG4gIH0pXG4pO1xud2l0aE1ldGEoaW5zZXJ0SHJJbnB1dFJ1bGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiSW5wdXRSdWxlPGluc2VydEhySW5wdXRSdWxlPlwiLFxuICBncm91cDogXCJIclwiXG59KTtcbmNvbnN0IGluc2VydEhyQ29tbWFuZCA9ICRjb21tYW5kKFxuICBcIkluc2VydEhyXCIsXG4gIChjdHgpID0+ICgpID0+IChzdGF0ZSwgZGlzcGF0Y2gpID0+IHtcbiAgICBpZiAoIWRpc3BhdGNoKSByZXR1cm4gdHJ1ZTtcbiAgICBjb25zdCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhTY2hlbWEubm9kZS50eXBlKGN0eCkuY3JlYXRlKCk7XG4gICAgY29uc3QgeyB0ciwgc2VsZWN0aW9uIH0gPSBzdGF0ZTtcbiAgICBjb25zdCB7IGZyb20gfSA9IHNlbGVjdGlvbjtcbiAgICBjb25zdCBub2RlID0gaHJTY2hlbWEudHlwZShjdHgpLmNyZWF0ZSgpO1xuICAgIGlmICghbm9kZSkgcmV0dXJuIHRydWU7XG4gICAgY29uc3QgX3RyID0gdHIucmVwbGFjZVNlbGVjdGlvbldpdGgobm9kZSkuaW5zZXJ0KGZyb20sIHBhcmFncmFwaCk7XG4gICAgY29uc3Qgc2VsID0gU2VsZWN0aW9uLmZpbmRGcm9tKF90ci5kb2MucmVzb2x2ZShmcm9tKSwgMSwgdHJ1ZSk7XG4gICAgaWYgKCFzZWwpIHJldHVybiB0cnVlO1xuICAgIGRpc3BhdGNoKF90ci5zZXRTZWxlY3Rpb24oc2VsKS5zY3JvbGxJbnRvVmlldygpKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuKTtcbndpdGhNZXRhKGluc2VydEhyQ29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPGluc2VydEhyQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiSHJcIlxufSk7XG5jb25zdCBidWxsZXRMaXN0QXR0ciA9ICRub2RlQXR0cihcImJ1bGxldExpc3RcIik7XG53aXRoTWV0YShidWxsZXRMaXN0QXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGJ1bGxldExpc3Q+XCIsXG4gIGdyb3VwOiBcIkJ1bGxldExpc3RcIlxufSk7XG5jb25zdCBidWxsZXRMaXN0U2NoZW1hID0gJG5vZGVTY2hlbWEoXCJidWxsZXRfbGlzdFwiLCAoY3R4KSA9PiB7XG4gIHJldHVybiB7XG4gICAgY29udGVudDogXCJsaXN0SXRlbStcIixcbiAgICBncm91cDogXCJibG9ja1wiLFxuICAgIGF0dHJzOiB7XG4gICAgICBzcHJlYWQ6IHtcbiAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgIHZhbGlkYXRlOiBcImJvb2xlYW5cIlxuICAgICAgfVxuICAgIH0sXG4gICAgcGFyc2VET006IFtcbiAgICAgIHtcbiAgICAgICAgdGFnOiBcInVsXCIsXG4gICAgICAgIGdldEF0dHJzOiAoZG9tKSA9PiB7XG4gICAgICAgICAgaWYgKCEoZG9tIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB0aHJvdyBleHBlY3REb21UeXBlRXJyb3IoZG9tKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3ByZWFkOiBkb20uZGF0YXNldC5zcHJlYWQgPT09IFwidHJ1ZVwiXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF0sXG4gICAgdG9ET006IChub2RlKSA9PiB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBcInVsXCIsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5jdHguZ2V0KGJ1bGxldExpc3RBdHRyLmtleSkobm9kZSksXG4gICAgICAgICAgXCJkYXRhLXNwcmVhZFwiOiBub2RlLmF0dHJzLnNwcmVhZFxuICAgICAgICB9LFxuICAgICAgICAwXG4gICAgICBdO1xuICAgIH0sXG4gICAgcGFyc2VNYXJrZG93bjoge1xuICAgICAgbWF0Y2g6ICh7IHR5cGUsIG9yZGVyZWQgfSkgPT4gdHlwZSA9PT0gXCJsaXN0XCIgJiYgIW9yZGVyZWQsXG4gICAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSwgdHlwZSkgPT4ge1xuICAgICAgICBjb25zdCBzcHJlYWQgPSBub2RlLnNwcmVhZCAhPSBudWxsID8gYCR7bm9kZS5zcHJlYWR9YCA6IFwiZmFsc2VcIjtcbiAgICAgICAgc3RhdGUub3Blbk5vZGUodHlwZSwgeyBzcHJlYWQgfSkubmV4dChub2RlLmNoaWxkcmVuKS5jbG9zZU5vZGUoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHRvTWFya2Rvd246IHtcbiAgICAgIG1hdGNoOiAobm9kZSkgPT4gbm9kZS50eXBlLm5hbWUgPT09IFwiYnVsbGV0X2xpc3RcIixcbiAgICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlKSA9PiB7XG4gICAgICAgIHN0YXRlLm9wZW5Ob2RlKFwibGlzdFwiLCB2b2lkIDAsIHtcbiAgICAgICAgICBvcmRlcmVkOiBmYWxzZSxcbiAgICAgICAgICBzcHJlYWQ6IG5vZGUuYXR0cnMuc3ByZWFkXG4gICAgICAgIH0pLm5leHQobm9kZS5jb250ZW50KS5jbG9zZU5vZGUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59KTtcbndpdGhNZXRhKGJ1bGxldExpc3RTY2hlbWEubm9kZSwge1xuICBkaXNwbGF5TmFtZTogXCJOb2RlU2NoZW1hPGJ1bGxldExpc3Q+XCIsXG4gIGdyb3VwOiBcIkJ1bGxldExpc3RcIlxufSk7XG53aXRoTWV0YShidWxsZXRMaXN0U2NoZW1hLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJOb2RlU2NoZW1hQ3R4PGJ1bGxldExpc3Q+XCIsXG4gIGdyb3VwOiBcIkJ1bGxldExpc3RcIlxufSk7XG5jb25zdCB3cmFwSW5CdWxsZXRMaXN0SW5wdXRSdWxlID0gJGlucHV0UnVsZShcbiAgKGN0eCkgPT4gd3JhcHBpbmdJbnB1dFJ1bGUoL15cXHMqKFstKypdKVxccyQvLCBidWxsZXRMaXN0U2NoZW1hLnR5cGUoY3R4KSlcbik7XG53aXRoTWV0YSh3cmFwSW5CdWxsZXRMaXN0SW5wdXRSdWxlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIklucHV0UnVsZTx3cmFwSW5CdWxsZXRMaXN0SW5wdXRSdWxlPlwiLFxuICBncm91cDogXCJCdWxsZXRMaXN0XCJcbn0pO1xuY29uc3Qgd3JhcEluQnVsbGV0TGlzdENvbW1hbmQgPSAkY29tbWFuZChcbiAgXCJXcmFwSW5CdWxsZXRMaXN0XCIsXG4gIChjdHgpID0+ICgpID0+IHdyYXBJbihidWxsZXRMaXN0U2NoZW1hLnR5cGUoY3R4KSlcbik7XG53aXRoTWV0YSh3cmFwSW5CdWxsZXRMaXN0Q29tbWFuZCwge1xuICBkaXNwbGF5TmFtZTogXCJDb21tYW5kPHdyYXBJbkJ1bGxldExpc3RDb21tYW5kPlwiLFxuICBncm91cDogXCJCdWxsZXRMaXN0XCJcbn0pO1xuY29uc3QgYnVsbGV0TGlzdEtleW1hcCA9ICR1c2VLZXltYXAoXCJidWxsZXRMaXN0S2V5bWFwXCIsIHtcbiAgV3JhcEluQnVsbGV0TGlzdDoge1xuICAgIHNob3J0Y3V0czogXCJNb2QtQWx0LThcIixcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbCh3cmFwSW5CdWxsZXRMaXN0Q29tbWFuZC5rZXkpO1xuICAgIH1cbiAgfVxufSk7XG53aXRoTWV0YShidWxsZXRMaXN0S2V5bWFwLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXBDdHg8YnVsbGV0TGlzdEtleW1hcD5cIixcbiAgZ3JvdXA6IFwiQnVsbGV0TGlzdFwiXG59KTtcbndpdGhNZXRhKGJ1bGxldExpc3RLZXltYXAuc2hvcnRjdXRzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcDxidWxsZXRMaXN0S2V5bWFwPlwiLFxuICBncm91cDogXCJCdWxsZXRMaXN0XCJcbn0pO1xuY29uc3Qgb3JkZXJlZExpc3RBdHRyID0gJG5vZGVBdHRyKFwib3JkZXJlZExpc3RcIik7XG53aXRoTWV0YShvcmRlcmVkTGlzdEF0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxvcmRlcmVkTGlzdD5cIixcbiAgZ3JvdXA6IFwiT3JkZXJlZExpc3RcIlxufSk7XG5jb25zdCBvcmRlcmVkTGlzdFNjaGVtYSA9ICRub2RlU2NoZW1hKFwib3JkZXJlZF9saXN0XCIsIChjdHgpID0+ICh7XG4gIGNvbnRlbnQ6IFwibGlzdEl0ZW0rXCIsXG4gIGdyb3VwOiBcImJsb2NrXCIsXG4gIGF0dHJzOiB7XG4gICAgb3JkZXI6IHtcbiAgICAgIGRlZmF1bHQ6IDEsXG4gICAgICB2YWxpZGF0ZTogXCJudW1iZXJcIlxuICAgIH0sXG4gICAgc3ByZWFkOiB7XG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgIHZhbGlkYXRlOiBcImJvb2xlYW5cIlxuICAgIH1cbiAgfSxcbiAgcGFyc2VET006IFtcbiAgICB7XG4gICAgICB0YWc6IFwib2xcIixcbiAgICAgIGdldEF0dHJzOiAoZG9tKSA9PiB7XG4gICAgICAgIGlmICghKGRvbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgdGhyb3cgZXhwZWN0RG9tVHlwZUVycm9yKGRvbSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3ByZWFkOiBkb20uZGF0YXNldC5zcHJlYWQsXG4gICAgICAgICAgb3JkZXI6IGRvbS5oYXNBdHRyaWJ1dGUoXCJzdGFydFwiKSA/IE51bWJlcihkb20uZ2V0QXR0cmlidXRlKFwic3RhcnRcIikpIDogMVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgXSxcbiAgdG9ET006IChub2RlKSA9PiBbXG4gICAgXCJvbFwiLFxuICAgIHtcbiAgICAgIC4uLmN0eC5nZXQob3JkZXJlZExpc3RBdHRyLmtleSkobm9kZSksXG4gICAgICAuLi5ub2RlLmF0dHJzLm9yZGVyID09PSAxID8ge30gOiBub2RlLmF0dHJzLm9yZGVyLFxuICAgICAgXCJkYXRhLXNwcmVhZFwiOiBub2RlLmF0dHJzLnNwcmVhZFxuICAgIH0sXG4gICAgMFxuICBdLFxuICBwYXJzZU1hcmtkb3duOiB7XG4gICAgbWF0Y2g6ICh7IHR5cGUsIG9yZGVyZWQgfSkgPT4gdHlwZSA9PT0gXCJsaXN0XCIgJiYgISFvcmRlcmVkLFxuICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlLCB0eXBlKSA9PiB7XG4gICAgICBjb25zdCBzcHJlYWQgPSBub2RlLnNwcmVhZCAhPSBudWxsID8gYCR7bm9kZS5zcHJlYWR9YCA6IFwidHJ1ZVwiO1xuICAgICAgc3RhdGUub3Blbk5vZGUodHlwZSwgeyBzcHJlYWQgfSkubmV4dChub2RlLmNoaWxkcmVuKS5jbG9zZU5vZGUoKTtcbiAgICB9XG4gIH0sXG4gIHRvTWFya2Rvd246IHtcbiAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZS5uYW1lID09PSBcIm9yZGVyZWRfbGlzdFwiLFxuICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlKSA9PiB7XG4gICAgICBzdGF0ZS5vcGVuTm9kZShcImxpc3RcIiwgdm9pZCAwLCB7XG4gICAgICAgIG9yZGVyZWQ6IHRydWUsXG4gICAgICAgIHN0YXJ0OiAxLFxuICAgICAgICBzcHJlYWQ6IG5vZGUuYXR0cnMuc3ByZWFkID09PSBcInRydWVcIlxuICAgICAgfSk7XG4gICAgICBzdGF0ZS5uZXh0KG5vZGUuY29udGVudCk7XG4gICAgICBzdGF0ZS5jbG9zZU5vZGUoKTtcbiAgICB9XG4gIH1cbn0pKTtcbndpdGhNZXRhKG9yZGVyZWRMaXN0U2NoZW1hLm5vZGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYTxvcmRlcmVkTGlzdD5cIixcbiAgZ3JvdXA6IFwiT3JkZXJlZExpc3RcIlxufSk7XG53aXRoTWV0YShvcmRlcmVkTGlzdFNjaGVtYS5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYUN0eDxvcmRlcmVkTGlzdD5cIixcbiAgZ3JvdXA6IFwiT3JkZXJlZExpc3RcIlxufSk7XG5jb25zdCB3cmFwSW5PcmRlcmVkTGlzdElucHV0UnVsZSA9ICRpbnB1dFJ1bGUoXG4gIChjdHgpID0+IHdyYXBwaW5nSW5wdXRSdWxlKFxuICAgIC9eXFxzKihcXGQrKVxcLlxccyQvLFxuICAgIG9yZGVyZWRMaXN0U2NoZW1hLnR5cGUoY3R4KSxcbiAgICAobWF0Y2gpID0+ICh7IG9yZGVyOiBOdW1iZXIobWF0Y2hbMV0pIH0pLFxuICAgIChtYXRjaCwgbm9kZSkgPT4gbm9kZS5jaGlsZENvdW50ICsgbm9kZS5hdHRycy5vcmRlciA9PT0gTnVtYmVyKG1hdGNoWzFdKVxuICApXG4pO1xud2l0aE1ldGEod3JhcEluT3JkZXJlZExpc3RJbnB1dFJ1bGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiSW5wdXRSdWxlPHdyYXBJbk9yZGVyZWRMaXN0SW5wdXRSdWxlPlwiLFxuICBncm91cDogXCJPcmRlcmVkTGlzdFwiXG59KTtcbmNvbnN0IHdyYXBJbk9yZGVyZWRMaXN0Q29tbWFuZCA9ICRjb21tYW5kKFxuICBcIldyYXBJbk9yZGVyZWRMaXN0XCIsXG4gIChjdHgpID0+ICgpID0+IHdyYXBJbihvcmRlcmVkTGlzdFNjaGVtYS50eXBlKGN0eCkpXG4pO1xud2l0aE1ldGEod3JhcEluT3JkZXJlZExpc3RDb21tYW5kLCB7XG4gIGRpc3BsYXlOYW1lOiBcIkNvbW1hbmQ8d3JhcEluT3JkZXJlZExpc3RDb21tYW5kPlwiLFxuICBncm91cDogXCJPcmRlcmVkTGlzdFwiXG59KTtcbmNvbnN0IG9yZGVyZWRMaXN0S2V5bWFwID0gJHVzZUtleW1hcChcIm9yZGVyZWRMaXN0S2V5bWFwXCIsIHtcbiAgV3JhcEluT3JkZXJlZExpc3Q6IHtcbiAgICBzaG9ydGN1dHM6IFwiTW9kLUFsdC03XCIsXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwod3JhcEluT3JkZXJlZExpc3RDb21tYW5kLmtleSk7XG4gICAgfVxuICB9XG59KTtcbndpdGhNZXRhKG9yZGVyZWRMaXN0S2V5bWFwLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXBDdHg8b3JkZXJlZExpc3Q+XCIsXG4gIGdyb3VwOiBcIk9yZGVyZWRMaXN0XCJcbn0pO1xud2l0aE1ldGEob3JkZXJlZExpc3RLZXltYXAuc2hvcnRjdXRzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcDxvcmRlcmVkTGlzdD5cIixcbiAgZ3JvdXA6IFwiT3JkZXJlZExpc3RcIlxufSk7XG5jb25zdCBsaXN0SXRlbUF0dHIgPSAkbm9kZUF0dHIoXCJsaXN0SXRlbVwiKTtcbndpdGhNZXRhKGxpc3RJdGVtQXR0ciwge1xuICBkaXNwbGF5TmFtZTogXCJBdHRyPGxpc3RJdGVtPlwiLFxuICBncm91cDogXCJMaXN0SXRlbVwiXG59KTtcbmNvbnN0IGxpc3RJdGVtU2NoZW1hID0gJG5vZGVTY2hlbWEoXCJsaXN0X2l0ZW1cIiwgKGN0eCkgPT4gKHtcbiAgZ3JvdXA6IFwibGlzdEl0ZW1cIixcbiAgY29udGVudDogXCJwYXJhZ3JhcGggYmxvY2sqXCIsXG4gIGF0dHJzOiB7XG4gICAgbGFiZWw6IHtcbiAgICAgIGRlZmF1bHQ6IFwi4oCiXCIsXG4gICAgICB2YWxpZGF0ZTogXCJzdHJpbmdcIlxuICAgIH0sXG4gICAgbGlzdFR5cGU6IHtcbiAgICAgIGRlZmF1bHQ6IFwiYnVsbGV0XCIsXG4gICAgICB2YWxpZGF0ZTogXCJzdHJpbmdcIlxuICAgIH0sXG4gICAgc3ByZWFkOiB7XG4gICAgICBkZWZhdWx0OiB0cnVlLFxuICAgICAgdmFsaWRhdGU6IFwiYm9vbGVhblwiXG4gICAgfVxuICB9LFxuICBkZWZpbmluZzogdHJ1ZSxcbiAgcGFyc2VET006IFtcbiAgICB7XG4gICAgICB0YWc6IFwibGlcIixcbiAgICAgIGdldEF0dHJzOiAoZG9tKSA9PiB7XG4gICAgICAgIGlmICghKGRvbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgdGhyb3cgZXhwZWN0RG9tVHlwZUVycm9yKGRvbSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbGFiZWw6IGRvbS5kYXRhc2V0LmxhYmVsLFxuICAgICAgICAgIGxpc3RUeXBlOiBkb20uZGF0YXNldC5saXN0VHlwZSxcbiAgICAgICAgICBzcHJlYWQ6IGRvbS5kYXRhc2V0LnNwcmVhZCA9PT0gXCJ0cnVlXCJcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIF0sXG4gIHRvRE9NOiAobm9kZSkgPT4gW1xuICAgIFwibGlcIixcbiAgICB7XG4gICAgICAuLi5jdHguZ2V0KGxpc3RJdGVtQXR0ci5rZXkpKG5vZGUpLFxuICAgICAgXCJkYXRhLWxhYmVsXCI6IG5vZGUuYXR0cnMubGFiZWwsXG4gICAgICBcImRhdGEtbGlzdC10eXBlXCI6IG5vZGUuYXR0cnMubGlzdFR5cGUsXG4gICAgICBcImRhdGEtc3ByZWFkXCI6IG5vZGUuYXR0cnMuc3ByZWFkXG4gICAgfSxcbiAgICAwXG4gIF0sXG4gIHBhcnNlTWFya2Rvd246IHtcbiAgICBtYXRjaDogKHsgdHlwZSB9KSA9PiB0eXBlID09PSBcImxpc3RJdGVtXCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUsIHR5cGUpID0+IHtcbiAgICAgIGNvbnN0IGxhYmVsID0gbm9kZS5sYWJlbCAhPSBudWxsID8gYCR7bm9kZS5sYWJlbH0uYCA6IFwi4oCiXCI7XG4gICAgICBjb25zdCBsaXN0VHlwZSA9IG5vZGUubGFiZWwgIT0gbnVsbCA/IFwib3JkZXJlZFwiIDogXCJidWxsZXRcIjtcbiAgICAgIGNvbnN0IHNwcmVhZCA9IG5vZGUuc3ByZWFkICE9IG51bGwgPyBgJHtub2RlLnNwcmVhZH1gIDogXCJ0cnVlXCI7XG4gICAgICBzdGF0ZS5vcGVuTm9kZSh0eXBlLCB7IGxhYmVsLCBsaXN0VHlwZSwgc3ByZWFkIH0pO1xuICAgICAgc3RhdGUubmV4dChub2RlLmNoaWxkcmVuKTtcbiAgICAgIHN0YXRlLmNsb3NlTm9kZSgpO1xuICAgIH1cbiAgfSxcbiAgdG9NYXJrZG93bjoge1xuICAgIG1hdGNoOiAobm9kZSkgPT4gbm9kZS50eXBlLm5hbWUgPT09IFwibGlzdF9pdGVtXCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUpID0+IHtcbiAgICAgIHN0YXRlLm9wZW5Ob2RlKFwibGlzdEl0ZW1cIiwgdm9pZCAwLCB7XG4gICAgICAgIHNwcmVhZDogbm9kZS5hdHRycy5zcHJlYWRcbiAgICAgIH0pO1xuICAgICAgc3RhdGUubmV4dChub2RlLmNvbnRlbnQpO1xuICAgICAgc3RhdGUuY2xvc2VOb2RlKCk7XG4gICAgfVxuICB9XG59KSk7XG53aXRoTWV0YShsaXN0SXRlbVNjaGVtYS5ub2RlLCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWE8bGlzdEl0ZW0+XCIsXG4gIGdyb3VwOiBcIkxpc3RJdGVtXCJcbn0pO1xud2l0aE1ldGEobGlzdEl0ZW1TY2hlbWEuY3R4LCB7XG4gIGRpc3BsYXlOYW1lOiBcIk5vZGVTY2hlbWFDdHg8bGlzdEl0ZW0+XCIsXG4gIGdyb3VwOiBcIkxpc3RJdGVtXCJcbn0pO1xuY29uc3Qgc2lua0xpc3RJdGVtQ29tbWFuZCA9ICRjb21tYW5kKFxuICBcIlNpbmtMaXN0SXRlbVwiLFxuICAoY3R4KSA9PiAoKSA9PiBzaW5rTGlzdEl0ZW0obGlzdEl0ZW1TY2hlbWEudHlwZShjdHgpKVxuKTtcbndpdGhNZXRhKHNpbmtMaXN0SXRlbUNvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDxzaW5rTGlzdEl0ZW1Db21tYW5kPlwiLFxuICBncm91cDogXCJMaXN0SXRlbVwiXG59KTtcbmNvbnN0IGxpZnRMaXN0SXRlbUNvbW1hbmQgPSAkY29tbWFuZChcbiAgXCJMaWZ0TGlzdEl0ZW1cIixcbiAgKGN0eCkgPT4gKCkgPT4gbGlmdExpc3RJdGVtKGxpc3RJdGVtU2NoZW1hLnR5cGUoY3R4KSlcbik7XG53aXRoTWV0YShsaWZ0TGlzdEl0ZW1Db21tYW5kLCB7XG4gIGRpc3BsYXlOYW1lOiBcIkNvbW1hbmQ8bGlmdExpc3RJdGVtQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiTGlzdEl0ZW1cIlxufSk7XG5jb25zdCBzcGxpdExpc3RJdGVtQ29tbWFuZCA9ICRjb21tYW5kKFxuICBcIlNwbGl0TGlzdEl0ZW1cIixcbiAgKGN0eCkgPT4gKCkgPT4gc3BsaXRMaXN0SXRlbShsaXN0SXRlbVNjaGVtYS50eXBlKGN0eCkpXG4pO1xud2l0aE1ldGEoc3BsaXRMaXN0SXRlbUNvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDxzcGxpdExpc3RJdGVtQ29tbWFuZD5cIixcbiAgZ3JvdXA6IFwiTGlzdEl0ZW1cIlxufSk7XG5mdW5jdGlvbiBsaWZ0Rmlyc3RMaXN0SXRlbShjdHgpIHtcbiAgcmV0dXJuIChzdGF0ZSwgZGlzcGF0Y2gsIHZpZXcpID0+IHtcbiAgICBjb25zdCB7IHNlbGVjdGlvbiB9ID0gc3RhdGU7XG4gICAgaWYgKCEoc2VsZWN0aW9uIGluc3RhbmNlb2YgVGV4dFNlbGVjdGlvbikpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCB7IGVtcHR5LCAkZnJvbSB9ID0gc2VsZWN0aW9uO1xuICAgIGlmICghZW1wdHkgfHwgJGZyb20ucGFyZW50T2Zmc2V0ICE9PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgcGFyZW50SXRlbSA9ICRmcm9tLm5vZGUoLTEpO1xuICAgIGlmIChwYXJlbnRJdGVtLnR5cGUgIT09IGxpc3RJdGVtU2NoZW1hLnR5cGUoY3R4KSB8fCBwYXJlbnRJdGVtLmZpcnN0Q2hpbGQgIT09ICRmcm9tLm5vZGUoKSlcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBsaXN0ID0gJGZyb20ubm9kZSgtMik7XG4gICAgaWYgKGxpc3QuY2hpbGRDb3VudCA+IDEpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gbGlmdExpc3RJdGVtKGxpc3RJdGVtU2NoZW1hLnR5cGUoY3R4KSkoc3RhdGUsIGRpc3BhdGNoLCB2aWV3KTtcbiAgfTtcbn1cbmNvbnN0IGxpZnRGaXJzdExpc3RJdGVtQ29tbWFuZCA9ICRjb21tYW5kKFxuICBcIkxpZnRGaXJzdExpc3RJdGVtXCIsXG4gIChjdHgpID0+ICgpID0+IGxpZnRGaXJzdExpc3RJdGVtKGN0eClcbik7XG53aXRoTWV0YShsaWZ0Rmlyc3RMaXN0SXRlbUNvbW1hbmQsIHtcbiAgZGlzcGxheU5hbWU6IFwiQ29tbWFuZDxsaWZ0Rmlyc3RMaXN0SXRlbUNvbW1hbmQ+XCIsXG4gIGdyb3VwOiBcIkxpc3RJdGVtXCJcbn0pO1xuY29uc3QgbGlzdEl0ZW1LZXltYXAgPSAkdXNlS2V5bWFwKFwibGlzdEl0ZW1LZXltYXBcIiwge1xuICBOZXh0TGlzdEl0ZW06IHtcbiAgICBzaG9ydGN1dHM6IFwiRW50ZXJcIixcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbChzcGxpdExpc3RJdGVtQ29tbWFuZC5rZXkpO1xuICAgIH1cbiAgfSxcbiAgU2lua0xpc3RJdGVtOiB7XG4gICAgc2hvcnRjdXRzOiBbXCJUYWJcIiwgXCJNb2QtXVwiXSxcbiAgICBjb21tYW5kOiAoY3R4KSA9PiB7XG4gICAgICBjb25zdCBjb21tYW5kczIgPSBjdHguZ2V0KGNvbW1hbmRzQ3R4KTtcbiAgICAgIHJldHVybiAoKSA9PiBjb21tYW5kczIuY2FsbChzaW5rTGlzdEl0ZW1Db21tYW5kLmtleSk7XG4gICAgfVxuICB9LFxuICBMaWZ0TGlzdEl0ZW06IHtcbiAgICBzaG9ydGN1dHM6IFtcIlNoaWZ0LVRhYlwiLCBcIk1vZC1bXCJdLFxuICAgIGNvbW1hbmQ6IChjdHgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1hbmRzMiA9IGN0eC5nZXQoY29tbWFuZHNDdHgpO1xuICAgICAgcmV0dXJuICgpID0+IGNvbW1hbmRzMi5jYWxsKGxpZnRMaXN0SXRlbUNvbW1hbmQua2V5KTtcbiAgICB9XG4gIH0sXG4gIExpZnRGaXJzdExpc3RJdGVtOiB7XG4gICAgc2hvcnRjdXRzOiBbXCJCYWNrc3BhY2VcIiwgXCJEZWxldGVcIl0sXG4gICAgY29tbWFuZDogKGN0eCkgPT4ge1xuICAgICAgY29uc3QgY29tbWFuZHMyID0gY3R4LmdldChjb21tYW5kc0N0eCk7XG4gICAgICByZXR1cm4gKCkgPT4gY29tbWFuZHMyLmNhbGwobGlmdEZpcnN0TGlzdEl0ZW1Db21tYW5kLmtleSk7XG4gICAgfVxuICB9XG59KTtcbndpdGhNZXRhKGxpc3RJdGVtS2V5bWFwLmN0eCwge1xuICBkaXNwbGF5TmFtZTogXCJLZXltYXBDdHg8bGlzdEl0ZW0+XCIsXG4gIGdyb3VwOiBcIkxpc3RJdGVtXCJcbn0pO1xud2l0aE1ldGEobGlzdEl0ZW1LZXltYXAuc2hvcnRjdXRzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIktleW1hcDxsaXN0SXRlbT5cIixcbiAgZ3JvdXA6IFwiTGlzdEl0ZW1cIlxufSk7XG5jb25zdCB0ZXh0U2NoZW1hID0gJG5vZGUoXCJ0ZXh0XCIsICgpID0+ICh7XG4gIGdyb3VwOiBcImlubGluZVwiLFxuICBwYXJzZU1hcmtkb3duOiB7XG4gICAgbWF0Y2g6ICh7IHR5cGUgfSkgPT4gdHlwZSA9PT0gXCJ0ZXh0XCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUpID0+IHtcbiAgICAgIHN0YXRlLmFkZFRleHQobm9kZS52YWx1ZSk7XG4gICAgfVxuICB9LFxuICB0b01hcmtkb3duOiB7XG4gICAgbWF0Y2g6IChub2RlKSA9PiBub2RlLnR5cGUubmFtZSA9PT0gXCJ0ZXh0XCIsXG4gICAgcnVubmVyOiAoc3RhdGUsIG5vZGUpID0+IHtcbiAgICAgIHN0YXRlLmFkZE5vZGUoXCJ0ZXh0XCIsIHZvaWQgMCwgbm9kZS50ZXh0KTtcbiAgICB9XG4gIH1cbn0pKTtcbndpdGhNZXRhKHRleHRTY2hlbWEsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYTx0ZXh0PlwiLFxuICBncm91cDogXCJUZXh0XCJcbn0pO1xuY29uc3QgaHRtbEF0dHIgPSAkbm9kZUF0dHIoXCJodG1sXCIpO1xud2l0aE1ldGEoaHRtbEF0dHIsIHtcbiAgZGlzcGxheU5hbWU6IFwiQXR0cjxodG1sPlwiLFxuICBncm91cDogXCJIdG1sXCJcbn0pO1xuY29uc3QgaHRtbFNjaGVtYSA9ICRub2RlU2NoZW1hKFwiaHRtbFwiLCAoY3R4KSA9PiB7XG4gIHJldHVybiB7XG4gICAgYXRvbTogdHJ1ZSxcbiAgICBncm91cDogXCJpbmxpbmVcIixcbiAgICBpbmxpbmU6IHRydWUsXG4gICAgYXR0cnM6IHtcbiAgICAgIHZhbHVlOiB7XG4gICAgICAgIGRlZmF1bHQ6IFwiXCIsXG4gICAgICAgIHZhbGlkYXRlOiBcInN0cmluZ1wiXG4gICAgICB9XG4gICAgfSxcbiAgICB0b0RPTTogKG5vZGUpID0+IHtcbiAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgIGNvbnN0IGF0dHIgPSB7XG4gICAgICAgIC4uLmN0eC5nZXQoaHRtbEF0dHIua2V5KShub2RlKSxcbiAgICAgICAgXCJkYXRhLXZhbHVlXCI6IG5vZGUuYXR0cnMudmFsdWUsXG4gICAgICAgIFwiZGF0YS10eXBlXCI6IFwiaHRtbFwiXG4gICAgICB9O1xuICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IG5vZGUuYXR0cnMudmFsdWU7XG4gICAgICByZXR1cm4gW1wic3BhblwiLCBhdHRyLCBub2RlLmF0dHJzLnZhbHVlXTtcbiAgICB9LFxuICAgIHBhcnNlRE9NOiBbXG4gICAgICB7XG4gICAgICAgIHRhZzogJ3NwYW5bZGF0YS10eXBlPVwiaHRtbFwiXScsXG4gICAgICAgIGdldEF0dHJzOiAoZG9tKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiBkb20uZGF0YXNldC52YWx1ZSA/PyBcIlwiXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF0sXG4gICAgcGFyc2VNYXJrZG93bjoge1xuICAgICAgbWF0Y2g6ICh7IHR5cGUgfSkgPT4gQm9vbGVhbih0eXBlID09PSBcImh0bWxcIiksXG4gICAgICBydW5uZXI6IChzdGF0ZSwgbm9kZSwgdHlwZSkgPT4ge1xuICAgICAgICBzdGF0ZS5hZGROb2RlKHR5cGUsIHsgdmFsdWU6IG5vZGUudmFsdWUgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICB0b01hcmtkb3duOiB7XG4gICAgICBtYXRjaDogKG5vZGUpID0+IG5vZGUudHlwZS5uYW1lID09PSBcImh0bWxcIixcbiAgICAgIHJ1bm5lcjogKHN0YXRlLCBub2RlKSA9PiB7XG4gICAgICAgIHN0YXRlLmFkZE5vZGUoXCJodG1sXCIsIHZvaWQgMCwgbm9kZS5hdHRycy52YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufSk7XG53aXRoTWV0YShodG1sU2NoZW1hLm5vZGUsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYTxodG1sPlwiLFxuICBncm91cDogXCJIdG1sXCJcbn0pO1xud2l0aE1ldGEoaHRtbFNjaGVtYS5jdHgsIHtcbiAgZGlzcGxheU5hbWU6IFwiTm9kZVNjaGVtYUN0eDxodG1sPlwiLFxuICBncm91cDogXCJIdG1sXCJcbn0pO1xuY29uc3Qgc2NoZW1hID0gW1xuICBkb2NTY2hlbWEsXG4gIHBhcmFncmFwaEF0dHIsXG4gIHBhcmFncmFwaFNjaGVtYSxcbiAgaGVhZGluZ0lkR2VuZXJhdG9yLFxuICBoZWFkaW5nQXR0cixcbiAgaGVhZGluZ1NjaGVtYSxcbiAgaGFyZGJyZWFrQXR0cixcbiAgaGFyZGJyZWFrU2NoZW1hLFxuICBibG9ja3F1b3RlQXR0cixcbiAgYmxvY2txdW90ZVNjaGVtYSxcbiAgY29kZUJsb2NrQXR0cixcbiAgY29kZUJsb2NrU2NoZW1hLFxuICBockF0dHIsXG4gIGhyU2NoZW1hLFxuICBpbWFnZUF0dHIsXG4gIGltYWdlU2NoZW1hLFxuICBidWxsZXRMaXN0QXR0cixcbiAgYnVsbGV0TGlzdFNjaGVtYSxcbiAgb3JkZXJlZExpc3RBdHRyLFxuICBvcmRlcmVkTGlzdFNjaGVtYSxcbiAgbGlzdEl0ZW1BdHRyLFxuICBsaXN0SXRlbVNjaGVtYSxcbiAgZW1waGFzaXNBdHRyLFxuICBlbXBoYXNpc1NjaGVtYSxcbiAgc3Ryb25nQXR0cixcbiAgc3Ryb25nU2NoZW1hLFxuICBpbmxpbmVDb2RlQXR0cixcbiAgaW5saW5lQ29kZVNjaGVtYSxcbiAgbGlua0F0dHIsXG4gIGxpbmtTY2hlbWEsXG4gIGh0bWxBdHRyLFxuICBodG1sU2NoZW1hLFxuICB0ZXh0U2NoZW1hXG5dLmZsYXQoKTtcbmNvbnN0IGlucHV0UnVsZXMgPSBbXG4gIHdyYXBJbkJsb2NrcXVvdGVJbnB1dFJ1bGUsXG4gIHdyYXBJbkJ1bGxldExpc3RJbnB1dFJ1bGUsXG4gIHdyYXBJbk9yZGVyZWRMaXN0SW5wdXRSdWxlLFxuICBjcmVhdGVDb2RlQmxvY2tJbnB1dFJ1bGUsXG4gIGluc2VydEhySW5wdXRSdWxlLFxuICB3cmFwSW5IZWFkaW5nSW5wdXRSdWxlXG5dLmZsYXQoKTtcbmNvbnN0IG1hcmtJbnB1dFJ1bGVzID0gW1xuICBlbXBoYXNpc1N0YXJJbnB1dFJ1bGUsXG4gIGVtcGhhc2lzVW5kZXJzY29yZUlucHV0UnVsZSxcbiAgaW5saW5lQ29kZUlucHV0UnVsZSxcbiAgc3Ryb25nSW5wdXRSdWxlXG5dO1xuY29uc3QgY29tbWFuZHMgPSBbXG4gIHR1cm5JbnRvVGV4dENvbW1hbmQsXG4gIHdyYXBJbkJsb2NrcXVvdGVDb21tYW5kLFxuICB3cmFwSW5IZWFkaW5nQ29tbWFuZCxcbiAgZG93bmdyYWRlSGVhZGluZ0NvbW1hbmQsXG4gIGNyZWF0ZUNvZGVCbG9ja0NvbW1hbmQsXG4gIGluc2VydEhhcmRicmVha0NvbW1hbmQsXG4gIGluc2VydEhyQ29tbWFuZCxcbiAgaW5zZXJ0SW1hZ2VDb21tYW5kLFxuICB1cGRhdGVJbWFnZUNvbW1hbmQsXG4gIHdyYXBJbk9yZGVyZWRMaXN0Q29tbWFuZCxcbiAgd3JhcEluQnVsbGV0TGlzdENvbW1hbmQsXG4gIHNpbmtMaXN0SXRlbUNvbW1hbmQsXG4gIHNwbGl0TGlzdEl0ZW1Db21tYW5kLFxuICBsaWZ0TGlzdEl0ZW1Db21tYW5kLFxuICBsaWZ0Rmlyc3RMaXN0SXRlbUNvbW1hbmQsXG4gIHRvZ2dsZUVtcGhhc2lzQ29tbWFuZCxcbiAgdG9nZ2xlSW5saW5lQ29kZUNvbW1hbmQsXG4gIHRvZ2dsZVN0cm9uZ0NvbW1hbmQsXG4gIHRvZ2dsZUxpbmtDb21tYW5kLFxuICB1cGRhdGVMaW5rQ29tbWFuZFxuXTtcbmNvbnN0IGtleW1hcCA9IFtcbiAgYmxvY2txdW90ZUtleW1hcCxcbiAgY29kZUJsb2NrS2V5bWFwLFxuICBoYXJkYnJlYWtLZXltYXAsXG4gIGhlYWRpbmdLZXltYXAsXG4gIGxpc3RJdGVtS2V5bWFwLFxuICBvcmRlcmVkTGlzdEtleW1hcCxcbiAgYnVsbGV0TGlzdEtleW1hcCxcbiAgcGFyYWdyYXBoS2V5bWFwLFxuICBlbXBoYXNpc0tleW1hcCxcbiAgaW5saW5lQ29kZUtleW1hcCxcbiAgc3Ryb25nS2V5bWFwXG5dLmZsYXQoKTtcbmNvbnN0IHJlbWFya0FkZE9yZGVySW5MaXN0UGx1Z2luID0gJHJlbWFyayhcbiAgXCJyZW1hcmtBZGRPcmRlckluTGlzdFwiLFxuICAoKSA9PiAoKSA9PiAodHJlZSkgPT4ge1xuICAgIHZpc2l0KHRyZWUsIFwibGlzdFwiLCAobm9kZSkgPT4ge1xuICAgICAgaWYgKG5vZGUub3JkZXJlZCkge1xuICAgICAgICBjb25zdCBzdGFydCA9IG5vZGUuc3RhcnQgPz8gMTtcbiAgICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCwgaW5kZXgpID0+IHtcbiAgICAgICAgICBjaGlsZC5sYWJlbCA9IGluZGV4ICsgc3RhcnQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xud2l0aE1ldGEocmVtYXJrQWRkT3JkZXJJbkxpc3RQbHVnaW4ucGx1Z2luLCB7XG4gIGRpc3BsYXlOYW1lOiBcIlJlbWFyazxyZW1hcmtBZGRPcmRlckluTGlzdFBsdWdpbj5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xud2l0aE1ldGEocmVtYXJrQWRkT3JkZXJJbkxpc3RQbHVnaW4ub3B0aW9ucywge1xuICBkaXNwbGF5TmFtZTogXCJSZW1hcmtDb25maWc8cmVtYXJrQWRkT3JkZXJJbkxpc3RQbHVnaW4+XCIsXG4gIGdyb3VwOiBcIlJlbWFya1wiXG59KTtcbmNvbnN0IHJlbWFya0xpbmVCcmVhayA9ICRyZW1hcmsoXG4gIFwicmVtYXJrTGluZUJyZWFrXCIsXG4gICgpID0+ICgpID0+ICh0cmVlKSA9PiB7XG4gICAgY29uc3QgZmluZCA9IC9bXFx0IF0qKD86XFxyP1xcbnxcXHIpL2c7XG4gICAgdmlzaXQoXG4gICAgICB0cmVlLFxuICAgICAgXCJ0ZXh0XCIsXG4gICAgICAobm9kZSwgaW5kZXgsIHBhcmVudCkgPT4ge1xuICAgICAgICBpZiAoIW5vZGUudmFsdWUgfHwgdHlwZW9mIG5vZGUudmFsdWUgIT09IFwic3RyaW5nXCIpIHJldHVybjtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgIGxldCBzdGFydCA9IDA7XG4gICAgICAgIGZpbmQubGFzdEluZGV4ID0gMDtcbiAgICAgICAgbGV0IG1hdGNoID0gZmluZC5leGVjKG5vZGUudmFsdWUpO1xuICAgICAgICB3aGlsZSAobWF0Y2gpIHtcbiAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IG1hdGNoLmluZGV4O1xuICAgICAgICAgIGlmIChzdGFydCAhPT0gcG9zaXRpb24pXG4gICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogbm9kZS52YWx1ZS5zbGljZShzdGFydCwgcG9zaXRpb24pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICByZXN1bHQucHVzaCh7IHR5cGU6IFwiYnJlYWtcIiwgZGF0YTogeyBpc0lubGluZTogdHJ1ZSB9IH0pO1xuICAgICAgICAgIHN0YXJ0ID0gcG9zaXRpb24gKyBtYXRjaFswXS5sZW5ndGg7XG4gICAgICAgICAgbWF0Y2ggPSBmaW5kLmV4ZWMobm9kZS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzUmVzdWx0QW5kSW5kZXggPSByZXN1bHQubGVuZ3RoID4gMCAmJiBwYXJlbnQgJiYgdHlwZW9mIGluZGV4ID09PSBcIm51bWJlclwiO1xuICAgICAgICBpZiAoIWhhc1Jlc3VsdEFuZEluZGV4KSByZXR1cm47XG4gICAgICAgIGlmIChzdGFydCA8IG5vZGUudmFsdWUubGVuZ3RoKVxuICAgICAgICAgIHJlc3VsdC5wdXNoKHsgdHlwZTogXCJ0ZXh0XCIsIHZhbHVlOiBub2RlLnZhbHVlLnNsaWNlKHN0YXJ0KSB9KTtcbiAgICAgICAgcGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSwgLi4ucmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIGluZGV4ICsgcmVzdWx0Lmxlbmd0aDtcbiAgICAgIH1cbiAgICApO1xuICB9XG4pO1xud2l0aE1ldGEocmVtYXJrTGluZUJyZWFrLnBsdWdpbiwge1xuICBkaXNwbGF5TmFtZTogXCJSZW1hcms8cmVtYXJrTGluZUJyZWFrPlwiLFxuICBncm91cDogXCJSZW1hcmtcIlxufSk7XG53aXRoTWV0YShyZW1hcmtMaW5lQnJlYWsub3B0aW9ucywge1xuICBkaXNwbGF5TmFtZTogXCJSZW1hcmtDb25maWc8cmVtYXJrTGluZUJyZWFrPlwiLFxuICBncm91cDogXCJSZW1hcmtcIlxufSk7XG5jb25zdCByZW1hcmtJbmxpbmVMaW5rUGx1Z2luID0gJHJlbWFyayhcbiAgXCJyZW1hcmtJbmxpbmVMaW5rXCIsXG4gICgpID0+IHJlbWFya0lubGluZUxpbmtzXG4pO1xud2l0aE1ldGEocmVtYXJrSW5saW5lTGlua1BsdWdpbi5wbHVnaW4sIHtcbiAgZGlzcGxheU5hbWU6IFwiUmVtYXJrPHJlbWFya0lubGluZUxpbmtQbHVnaW4+XCIsXG4gIGdyb3VwOiBcIlJlbWFya1wiXG59KTtcbndpdGhNZXRhKHJlbWFya0lubGluZUxpbmtQbHVnaW4ub3B0aW9ucywge1xuICBkaXNwbGF5TmFtZTogXCJSZW1hcmtDb25maWc8cmVtYXJrSW5saW5lTGlua1BsdWdpbj5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xuY29uc3QgaXNQYXJlbnQgPSAobm9kZSkgPT4gISFub2RlLmNoaWxkcmVuO1xuY29uc3QgaXNIVE1MID0gKG5vZGUpID0+IG5vZGUudHlwZSA9PT0gXCJodG1sXCI7XG5mdW5jdGlvbiBmbGF0TWFwV2l0aERlcHRoKGFzdCwgZm4pIHtcbiAgcmV0dXJuIHRyYW5zZm9ybShhc3QsIDAsIG51bGwpWzBdO1xuICBmdW5jdGlvbiB0cmFuc2Zvcm0obm9kZSwgaW5kZXgsIHBhcmVudCkge1xuICAgIGlmIChpc1BhcmVudChub2RlKSkge1xuICAgICAgY29uc3Qgb3V0ID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMCwgbiA9IG5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG50aENoaWxkID0gbm9kZS5jaGlsZHJlbltpXTtcbiAgICAgICAgaWYgKG50aENoaWxkKSB7XG4gICAgICAgICAgY29uc3QgeHMgPSB0cmFuc2Zvcm0obnRoQ2hpbGQsIGksIG5vZGUpO1xuICAgICAgICAgIGlmICh4cykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIG0gPSB4cy5sZW5ndGg7IGogPCBtOyBqKyspIHtcbiAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHhzW2pdO1xuICAgICAgICAgICAgICBpZiAoaXRlbSkgb3V0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBub2RlLmNoaWxkcmVuID0gb3V0O1xuICAgIH1cbiAgICByZXR1cm4gZm4obm9kZSwgaW5kZXgsIHBhcmVudCk7XG4gIH1cbn1cbmNvbnN0IHJlbWFya0h0bWxUcmFuc2Zvcm1lciA9ICRyZW1hcmsoXG4gIFwicmVtYXJrSFRNTFRyYW5zZm9ybWVyXCIsXG4gICgpID0+ICgpID0+ICh0cmVlKSA9PiB7XG4gICAgZmxhdE1hcFdpdGhEZXB0aCh0cmVlLCAobm9kZSwgX2luZGV4LCBwYXJlbnQpID0+IHtcbiAgICAgIGlmICghaXNIVE1MKG5vZGUpKSByZXR1cm4gW25vZGVdO1xuICAgICAgaWYgKChwYXJlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IHBhcmVudC50eXBlKSA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgbm9kZS5jaGlsZHJlbiA9IFt7IC4uLm5vZGUgfV07XG4gICAgICAgIGRlbGV0ZSBub2RlLnZhbHVlO1xuICAgICAgICBub2RlLnR5cGUgPSBcInBhcmFncmFwaFwiO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtub2RlXTtcbiAgICB9KTtcbiAgfVxuKTtcbndpdGhNZXRhKHJlbWFya0h0bWxUcmFuc2Zvcm1lci5wbHVnaW4sIHtcbiAgZGlzcGxheU5hbWU6IFwiUmVtYXJrPHJlbWFya0h0bWxUcmFuc2Zvcm1lcj5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xud2l0aE1ldGEocmVtYXJrSHRtbFRyYW5zZm9ybWVyLm9wdGlvbnMsIHtcbiAgZGlzcGxheU5hbWU6IFwiUmVtYXJrQ29uZmlnPHJlbWFya0h0bWxUcmFuc2Zvcm1lcj5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xuY29uc3QgcmVtYXJrTWFya2VyID0gJHJlbWFyayhcbiAgXCJyZW1hcmtNYXJrZXJcIixcbiAgKCkgPT4gKCkgPT4gKHRyZWUsIGZpbGUpID0+IHtcbiAgICBjb25zdCBnZXRNYXJrZXIgPSAobm9kZSkgPT4ge1xuICAgICAgcmV0dXJuIGZpbGUudmFsdWUuY2hhckF0KG5vZGUucG9zaXRpb24uc3RhcnQub2Zmc2V0KTtcbiAgICB9O1xuICAgIHZpc2l0KFxuICAgICAgdHJlZSxcbiAgICAgIChub2RlKSA9PiBbXCJzdHJvbmdcIiwgXCJlbXBoYXNpc1wiXS5pbmNsdWRlcyhub2RlLnR5cGUpLFxuICAgICAgKG5vZGUpID0+IHtcbiAgICAgICAgbm9kZS5tYXJrZXIgPSBnZXRNYXJrZXIobm9kZSk7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuKTtcbndpdGhNZXRhKHJlbWFya01hcmtlci5wbHVnaW4sIHtcbiAgZGlzcGxheU5hbWU6IFwiUmVtYXJrPHJlbWFya01hcmtlcj5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xud2l0aE1ldGEocmVtYXJrTWFya2VyLm9wdGlvbnMsIHtcbiAgZGlzcGxheU5hbWU6IFwiUmVtYXJrQ29uZmlnPHJlbWFya01hcmtlcj5cIixcbiAgZ3JvdXA6IFwiUmVtYXJrXCJcbn0pO1xuY29uc3QgaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4gPSAkcHJvc2UoKCkgPT4ge1xuICBsZXQgbG9jayA9IGZhbHNlO1xuICBjb25zdCBpbmxpbmVOb2Rlc0N1cnNvclBsdWdpbktleSA9IG5ldyBQbHVnaW5LZXkoXG4gICAgXCJNSUxLRE9XTl9JTkxJTkVfTk9ERVNfQ1VSU09SXCJcbiAgKTtcbiAgY29uc3QgaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4yID0gbmV3IFBsdWdpbih7XG4gICAga2V5OiBpbmxpbmVOb2Rlc0N1cnNvclBsdWdpbktleSxcbiAgICBzdGF0ZToge1xuICAgICAgaW5pdCgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSxcbiAgICAgIGFwcGx5KHRyKSB7XG4gICAgICAgIGlmICghdHIuc2VsZWN0aW9uLmVtcHR5KSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IHBvcyA9IHRyLnNlbGVjdGlvbi4kZnJvbTtcbiAgICAgICAgY29uc3QgbGVmdCA9IHBvcy5ub2RlQmVmb3JlO1xuICAgICAgICBjb25zdCByaWdodCA9IHBvcy5ub2RlQWZ0ZXI7XG4gICAgICAgIGlmIChsZWZ0ICYmIHJpZ2h0ICYmIGxlZnQuaXNJbmxpbmUgJiYgIWxlZnQuaXNUZXh0ICYmIHJpZ2h0LmlzSW5saW5lICYmICFyaWdodC5pc1RleHQpXG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHByb3BzOiB7XG4gICAgICBoYW5kbGVET01FdmVudHM6IHtcbiAgICAgICAgY29tcG9zaXRpb25lbmQ6ICh2aWV3LCBlKSA9PiB7XG4gICAgICAgICAgaWYgKGxvY2spIHtcbiAgICAgICAgICAgIGxvY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZSA9IGlubGluZU5vZGVzQ3Vyc29yUGx1Z2luMi5nZXRTdGF0ZSh2aWV3LnN0YXRlKTtcbiAgICAgICAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZyb20gPSB2aWV3LnN0YXRlLnNlbGVjdGlvbi5mcm9tO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB2aWV3LmRpc3BhdGNoKHZpZXcuc3RhdGUudHIuaW5zZXJ0VGV4dChlLmRhdGEgfHwgXCJcIiwgZnJvbSkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBvc2l0aW9uc3RhcnQ6ICh2aWV3KSA9PiB7XG4gICAgICAgICAgY29uc3QgYWN0aXZlID0gaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4yLmdldFN0YXRlKHZpZXcuc3RhdGUpO1xuICAgICAgICAgIGlmIChhY3RpdmUpIGxvY2sgPSB0cnVlO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgYmVmb3JlaW5wdXQ6ICh2aWV3LCBlKSA9PiB7XG4gICAgICAgICAgY29uc3QgYWN0aXZlID0gaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4yLmdldFN0YXRlKHZpZXcuc3RhdGUpO1xuICAgICAgICAgIGlmIChhY3RpdmUgJiYgZSBpbnN0YW5jZW9mIElucHV0RXZlbnQgJiYgZS5kYXRhICYmICFsb2NrKSB7XG4gICAgICAgICAgICBjb25zdCBmcm9tID0gdmlldy5zdGF0ZS5zZWxlY3Rpb24uZnJvbTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZpZXcuZGlzcGF0Y2godmlldy5zdGF0ZS50ci5pbnNlcnRUZXh0KGUuZGF0YSB8fCBcIlwiLCBmcm9tKSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVjb3JhdGlvbnMoc3RhdGUpIHtcbiAgICAgICAgY29uc3QgYWN0aXZlID0gaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4yLmdldFN0YXRlKHN0YXRlKTtcbiAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgIGNvbnN0IHBvcyA9IHN0YXRlLnNlbGVjdGlvbi4kZnJvbTtcbiAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHBvcy5wb3M7XG4gICAgICAgICAgY29uc3QgbGVmdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgICAgICAgIGNvbnN0IGxlZnREZWMgPSBEZWNvcmF0aW9uLndpZGdldChwb3NpdGlvbiwgbGVmdCwge1xuICAgICAgICAgICAgc2lkZTogLTFcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCByaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgICAgICAgIGNvbnN0IHJpZ2h0RGVjID0gRGVjb3JhdGlvbi53aWRnZXQocG9zaXRpb24sIHJpZ2h0KTtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGxlZnQuY29udGVudEVkaXRhYmxlID0gXCJ0cnVlXCI7XG4gICAgICAgICAgICByaWdodC5jb250ZW50RWRpdGFibGUgPSBcInRydWVcIjtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gRGVjb3JhdGlvblNldC5jcmVhdGUoc3RhdGUuZG9jLCBbbGVmdERlYywgcmlnaHREZWNdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRGVjb3JhdGlvblNldC5lbXB0eTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4gaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4yO1xufSk7XG53aXRoTWV0YShpbmxpbmVOb2Rlc0N1cnNvclBsdWdpbiwge1xuICBkaXNwbGF5TmFtZTogXCJQcm9zZTxpbmxpbmVOb2Rlc0N1cnNvclBsdWdpbj5cIixcbiAgZ3JvdXA6IFwiUHJvc2VcIlxufSk7XG5jb25zdCBoYXJkYnJlYWtDbGVhck1hcmtQbHVnaW4gPSAkcHJvc2UoKGN0eCkgPT4ge1xuICByZXR1cm4gbmV3IFBsdWdpbih7XG4gICAga2V5OiBuZXcgUGx1Z2luS2V5KFwiTUlMS0RPV05fSEFSREJSRUFLX01BUktTXCIpLFxuICAgIGFwcGVuZFRyYW5zYWN0aW9uOiAodHJzLCBfb2xkU3RhdGUsIG5ld1N0YXRlKSA9PiB7XG4gICAgICBpZiAoIXRycy5sZW5ndGgpIHJldHVybjtcbiAgICAgIGNvbnN0IFt0cl0gPSB0cnM7XG4gICAgICBpZiAoIXRyKSByZXR1cm47XG4gICAgICBjb25zdCBbc3RlcF0gPSB0ci5zdGVwcztcbiAgICAgIGNvbnN0IGlzSW5zZXJ0SHIgPSB0ci5nZXRNZXRhKFwiaGFyZGJyZWFrXCIpO1xuICAgICAgaWYgKGlzSW5zZXJ0SHIpIHtcbiAgICAgICAgaWYgKCEoc3RlcCBpbnN0YW5jZW9mIFJlcGxhY2VTdGVwKSkgcmV0dXJuO1xuICAgICAgICBjb25zdCB7IGZyb20gfSA9IHN0ZXA7XG4gICAgICAgIHJldHVybiBuZXdTdGF0ZS50ci5zZXROb2RlTWFya3VwKFxuICAgICAgICAgIGZyb20sXG4gICAgICAgICAgaGFyZGJyZWFrU2NoZW1hLnR5cGUoY3R4KSxcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgW11cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGlzQWRkTWFya1N0ZXAgPSBzdGVwIGluc3RhbmNlb2YgQWRkTWFya1N0ZXA7XG4gICAgICBpZiAoaXNBZGRNYXJrU3RlcCkge1xuICAgICAgICBsZXQgX3RyID0gbmV3U3RhdGUudHI7XG4gICAgICAgIGNvbnN0IHsgZnJvbSwgdG8gfSA9IHN0ZXA7XG4gICAgICAgIG5ld1N0YXRlLmRvYy5ub2Rlc0JldHdlZW4oZnJvbSwgdG8sIChub2RlLCBwb3MpID0+IHtcbiAgICAgICAgICBpZiAobm9kZS50eXBlID09PSBoYXJkYnJlYWtTY2hlbWEudHlwZShjdHgpKVxuICAgICAgICAgICAgX3RyID0gX3RyLnNldE5vZGVNYXJrdXAoXG4gICAgICAgICAgICAgIHBvcyxcbiAgICAgICAgICAgICAgaGFyZGJyZWFrU2NoZW1hLnR5cGUoY3R4KSxcbiAgICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgICBbXVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfdHI7XG4gICAgICB9XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgfSk7XG59KTtcbndpdGhNZXRhKGhhcmRicmVha0NsZWFyTWFya1BsdWdpbiwge1xuICBkaXNwbGF5TmFtZTogXCJQcm9zZTxoYXJkYnJlYWtDbGVhck1hcmtQbHVnaW4+XCIsXG4gIGdyb3VwOiBcIlByb3NlXCJcbn0pO1xuY29uc3QgaGFyZGJyZWFrRmlsdGVyTm9kZXMgPSAkY3R4KFxuICBbXCJ0YWJsZVwiLCBcImNvZGVfYmxvY2tcIl0sXG4gIFwiaGFyZGJyZWFrRmlsdGVyTm9kZXNcIlxuKTtcbndpdGhNZXRhKGhhcmRicmVha0ZpbHRlck5vZGVzLCB7XG4gIGRpc3BsYXlOYW1lOiBcIkN0eDxoYXJkYnJlYWtGaWx0ZXJOb2Rlcz5cIixcbiAgZ3JvdXA6IFwiUHJvc2VcIlxufSk7XG5jb25zdCBoYXJkYnJlYWtGaWx0ZXJQbHVnaW4gPSAkcHJvc2UoKGN0eCkgPT4ge1xuICBjb25zdCBub3RJbiA9IGN0eC5nZXQoaGFyZGJyZWFrRmlsdGVyTm9kZXMua2V5KTtcbiAgcmV0dXJuIG5ldyBQbHVnaW4oe1xuICAgIGtleTogbmV3IFBsdWdpbktleShcIk1JTEtET1dOX0hBUkRCUkVBS19GSUxURVJcIiksXG4gICAgZmlsdGVyVHJhbnNhY3Rpb246ICh0ciwgc3RhdGUpID0+IHtcbiAgICAgIGNvbnN0IGlzSW5zZXJ0SHIgPSB0ci5nZXRNZXRhKFwiaGFyZGJyZWFrXCIpO1xuICAgICAgY29uc3QgW3N0ZXBdID0gdHIuc3RlcHM7XG4gICAgICBpZiAoaXNJbnNlcnRIciAmJiBzdGVwKSB7XG4gICAgICAgIGNvbnN0IHsgZnJvbSB9ID0gc3RlcDtcbiAgICAgICAgY29uc3QgJGZyb20gPSBzdGF0ZS5kb2MucmVzb2x2ZShmcm9tKTtcbiAgICAgICAgbGV0IGN1ckRlcHRoID0gJGZyb20uZGVwdGg7XG4gICAgICAgIGxldCBjYW5BcHBseSA9IHRydWU7XG4gICAgICAgIHdoaWxlIChjdXJEZXB0aCA+IDApIHtcbiAgICAgICAgICBpZiAobm90SW4uaW5jbHVkZXMoJGZyb20ubm9kZShjdXJEZXB0aCkudHlwZS5uYW1lKSkgY2FuQXBwbHkgPSBmYWxzZTtcbiAgICAgICAgICBjdXJEZXB0aC0tO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYW5BcHBseTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSk7XG59KTtcbndpdGhNZXRhKGhhcmRicmVha0ZpbHRlclBsdWdpbiwge1xuICBkaXNwbGF5TmFtZTogXCJQcm9zZTxoYXJkYnJlYWtGaWx0ZXJQbHVnaW4+XCIsXG4gIGdyb3VwOiBcIlByb3NlXCJcbn0pO1xuY29uc3Qgc3luY0hlYWRpbmdJZFBsdWdpbiA9ICRwcm9zZSgoY3R4KSA9PiB7XG4gIGNvbnN0IGhlYWRpbmdJZFBsdWdpbktleSA9IG5ldyBQbHVnaW5LZXkoXCJNSUxLRE9XTl9IRUFESU5HX0lEXCIpO1xuICBjb25zdCB1cGRhdGVJZCA9ICh2aWV3KSA9PiB7XG4gICAgaWYgKHZpZXcuY29tcG9zaW5nKSByZXR1cm47XG4gICAgY29uc3QgZ2V0SWQgPSBjdHguZ2V0KGhlYWRpbmdJZEdlbmVyYXRvci5rZXkpO1xuICAgIGNvbnN0IHRyID0gdmlldy5zdGF0ZS50ci5zZXRNZXRhKFwiYWRkVG9IaXN0b3J5XCIsIGZhbHNlKTtcbiAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICBjb25zdCBpZE1hcCA9IHt9O1xuICAgIHZpZXcuc3RhdGUuZG9jLmRlc2NlbmRhbnRzKChub2RlLCBwb3MpID0+IHtcbiAgICAgIGlmIChub2RlLnR5cGUgPT09IGhlYWRpbmdTY2hlbWEudHlwZShjdHgpKSB7XG4gICAgICAgIGlmIChub2RlLnRleHRDb250ZW50LnRyaW0oKS5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICAgICAgY29uc3QgYXR0cnMgPSBub2RlLmF0dHJzO1xuICAgICAgICBsZXQgaWQgPSBnZXRJZChub2RlKTtcbiAgICAgICAgaWYgKGlkTWFwW2lkXSkge1xuICAgICAgICAgIGlkTWFwW2lkXSArPSAxO1xuICAgICAgICAgIGlkICs9IGAtIyR7aWRNYXBbaWRdfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWRNYXBbaWRdID0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXR0cnMuaWQgIT09IGlkKSB7XG4gICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgIHRyLnNldE1ldGEoaGVhZGluZ0lkUGx1Z2luS2V5LCB0cnVlKS5zZXROb2RlTWFya3VwKHBvcywgdm9pZCAwLCB7XG4gICAgICAgICAgICAuLi5hdHRycyxcbiAgICAgICAgICAgIGlkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoZm91bmQpIHZpZXcuZGlzcGF0Y2godHIpO1xuICB9O1xuICByZXR1cm4gbmV3IFBsdWdpbih7XG4gICAga2V5OiBoZWFkaW5nSWRQbHVnaW5LZXksXG4gICAgdmlldzogKHZpZXcpID0+IHtcbiAgICAgIHVwZGF0ZUlkKHZpZXcpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXBkYXRlOiAodmlldzIsIHByZXZTdGF0ZSkgPT4ge1xuICAgICAgICAgIGlmICh2aWV3Mi5zdGF0ZS5kb2MuZXEocHJldlN0YXRlLmRvYykpIHJldHVybjtcbiAgICAgICAgICB1cGRhdGVJZCh2aWV3Mik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn0pO1xud2l0aE1ldGEoc3luY0hlYWRpbmdJZFBsdWdpbiwge1xuICBkaXNwbGF5TmFtZTogXCJQcm9zZTxzeW5jSGVhZGluZ0lkUGx1Z2luPlwiLFxuICBncm91cDogXCJQcm9zZVwiXG59KTtcbmNvbnN0IHN5bmNMaXN0T3JkZXJQbHVnaW4gPSAkcHJvc2UoKGN0eCkgPT4ge1xuICBjb25zdCBzeW5jT3JkZXJMYWJlbCA9ICh2aWV3KSA9PiB7XG4gICAgaWYgKHZpZXcuY29tcG9zaW5nIHx8ICF2aWV3LmVkaXRhYmxlKSByZXR1cm47XG4gICAgY29uc3Qgb3JkZXJlZExpc3RUeXBlID0gb3JkZXJlZExpc3RTY2hlbWEudHlwZShjdHgpO1xuICAgIGNvbnN0IGJ1bGxldExpc3RUeXBlID0gYnVsbGV0TGlzdFNjaGVtYS50eXBlKGN0eCk7XG4gICAgY29uc3QgbGlzdEl0ZW1UeXBlID0gbGlzdEl0ZW1TY2hlbWEudHlwZShjdHgpO1xuICAgIGNvbnN0IHN0YXRlID0gdmlldy5zdGF0ZTtcbiAgICBjb25zdCBoYW5kbGVOb2RlSXRlbSA9IChhdHRycywgaW5kZXgpID0+IHtcbiAgICAgIGxldCBjaGFuZ2VkID0gZmFsc2U7XG4gICAgICBjb25zdCBleHBlY3RlZExhYmVsID0gYCR7aW5kZXggKyAxfS5gO1xuICAgICAgaWYgKGF0dHJzLmxhYmVsICE9PSBleHBlY3RlZExhYmVsKSB7XG4gICAgICAgIGF0dHJzLmxhYmVsID0gZXhwZWN0ZWRMYWJlbDtcbiAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gY2hhbmdlZDtcbiAgICB9O1xuICAgIGxldCB0ciA9IHN0YXRlLnRyO1xuICAgIGxldCBuZWVkRGlzcGF0Y2ggPSBmYWxzZTtcbiAgICBzdGF0ZS5kb2MuZGVzY2VuZGFudHMoKG5vZGUsIHBvcywgcGFyZW50LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKG5vZGUudHlwZSA9PT0gYnVsbGV0TGlzdFR5cGUpIHtcbiAgICAgICAgY29uc3QgYmFzZSA9IG5vZGUubWF5YmVDaGlsZCgwKTtcbiAgICAgICAgaWYgKChiYXNlID09IG51bGwgPyB2b2lkIDAgOiBiYXNlLnR5cGUpID09PSBsaXN0SXRlbVR5cGUgJiYgYmFzZS5hdHRycy5saXN0VHlwZSA9PT0gXCJvcmRlcmVkXCIpIHtcbiAgICAgICAgICBuZWVkRGlzcGF0Y2ggPSB0cnVlO1xuICAgICAgICAgIHRyLnNldE5vZGVNYXJrdXAocG9zLCBvcmRlcmVkTGlzdFR5cGUsIHsgc3ByZWFkOiBcInRydWVcIiB9KTtcbiAgICAgICAgICBub2RlLmRlc2NlbmRhbnRzKChjaGlsZCwgcG9zMiwgX3BhcmVudCwgaW5kZXgyKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gbGlzdEl0ZW1UeXBlKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGF0dHJzID0geyAuLi5jaGlsZC5hdHRycyB9O1xuICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VkID0gaGFuZGxlTm9kZUl0ZW0oYXR0cnMsIGluZGV4Mik7XG4gICAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB0ciA9IHRyLnNldE5vZGVNYXJrdXAocG9zMiwgdm9pZCAwLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobm9kZS50eXBlID09PSBsaXN0SXRlbVR5cGUgJiYgKHBhcmVudCA9PSBudWxsID8gdm9pZCAwIDogcGFyZW50LnR5cGUpID09PSBvcmRlcmVkTGlzdFR5cGUpIHtcbiAgICAgICAgY29uc3QgYXR0cnMgPSB7IC4uLm5vZGUuYXR0cnMgfTtcbiAgICAgICAgbGV0IGNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGF0dHJzLmxpc3RUeXBlICE9PSBcIm9yZGVyZWRcIikge1xuICAgICAgICAgIGF0dHJzLmxpc3RUeXBlID0gXCJvcmRlcmVkXCI7XG4gICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYmFzZSA9IHBhcmVudCA9PSBudWxsID8gdm9pZCAwIDogcGFyZW50Lm1heWJlQ2hpbGQoMCk7XG4gICAgICAgIGlmIChiYXNlKSBjaGFuZ2VkID0gaGFuZGxlTm9kZUl0ZW0oYXR0cnMsIGluZGV4KTtcbiAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICB0ciA9IHRyLnNldE5vZGVNYXJrdXAocG9zLCB2b2lkIDAsIGF0dHJzKTtcbiAgICAgICAgICBuZWVkRGlzcGF0Y2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKG5lZWREaXNwYXRjaCkgdmlldy5kaXNwYXRjaCh0ci5zZXRNZXRhKFwiYWRkVG9IaXN0b3J5XCIsIGZhbHNlKSk7XG4gIH07XG4gIHJldHVybiBuZXcgUGx1Z2luKHtcbiAgICBrZXk6IG5ldyBQbHVnaW5LZXkoXCJNSUxLRE9XTl9LRUVQX0xJU1RfT1JERVJcIiksXG4gICAgdmlldzogKHZpZXcpID0+IHtcbiAgICAgIHN5bmNPcmRlckxhYmVsKHZpZXcpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXBkYXRlOiAodmlldzIpID0+IHtcbiAgICAgICAgICBzeW5jT3JkZXJMYWJlbCh2aWV3Mik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn0pO1xud2l0aE1ldGEoc3luY0xpc3RPcmRlclBsdWdpbiwge1xuICBkaXNwbGF5TmFtZTogXCJQcm9zZTxzeW5jTGlzdE9yZGVyUGx1Z2luPlwiLFxuICBncm91cDogXCJQcm9zZVwiXG59KTtcbmNvbnN0IHBsdWdpbnMgPSBbXG4gIGhhcmRicmVha0NsZWFyTWFya1BsdWdpbixcbiAgaGFyZGJyZWFrRmlsdGVyTm9kZXMsXG4gIGhhcmRicmVha0ZpbHRlclBsdWdpbixcbiAgaW5saW5lTm9kZXNDdXJzb3JQbHVnaW4sXG4gIHJlbWFya0FkZE9yZGVySW5MaXN0UGx1Z2luLFxuICByZW1hcmtJbmxpbmVMaW5rUGx1Z2luLFxuICByZW1hcmtMaW5lQnJlYWssXG4gIHJlbWFya0h0bWxUcmFuc2Zvcm1lcixcbiAgcmVtYXJrTWFya2VyLFxuICByZW1hcmtQcmVzZXJ2ZUVtcHR5TGluZVBsdWdpbixcbiAgc3luY0hlYWRpbmdJZFBsdWdpbixcbiAgc3luY0xpc3RPcmRlclBsdWdpblxuXS5mbGF0KCk7XG5jb25zdCBjb21tb25tYXJrID0gW1xuICBzY2hlbWEsXG4gIGlucHV0UnVsZXMsXG4gIG1hcmtJbnB1dFJ1bGVzLFxuICBjb21tYW5kcyxcbiAga2V5bWFwLFxuICBwbHVnaW5zXG5dLmZsYXQoKTtcbmV4cG9ydCB7XG4gIGJsb2NrcXVvdGVBdHRyLFxuICBibG9ja3F1b3RlS2V5bWFwLFxuICBibG9ja3F1b3RlU2NoZW1hLFxuICBidWxsZXRMaXN0QXR0cixcbiAgYnVsbGV0TGlzdEtleW1hcCxcbiAgYnVsbGV0TGlzdFNjaGVtYSxcbiAgY29kZUJsb2NrQXR0cixcbiAgY29kZUJsb2NrS2V5bWFwLFxuICBjb2RlQmxvY2tTY2hlbWEsXG4gIGNvbW1hbmRzLFxuICBjb21tb25tYXJrLFxuICBjcmVhdGVDb2RlQmxvY2tDb21tYW5kLFxuICBjcmVhdGVDb2RlQmxvY2tJbnB1dFJ1bGUsXG4gIGRvY1NjaGVtYSxcbiAgZG93bmdyYWRlSGVhZGluZ0NvbW1hbmQsXG4gIGVtcGhhc2lzQXR0cixcbiAgZW1waGFzaXNLZXltYXAsXG4gIGVtcGhhc2lzU2NoZW1hLFxuICBlbXBoYXNpc1N0YXJJbnB1dFJ1bGUsXG4gIGVtcGhhc2lzVW5kZXJzY29yZUlucHV0UnVsZSxcbiAgaGFyZGJyZWFrQXR0cixcbiAgaGFyZGJyZWFrQ2xlYXJNYXJrUGx1Z2luLFxuICBoYXJkYnJlYWtGaWx0ZXJOb2RlcyxcbiAgaGFyZGJyZWFrRmlsdGVyUGx1Z2luLFxuICBoYXJkYnJlYWtLZXltYXAsXG4gIGhhcmRicmVha1NjaGVtYSxcbiAgaGVhZGluZ0F0dHIsXG4gIGhlYWRpbmdJZEdlbmVyYXRvcixcbiAgaGVhZGluZ0tleW1hcCxcbiAgaGVhZGluZ1NjaGVtYSxcbiAgaHJBdHRyLFxuICBoclNjaGVtYSxcbiAgaHRtbEF0dHIsXG4gIGh0bWxTY2hlbWEsXG4gIGltYWdlQXR0cixcbiAgaW1hZ2VTY2hlbWEsXG4gIGlubGluZUNvZGVBdHRyLFxuICBpbmxpbmVDb2RlSW5wdXRSdWxlLFxuICBpbmxpbmVDb2RlS2V5bWFwLFxuICBpbmxpbmVDb2RlU2NoZW1hLFxuICBpbmxpbmVOb2Rlc0N1cnNvclBsdWdpbixcbiAgaW5wdXRSdWxlcyxcbiAgaW5zZXJ0SGFyZGJyZWFrQ29tbWFuZCxcbiAgaW5zZXJ0SHJDb21tYW5kLFxuICBpbnNlcnRIcklucHV0UnVsZSxcbiAgaW5zZXJ0SW1hZ2VDb21tYW5kLFxuICBpbnNlcnRJbWFnZUlucHV0UnVsZSxcbiAga2V5bWFwLFxuICBsaWZ0Rmlyc3RMaXN0SXRlbUNvbW1hbmQsXG4gIGxpZnRMaXN0SXRlbUNvbW1hbmQsXG4gIGxpbmtBdHRyLFxuICBsaW5rU2NoZW1hLFxuICBsaXN0SXRlbUF0dHIsXG4gIGxpc3RJdGVtS2V5bWFwLFxuICBsaXN0SXRlbVNjaGVtYSxcbiAgbWFya0lucHV0UnVsZXMsXG4gIG9yZGVyZWRMaXN0QXR0cixcbiAgb3JkZXJlZExpc3RLZXltYXAsXG4gIG9yZGVyZWRMaXN0U2NoZW1hLFxuICBwYXJhZ3JhcGhBdHRyLFxuICBwYXJhZ3JhcGhLZXltYXAsXG4gIHBhcmFncmFwaFNjaGVtYSxcbiAgcGx1Z2lucyxcbiAgcmVtYXJrQWRkT3JkZXJJbkxpc3RQbHVnaW4sXG4gIHJlbWFya0h0bWxUcmFuc2Zvcm1lcixcbiAgcmVtYXJrSW5saW5lTGlua1BsdWdpbixcbiAgcmVtYXJrTGluZUJyZWFrLFxuICByZW1hcmtNYXJrZXIsXG4gIHJlbWFya1ByZXNlcnZlRW1wdHlMaW5lUGx1Z2luLFxuICBzY2hlbWEsXG4gIHNpbmtMaXN0SXRlbUNvbW1hbmQsXG4gIHNwbGl0TGlzdEl0ZW1Db21tYW5kLFxuICBzdHJvbmdBdHRyLFxuICBzdHJvbmdJbnB1dFJ1bGUsXG4gIHN0cm9uZ0tleW1hcCxcbiAgc3Ryb25nU2NoZW1hLFxuICBzeW5jSGVhZGluZ0lkUGx1Z2luLFxuICBzeW5jTGlzdE9yZGVyUGx1Z2luLFxuICB0ZXh0U2NoZW1hLFxuICB0b2dnbGVFbXBoYXNpc0NvbW1hbmQsXG4gIHRvZ2dsZUlubGluZUNvZGVDb21tYW5kLFxuICB0b2dnbGVMaW5rQ29tbWFuZCxcbiAgdG9nZ2xlU3Ryb25nQ29tbWFuZCxcbiAgdHVybkludG9UZXh0Q29tbWFuZCxcbiAgdXBkYXRlQ29kZUJsb2NrTGFuZ3VhZ2VDb21tYW5kLFxuICB1cGRhdGVJbWFnZUNvbW1hbmQsXG4gIHVwZGF0ZUxpbmtDb21tYW5kLFxuICB3cmFwSW5CbG9ja3F1b3RlQ29tbWFuZCxcbiAgd3JhcEluQmxvY2txdW90ZUlucHV0UnVsZSxcbiAgd3JhcEluQnVsbGV0TGlzdENvbW1hbmQsXG4gIHdyYXBJbkJ1bGxldExpc3RJbnB1dFJ1bGUsXG4gIHdyYXBJbkhlYWRpbmdDb21tYW5kLFxuICB3cmFwSW5IZWFkaW5nSW5wdXRSdWxlLFxuICB3cmFwSW5PcmRlcmVkTGlzdENvbW1hbmQsXG4gIHdyYXBJbk9yZGVyZWRMaXN0SW5wdXRSdWxlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/preset-commonmark/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/prose/lib/index.js":
/*!***************************************************!*\
  !*** ./node_modules/@milkdown/prose/lib/index.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   browser: () => (/* binding */ browser),\n/* harmony export */   calculateNodePosition: () => (/* binding */ calculateNodePosition),\n/* harmony export */   calculateTextPosition: () => (/* binding */ calculateTextPosition),\n/* harmony export */   cloneTr: () => (/* binding */ cloneTr),\n/* harmony export */   customInputRules: () => (/* binding */ customInputRules),\n/* harmony export */   customInputRulesKey: () => (/* binding */ customInputRulesKey),\n/* harmony export */   equalNodeType: () => (/* binding */ equalNodeType),\n/* harmony export */   findChildren: () => (/* binding */ findChildren),\n/* harmony export */   findChildrenByMark: () => (/* binding */ findChildrenByMark),\n/* harmony export */   findParent: () => (/* binding */ findParent),\n/* harmony export */   findParentNode: () => (/* binding */ findParentNode),\n/* harmony export */   findParentNodeClosestToPos: () => (/* binding */ findParentNodeClosestToPos),\n/* harmony export */   findParentNodeType: () => (/* binding */ findParentNodeType),\n/* harmony export */   findSelectedNodeOfType: () => (/* binding */ findSelectedNodeOfType),\n/* harmony export */   flatten: () => (/* binding */ flatten),\n/* harmony export */   getMarkFromSchema: () => (/* binding */ getMarkFromSchema),\n/* harmony export */   getNodeFromSchema: () => (/* binding */ getNodeFromSchema),\n/* harmony export */   markRule: () => (/* binding */ markRule),\n/* harmony export */   nodeRule: () => (/* binding */ nodeRule),\n/* harmony export */   posToDOMRect: () => (/* binding */ posToDOMRect)\n/* harmony export */ });\n/* harmony import */ var prosemirror_state__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! prosemirror-state */ \"(ssr)/./node_modules/prosemirror-state/dist/index.js\");\n/* harmony import */ var prosemirror_inputrules__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prosemirror-inputrules */ \"(ssr)/./node_modules/prosemirror-inputrules/dist/index.js\");\n/* harmony import */ var _milkdown_exception__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @milkdown/exception */ \"(ssr)/./node_modules/@milkdown/exception/lib/index.js\");\n\n\n\n\nconst nav = typeof navigator != \"undefined\" ? navigator : null;\nconst doc = typeof document != \"undefined\" ? document : null;\nconst agent = nav && nav.userAgent || \"\";\nconst ie_edge = /Edge\\/(\\d+)/.exec(agent);\nconst ie_upto10 = /MSIE \\d/.exec(agent);\nconst ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(agent);\nconst ie = !!(ie_upto10 || ie_11up || ie_edge);\nconst ie_version = ie_upto10 ? document.documentMode : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : 0;\nconst gecko = !ie && /gecko\\/(\\d+)/i.test(agent);\nconst gecko_version = gecko && +(/Firefox\\/(\\d+)/.exec(agent) || [0, 0])[1];\nconst _chrome = !ie && /Chrome\\/(\\d+)/.exec(agent);\nconst chrome = !!_chrome;\nconst chrome_version = _chrome ? +_chrome[1] : 0;\nconst safari = !ie && !!nav && /Apple Computer/.test(nav.vendor);\nconst ios = safari && (/Mobile\\/\\w+/.test(agent) || !!nav && nav.maxTouchPoints > 2);\nconst mac = ios || (nav ? /Mac/.test(nav.platform) : false);\nconst android = /Android \\d/.test(agent);\nconst webkit = !!doc && \"webkitFontSmoothing\" in doc.documentElement.style;\nconst webkit_version = webkit ? +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1] : 0;\n\nvar browser = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  android: android,\n  chrome: chrome,\n  chrome_version: chrome_version,\n  gecko: gecko,\n  gecko_version: gecko_version,\n  ie: ie,\n  ie_version: ie_version,\n  ios: ios,\n  mac: mac,\n  safari: safari,\n  webkit: webkit,\n  webkit_version: webkit_version\n});\n\nfunction run(view, from, to, text, rules, plugin) {\n  if (view.composing) return false;\n  const state = view.state;\n  const $from = state.doc.resolve(from);\n  if ($from.parent.type.spec.code) return false;\n  const textBefore = $from.parent.textBetween(\n    Math.max(0, $from.parentOffset - 500),\n    $from.parentOffset,\n    void 0,\n    \"\\uFFFC\"\n  ) + text;\n  for (let _matcher of rules) {\n    const matcher = _matcher;\n    const match = matcher.match.exec(textBefore);\n    const tr = match && match[0] && matcher.handler(state, match, from - (match[0].length - text.length), to);\n    if (!tr) continue;\n    if (matcher.undoable !== false)\n      tr.setMeta(plugin, { transform: tr, from, to, text });\n    view.dispatch(tr);\n    return true;\n  }\n  return false;\n}\nconst customInputRulesKey = new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.PluginKey(\"MILKDOWN_CUSTOM_INPUTRULES\");\nfunction customInputRules({ rules }) {\n  const plugin = new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.Plugin({\n    key: customInputRulesKey,\n    isInputRules: true,\n    state: {\n      init() {\n        return null;\n      },\n      apply(tr, prev) {\n        const stored = tr.getMeta(this);\n        if (stored) return stored;\n        return tr.selectionSet || tr.docChanged ? null : prev;\n      }\n    },\n    props: {\n      handleTextInput(view, from, to, text) {\n        return run(view, from, to, text, rules, plugin);\n      },\n      handleDOMEvents: {\n        compositionend: (view) => {\n          setTimeout(() => {\n            const { $cursor } = view.state.selection;\n            if ($cursor) run(view, $cursor.pos, $cursor.pos, \"\", rules, plugin);\n          });\n          return false;\n        }\n      },\n      handleKeyDown(view, event) {\n        if (event.key !== \"Enter\") return false;\n        const { $cursor } = view.state.selection;\n        if ($cursor)\n          return run(view, $cursor.pos, $cursor.pos, \"\\n\", rules, plugin);\n        return false;\n      }\n    }\n  });\n  return plugin;\n}\n\nfunction markRule(regexp, markType, options = {}) {\n  return new prosemirror_inputrules__WEBPACK_IMPORTED_MODULE_1__.InputRule(regexp, (state, match, start, end) => {\n    var _a, _b, _c, _d;\n    const { tr } = state;\n    const matchLength = match.length;\n    let group = match[matchLength - 1];\n    let fullMatch = match[0];\n    let initialStoredMarks = [];\n    let markEnd = end;\n    const captured = {\n      group,\n      fullMatch,\n      start,\n      end\n    };\n    const result = (_a = options.updateCaptured) == null ? void 0 : _a.call(options, captured);\n    Object.assign(captured, result);\n    ({ group, fullMatch, start, end } = captured);\n    if (fullMatch === null) return null;\n    if ((group == null ? void 0 : group.trim()) === \"\") return null;\n    if (group) {\n      const startSpaces = fullMatch.search(/\\S/);\n      const textStart = start + fullMatch.indexOf(group);\n      const textEnd = textStart + group.length;\n      initialStoredMarks = (_b = tr.storedMarks) != null ? _b : [];\n      if (textEnd < end) tr.delete(textEnd, end);\n      if (textStart > start) tr.delete(start + startSpaces, textStart);\n      markEnd = start + startSpaces + group.length;\n      const attrs = (_c = options.getAttr) == null ? void 0 : _c.call(options, match);\n      tr.addMark(start, markEnd, markType.create(attrs));\n      tr.setStoredMarks(initialStoredMarks);\n      (_d = options.beforeDispatch) == null ? void 0 : _d.call(options, { match, start, end, tr });\n    }\n    return tr;\n  });\n}\n\nfunction nodeRule(regexp, nodeType, options = {}) {\n  return new prosemirror_inputrules__WEBPACK_IMPORTED_MODULE_1__.InputRule(regexp, (state, match, start, end) => {\n    var _a, _b, _c;\n    const { tr } = state;\n    let group = match[1];\n    let fullMatch = match[0];\n    const captured = {\n      group,\n      fullMatch,\n      start,\n      end\n    };\n    const result = (_a = options.updateCaptured) == null ? void 0 : _a.call(options, captured);\n    Object.assign(captured, result);\n    ({ group, fullMatch, start, end } = captured);\n    if (fullMatch === null) return null;\n    if (!group || group.trim() === \"\") return null;\n    const attrs = (_b = options.getAttr) == null ? void 0 : _b.call(options, match);\n    const node = nodeType.createAndFill(attrs);\n    if (node) {\n      tr.replaceRangeWith(\n        nodeType.isBlock ? tr.doc.resolve(start).before() : start,\n        end,\n        node\n      );\n      (_c = options.beforeDispatch) == null ? void 0 : _c.call(options, {\n        match: [fullMatch, group != null ? group : \"\"],\n        start,\n        end,\n        tr\n      });\n    }\n    return tr;\n  });\n}\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nfunction calculateNodePosition(view, target, handler) {\n  const state = view.state;\n  const { from } = state.selection;\n  const { node } = view.domAtPos(from);\n  const element = node instanceof Text ? node.parentElement : node;\n  if (!(element instanceof HTMLElement)) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__.expectDomTypeError)(element);\n  const selectedNodeRect = element.getBoundingClientRect();\n  const targetNodeRect = target.getBoundingClientRect();\n  const parent = target.parentElement;\n  if (!parent) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__.expectDomTypeError)(parent);\n  const parentNodeRect = parent.getBoundingClientRect();\n  const [top, left] = handler(selectedNodeRect, targetNodeRect, parentNodeRect);\n  target.style.top = `${top}px`;\n  target.style.left = `${left}px`;\n}\nfunction calculateTextPosition(view, target, handler) {\n  const state = view.state;\n  const { from, to } = state.selection;\n  const start = view.coordsAtPos(from);\n  const end = view.coordsAtPos(to);\n  const targetNodeRect = target.getBoundingClientRect();\n  const parent = target.parentElement;\n  if (!parent) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__.missingRootElement)();\n  const parentNodeRect = parent.getBoundingClientRect();\n  const [top, left] = handler(start, end, targetNodeRect, parentNodeRect);\n  target.style.top = `${top}px`;\n  target.style.left = `${left}px`;\n}\nfunction minMax(value = 0, min = 0, max = 0) {\n  return Math.min(Math.max(value, min), max);\n}\nfunction posToDOMRect(view, from, to) {\n  const minPos = 0;\n  const maxPos = view.state.doc.content.size;\n  const resolvedFrom = minMax(from, minPos, maxPos);\n  const resolvedEnd = minMax(to, minPos, maxPos);\n  const start = view.coordsAtPos(resolvedFrom);\n  const end = view.coordsAtPos(resolvedEnd, -1);\n  const top = Math.min(start.top, end.top);\n  const bottom = Math.max(start.bottom, end.bottom);\n  const left = Math.min(start.left, end.left);\n  const right = Math.max(start.right, end.right);\n  const width = right - left;\n  const height = bottom - top;\n  const x = left;\n  const y = top;\n  const data = {\n    top,\n    bottom,\n    left,\n    right,\n    width,\n    height,\n    x,\n    y\n  };\n  return __spreadProps(__spreadValues({}, data), {\n    toJSON: () => data\n  });\n}\n\nfunction cloneTr(tr) {\n  return Object.assign(Object.create(tr), tr).setTime(Date.now());\n}\nfunction equalNodeType(nodeType, node) {\n  return Array.isArray(nodeType) && nodeType.includes(node.type) || node.type === nodeType;\n}\n\nfunction flatten(node, descend = true) {\n  const result = [];\n  node.descendants((child, pos) => {\n    result.push({ node: child, pos });\n    if (!descend) return false;\n    return void 0;\n  });\n  return result;\n}\nfunction findChildren(predicate) {\n  return (node, descend) => flatten(node, descend).filter((child) => predicate(child.node));\n}\nfunction findChildrenByMark(node, markType, descend) {\n  return findChildren((child) => Boolean(markType.isInSet(child.marks)))(\n    node,\n    descend\n  );\n}\nfunction findParent(predicate) {\n  return ($pos) => {\n    for (let depth = $pos.depth; depth > 0; depth -= 1) {\n      const node = $pos.node(depth);\n      if (predicate(node)) {\n        const from = $pos.before(depth);\n        const to = $pos.after(depth);\n        return {\n          from,\n          to,\n          node\n        };\n      }\n    }\n    return void 0;\n  };\n}\nfunction findParentNodeType($pos, nodeType) {\n  return findParent((node) => node.type === nodeType)($pos);\n}\n\nfunction getNodeFromSchema(type, schema) {\n  const target = schema.nodes[type];\n  if (!target) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__.getAtomFromSchemaFail)(\"node\", type);\n  return target;\n}\nfunction getMarkFromSchema(type, schema) {\n  const target = schema.marks[type];\n  if (!target) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_2__.getAtomFromSchemaFail)(\"mark\", type);\n  return target;\n}\n\nfunction findParentNodeClosestToPos(predicate) {\n  return ($pos) => {\n    for (let i = $pos.depth; i > 0; i--) {\n      const node = $pos.node(i);\n      if (predicate(node)) {\n        return {\n          pos: i > 0 ? $pos.before(i) : 0,\n          start: $pos.start(i),\n          depth: i,\n          node\n        };\n      }\n    }\n    return void 0;\n  };\n}\nfunction findParentNode(predicate) {\n  return (selection) => {\n    return findParentNodeClosestToPos(predicate)(selection.$from);\n  };\n}\nfunction findSelectedNodeOfType(selection, nodeType) {\n  if (!(selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.NodeSelection)) return;\n  const { node, $from } = selection;\n  if (equalNodeType(nodeType, node))\n    return {\n      node,\n      pos: $from.pos,\n      start: $from.start($from.depth),\n      depth: $from.depth\n    };\n  return void 0;\n}\n\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3Byb3NlL2xpYi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRTtBQUNsQjtBQUNpRDs7QUFFcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxHQUFHO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsK0JBQStCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msd0RBQVM7QUFDekMsNEJBQTRCLE9BQU87QUFDbkMscUJBQXFCLHFEQUFNO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUI7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBLGdEQUFnRDtBQUNoRCxhQUFhLDZEQUFTO0FBQ3RCO0FBQ0EsWUFBWSxLQUFLO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTywrQkFBK0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsdUJBQXVCO0FBQ2pHO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUEsZ0RBQWdEO0FBQ2hELGFBQWEsNkRBQVM7QUFDdEI7QUFDQSxZQUFZLEtBQUs7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLCtCQUErQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RUFBOEUsNkRBQTZEO0FBQzNJO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsT0FBTztBQUNqQixVQUFVLE9BQU87QUFDakI7QUFDQSwrQ0FBK0MsdUVBQWtCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix1RUFBa0I7QUFDdkM7QUFDQTtBQUNBLHdCQUF3QixJQUFJO0FBQzVCLHlCQUF5QixLQUFLO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLFVBQVUsV0FBVztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix1RUFBa0I7QUFDdkM7QUFDQTtBQUNBLHdCQUF3QixJQUFJO0FBQzVCLHlCQUF5QixLQUFLO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixrQkFBa0I7QUFDcEM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxXQUFXO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFCQUFxQiwwRUFBcUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsMEVBQXFCO0FBQzFDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDZCQUE2QixPQUFPO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDREQUFhO0FBQzFDLFVBQVUsY0FBYztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXVWO0FBQ3ZWIiwic291cmNlcyI6WyIvVXNlcnMvcmFpbjIvRG9jdW1lbnRzL25vdGVDYXJkL25vZGVfbW9kdWxlcy9AbWlsa2Rvd24vcHJvc2UvbGliL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBsdWdpbktleSwgUGx1Z2luLCBOb2RlU2VsZWN0aW9uIH0gZnJvbSAncHJvc2VtaXJyb3Itc3RhdGUnO1xuaW1wb3J0IHsgSW5wdXRSdWxlIH0gZnJvbSAncHJvc2VtaXJyb3ItaW5wdXRydWxlcyc7XG5pbXBvcnQgeyBleHBlY3REb21UeXBlRXJyb3IsIG1pc3NpbmdSb290RWxlbWVudCwgZ2V0QXRvbUZyb21TY2hlbWFGYWlsIH0gZnJvbSAnQG1pbGtkb3duL2V4Y2VwdGlvbic7XG5cbmNvbnN0IG5hdiA9IHR5cGVvZiBuYXZpZ2F0b3IgIT0gXCJ1bmRlZmluZWRcIiA/IG5hdmlnYXRvciA6IG51bGw7XG5jb25zdCBkb2MgPSB0eXBlb2YgZG9jdW1lbnQgIT0gXCJ1bmRlZmluZWRcIiA/IGRvY3VtZW50IDogbnVsbDtcbmNvbnN0IGFnZW50ID0gbmF2ICYmIG5hdi51c2VyQWdlbnQgfHwgXCJcIjtcbmNvbnN0IGllX2VkZ2UgPSAvRWRnZVxcLyhcXGQrKS8uZXhlYyhhZ2VudCk7XG5jb25zdCBpZV91cHRvMTAgPSAvTVNJRSBcXGQvLmV4ZWMoYWdlbnQpO1xuY29uc3QgaWVfMTF1cCA9IC9UcmlkZW50XFwvKD86WzctOV18XFxkezIsfSlcXC4uKnJ2OihcXGQrKS8uZXhlYyhhZ2VudCk7XG5jb25zdCBpZSA9ICEhKGllX3VwdG8xMCB8fCBpZV8xMXVwIHx8IGllX2VkZ2UpO1xuY29uc3QgaWVfdmVyc2lvbiA9IGllX3VwdG8xMCA/IGRvY3VtZW50LmRvY3VtZW50TW9kZSA6IGllXzExdXAgPyAraWVfMTF1cFsxXSA6IGllX2VkZ2UgPyAraWVfZWRnZVsxXSA6IDA7XG5jb25zdCBnZWNrbyA9ICFpZSAmJiAvZ2Vja29cXC8oXFxkKykvaS50ZXN0KGFnZW50KTtcbmNvbnN0IGdlY2tvX3ZlcnNpb24gPSBnZWNrbyAmJiArKC9GaXJlZm94XFwvKFxcZCspLy5leGVjKGFnZW50KSB8fCBbMCwgMF0pWzFdO1xuY29uc3QgX2Nocm9tZSA9ICFpZSAmJiAvQ2hyb21lXFwvKFxcZCspLy5leGVjKGFnZW50KTtcbmNvbnN0IGNocm9tZSA9ICEhX2Nocm9tZTtcbmNvbnN0IGNocm9tZV92ZXJzaW9uID0gX2Nocm9tZSA/ICtfY2hyb21lWzFdIDogMDtcbmNvbnN0IHNhZmFyaSA9ICFpZSAmJiAhIW5hdiAmJiAvQXBwbGUgQ29tcHV0ZXIvLnRlc3QobmF2LnZlbmRvcik7XG5jb25zdCBpb3MgPSBzYWZhcmkgJiYgKC9Nb2JpbGVcXC9cXHcrLy50ZXN0KGFnZW50KSB8fCAhIW5hdiAmJiBuYXYubWF4VG91Y2hQb2ludHMgPiAyKTtcbmNvbnN0IG1hYyA9IGlvcyB8fCAobmF2ID8gL01hYy8udGVzdChuYXYucGxhdGZvcm0pIDogZmFsc2UpO1xuY29uc3QgYW5kcm9pZCA9IC9BbmRyb2lkIFxcZC8udGVzdChhZ2VudCk7XG5jb25zdCB3ZWJraXQgPSAhIWRvYyAmJiBcIndlYmtpdEZvbnRTbW9vdGhpbmdcIiBpbiBkb2MuZG9jdW1lbnRFbGVtZW50LnN0eWxlO1xuY29uc3Qgd2Via2l0X3ZlcnNpb24gPSB3ZWJraXQgPyArKC9cXGJBcHBsZVdlYktpdFxcLyhcXGQrKS8uZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KSB8fCBbMCwgMF0pWzFdIDogMDtcblxudmFyIGJyb3dzZXIgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgYW5kcm9pZDogYW5kcm9pZCxcbiAgY2hyb21lOiBjaHJvbWUsXG4gIGNocm9tZV92ZXJzaW9uOiBjaHJvbWVfdmVyc2lvbixcbiAgZ2Vja286IGdlY2tvLFxuICBnZWNrb192ZXJzaW9uOiBnZWNrb192ZXJzaW9uLFxuICBpZTogaWUsXG4gIGllX3ZlcnNpb246IGllX3ZlcnNpb24sXG4gIGlvczogaW9zLFxuICBtYWM6IG1hYyxcbiAgc2FmYXJpOiBzYWZhcmksXG4gIHdlYmtpdDogd2Via2l0LFxuICB3ZWJraXRfdmVyc2lvbjogd2Via2l0X3ZlcnNpb25cbn0pO1xuXG5mdW5jdGlvbiBydW4odmlldywgZnJvbSwgdG8sIHRleHQsIHJ1bGVzLCBwbHVnaW4pIHtcbiAgaWYgKHZpZXcuY29tcG9zaW5nKSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IHN0YXRlID0gdmlldy5zdGF0ZTtcbiAgY29uc3QgJGZyb20gPSBzdGF0ZS5kb2MucmVzb2x2ZShmcm9tKTtcbiAgaWYgKCRmcm9tLnBhcmVudC50eXBlLnNwZWMuY29kZSkgcmV0dXJuIGZhbHNlO1xuICBjb25zdCB0ZXh0QmVmb3JlID0gJGZyb20ucGFyZW50LnRleHRCZXR3ZWVuKFxuICAgIE1hdGgubWF4KDAsICRmcm9tLnBhcmVudE9mZnNldCAtIDUwMCksXG4gICAgJGZyb20ucGFyZW50T2Zmc2V0LFxuICAgIHZvaWQgMCxcbiAgICBcIlxcdUZGRkNcIlxuICApICsgdGV4dDtcbiAgZm9yIChsZXQgX21hdGNoZXIgb2YgcnVsZXMpIHtcbiAgICBjb25zdCBtYXRjaGVyID0gX21hdGNoZXI7XG4gICAgY29uc3QgbWF0Y2ggPSBtYXRjaGVyLm1hdGNoLmV4ZWModGV4dEJlZm9yZSk7XG4gICAgY29uc3QgdHIgPSBtYXRjaCAmJiBtYXRjaFswXSAmJiBtYXRjaGVyLmhhbmRsZXIoc3RhdGUsIG1hdGNoLCBmcm9tIC0gKG1hdGNoWzBdLmxlbmd0aCAtIHRleHQubGVuZ3RoKSwgdG8pO1xuICAgIGlmICghdHIpIGNvbnRpbnVlO1xuICAgIGlmIChtYXRjaGVyLnVuZG9hYmxlICE9PSBmYWxzZSlcbiAgICAgIHRyLnNldE1ldGEocGx1Z2luLCB7IHRyYW5zZm9ybTogdHIsIGZyb20sIHRvLCB0ZXh0IH0pO1xuICAgIHZpZXcuZGlzcGF0Y2godHIpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbmNvbnN0IGN1c3RvbUlucHV0UnVsZXNLZXkgPSBuZXcgUGx1Z2luS2V5KFwiTUlMS0RPV05fQ1VTVE9NX0lOUFVUUlVMRVNcIik7XG5mdW5jdGlvbiBjdXN0b21JbnB1dFJ1bGVzKHsgcnVsZXMgfSkge1xuICBjb25zdCBwbHVnaW4gPSBuZXcgUGx1Z2luKHtcbiAgICBrZXk6IGN1c3RvbUlucHV0UnVsZXNLZXksXG4gICAgaXNJbnB1dFJ1bGVzOiB0cnVlLFxuICAgIHN0YXRlOiB7XG4gICAgICBpbml0KCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICBhcHBseSh0ciwgcHJldikge1xuICAgICAgICBjb25zdCBzdG9yZWQgPSB0ci5nZXRNZXRhKHRoaXMpO1xuICAgICAgICBpZiAoc3RvcmVkKSByZXR1cm4gc3RvcmVkO1xuICAgICAgICByZXR1cm4gdHIuc2VsZWN0aW9uU2V0IHx8IHRyLmRvY0NoYW5nZWQgPyBudWxsIDogcHJldjtcbiAgICAgIH1cbiAgICB9LFxuICAgIHByb3BzOiB7XG4gICAgICBoYW5kbGVUZXh0SW5wdXQodmlldywgZnJvbSwgdG8sIHRleHQpIHtcbiAgICAgICAgcmV0dXJuIHJ1bih2aWV3LCBmcm9tLCB0bywgdGV4dCwgcnVsZXMsIHBsdWdpbik7XG4gICAgICB9LFxuICAgICAgaGFuZGxlRE9NRXZlbnRzOiB7XG4gICAgICAgIGNvbXBvc2l0aW9uZW5kOiAodmlldykgPT4ge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyAkY3Vyc29yIH0gPSB2aWV3LnN0YXRlLnNlbGVjdGlvbjtcbiAgICAgICAgICAgIGlmICgkY3Vyc29yKSBydW4odmlldywgJGN1cnNvci5wb3MsICRjdXJzb3IucG9zLCBcIlwiLCBydWxlcywgcGx1Z2luKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBoYW5kbGVLZXlEb3duKHZpZXcsIGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5rZXkgIT09IFwiRW50ZXJcIikgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCB7ICRjdXJzb3IgfSA9IHZpZXcuc3RhdGUuc2VsZWN0aW9uO1xuICAgICAgICBpZiAoJGN1cnNvcilcbiAgICAgICAgICByZXR1cm4gcnVuKHZpZXcsICRjdXJzb3IucG9zLCAkY3Vyc29yLnBvcywgXCJcXG5cIiwgcnVsZXMsIHBsdWdpbik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcGx1Z2luO1xufVxuXG5mdW5jdGlvbiBtYXJrUnVsZShyZWdleHAsIG1hcmtUeXBlLCBvcHRpb25zID0ge30pIHtcbiAgcmV0dXJuIG5ldyBJbnB1dFJ1bGUocmVnZXhwLCAoc3RhdGUsIG1hdGNoLCBzdGFydCwgZW5kKSA9PiB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgIGNvbnN0IHsgdHIgfSA9IHN0YXRlO1xuICAgIGNvbnN0IG1hdGNoTGVuZ3RoID0gbWF0Y2gubGVuZ3RoO1xuICAgIGxldCBncm91cCA9IG1hdGNoW21hdGNoTGVuZ3RoIC0gMV07XG4gICAgbGV0IGZ1bGxNYXRjaCA9IG1hdGNoWzBdO1xuICAgIGxldCBpbml0aWFsU3RvcmVkTWFya3MgPSBbXTtcbiAgICBsZXQgbWFya0VuZCA9IGVuZDtcbiAgICBjb25zdCBjYXB0dXJlZCA9IHtcbiAgICAgIGdyb3VwLFxuICAgICAgZnVsbE1hdGNoLFxuICAgICAgc3RhcnQsXG4gICAgICBlbmRcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IChfYSA9IG9wdGlvbnMudXBkYXRlQ2FwdHVyZWQpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jYWxsKG9wdGlvbnMsIGNhcHR1cmVkKTtcbiAgICBPYmplY3QuYXNzaWduKGNhcHR1cmVkLCByZXN1bHQpO1xuICAgICh7IGdyb3VwLCBmdWxsTWF0Y2gsIHN0YXJ0LCBlbmQgfSA9IGNhcHR1cmVkKTtcbiAgICBpZiAoZnVsbE1hdGNoID09PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgICBpZiAoKGdyb3VwID09IG51bGwgPyB2b2lkIDAgOiBncm91cC50cmltKCkpID09PSBcIlwiKSByZXR1cm4gbnVsbDtcbiAgICBpZiAoZ3JvdXApIHtcbiAgICAgIGNvbnN0IHN0YXJ0U3BhY2VzID0gZnVsbE1hdGNoLnNlYXJjaCgvXFxTLyk7XG4gICAgICBjb25zdCB0ZXh0U3RhcnQgPSBzdGFydCArIGZ1bGxNYXRjaC5pbmRleE9mKGdyb3VwKTtcbiAgICAgIGNvbnN0IHRleHRFbmQgPSB0ZXh0U3RhcnQgKyBncm91cC5sZW5ndGg7XG4gICAgICBpbml0aWFsU3RvcmVkTWFya3MgPSAoX2IgPSB0ci5zdG9yZWRNYXJrcykgIT0gbnVsbCA/IF9iIDogW107XG4gICAgICBpZiAodGV4dEVuZCA8IGVuZCkgdHIuZGVsZXRlKHRleHRFbmQsIGVuZCk7XG4gICAgICBpZiAodGV4dFN0YXJ0ID4gc3RhcnQpIHRyLmRlbGV0ZShzdGFydCArIHN0YXJ0U3BhY2VzLCB0ZXh0U3RhcnQpO1xuICAgICAgbWFya0VuZCA9IHN0YXJ0ICsgc3RhcnRTcGFjZXMgKyBncm91cC5sZW5ndGg7XG4gICAgICBjb25zdCBhdHRycyA9IChfYyA9IG9wdGlvbnMuZ2V0QXR0cikgPT0gbnVsbCA/IHZvaWQgMCA6IF9jLmNhbGwob3B0aW9ucywgbWF0Y2gpO1xuICAgICAgdHIuYWRkTWFyayhzdGFydCwgbWFya0VuZCwgbWFya1R5cGUuY3JlYXRlKGF0dHJzKSk7XG4gICAgICB0ci5zZXRTdG9yZWRNYXJrcyhpbml0aWFsU3RvcmVkTWFya3MpO1xuICAgICAgKF9kID0gb3B0aW9ucy5iZWZvcmVEaXNwYXRjaCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9kLmNhbGwob3B0aW9ucywgeyBtYXRjaCwgc3RhcnQsIGVuZCwgdHIgfSk7XG4gICAgfVxuICAgIHJldHVybiB0cjtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG5vZGVSdWxlKHJlZ2V4cCwgbm9kZVR5cGUsIG9wdGlvbnMgPSB7fSkge1xuICByZXR1cm4gbmV3IElucHV0UnVsZShyZWdleHAsIChzdGF0ZSwgbWF0Y2gsIHN0YXJ0LCBlbmQpID0+IHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICBjb25zdCB7IHRyIH0gPSBzdGF0ZTtcbiAgICBsZXQgZ3JvdXAgPSBtYXRjaFsxXTtcbiAgICBsZXQgZnVsbE1hdGNoID0gbWF0Y2hbMF07XG4gICAgY29uc3QgY2FwdHVyZWQgPSB7XG4gICAgICBncm91cCxcbiAgICAgIGZ1bGxNYXRjaCxcbiAgICAgIHN0YXJ0LFxuICAgICAgZW5kXG4gICAgfTtcbiAgICBjb25zdCByZXN1bHQgPSAoX2EgPSBvcHRpb25zLnVwZGF0ZUNhcHR1cmVkKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbChvcHRpb25zLCBjYXB0dXJlZCk7XG4gICAgT2JqZWN0LmFzc2lnbihjYXB0dXJlZCwgcmVzdWx0KTtcbiAgICAoeyBncm91cCwgZnVsbE1hdGNoLCBzdGFydCwgZW5kIH0gPSBjYXB0dXJlZCk7XG4gICAgaWYgKGZ1bGxNYXRjaCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gICAgaWYgKCFncm91cCB8fCBncm91cC50cmltKCkgPT09IFwiXCIpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGF0dHJzID0gKF9iID0gb3B0aW9ucy5nZXRBdHRyKSA9PSBudWxsID8gdm9pZCAwIDogX2IuY2FsbChvcHRpb25zLCBtYXRjaCk7XG4gICAgY29uc3Qgbm9kZSA9IG5vZGVUeXBlLmNyZWF0ZUFuZEZpbGwoYXR0cnMpO1xuICAgIGlmIChub2RlKSB7XG4gICAgICB0ci5yZXBsYWNlUmFuZ2VXaXRoKFxuICAgICAgICBub2RlVHlwZS5pc0Jsb2NrID8gdHIuZG9jLnJlc29sdmUoc3RhcnQpLmJlZm9yZSgpIDogc3RhcnQsXG4gICAgICAgIGVuZCxcbiAgICAgICAgbm9kZVxuICAgICAgKTtcbiAgICAgIChfYyA9IG9wdGlvbnMuYmVmb3JlRGlzcGF0Y2gpID09IG51bGwgPyB2b2lkIDAgOiBfYy5jYWxsKG9wdGlvbnMsIHtcbiAgICAgICAgbWF0Y2g6IFtmdWxsTWF0Y2gsIGdyb3VwICE9IG51bGwgPyBncm91cCA6IFwiXCJdLFxuICAgICAgICBzdGFydCxcbiAgICAgICAgZW5kLFxuICAgICAgICB0clxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB0cjtcbiAgfSk7XG59XG5cbnZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xudmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG52YXIgX19nZXRPd25Qcm9wU3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHtcbiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8IChiID0ge30pKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgaWYgKF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpXG4gICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgICB9XG4gIHJldHVybiBhO1xufTtcbnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpO1xuZnVuY3Rpb24gY2FsY3VsYXRlTm9kZVBvc2l0aW9uKHZpZXcsIHRhcmdldCwgaGFuZGxlcikge1xuICBjb25zdCBzdGF0ZSA9IHZpZXcuc3RhdGU7XG4gIGNvbnN0IHsgZnJvbSB9ID0gc3RhdGUuc2VsZWN0aW9uO1xuICBjb25zdCB7IG5vZGUgfSA9IHZpZXcuZG9tQXRQb3MoZnJvbSk7XG4gIGNvbnN0IGVsZW1lbnQgPSBub2RlIGluc3RhbmNlb2YgVGV4dCA/IG5vZGUucGFyZW50RWxlbWVudCA6IG5vZGU7XG4gIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHRocm93IGV4cGVjdERvbVR5cGVFcnJvcihlbGVtZW50KTtcbiAgY29uc3Qgc2VsZWN0ZWROb2RlUmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IHRhcmdldE5vZGVSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICBjb25zdCBwYXJlbnQgPSB0YXJnZXQucGFyZW50RWxlbWVudDtcbiAgaWYgKCFwYXJlbnQpIHRocm93IGV4cGVjdERvbVR5cGVFcnJvcihwYXJlbnQpO1xuICBjb25zdCBwYXJlbnROb2RlUmVjdCA9IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgY29uc3QgW3RvcCwgbGVmdF0gPSBoYW5kbGVyKHNlbGVjdGVkTm9kZVJlY3QsIHRhcmdldE5vZGVSZWN0LCBwYXJlbnROb2RlUmVjdCk7XG4gIHRhcmdldC5zdHlsZS50b3AgPSBgJHt0b3B9cHhgO1xuICB0YXJnZXQuc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgO1xufVxuZnVuY3Rpb24gY2FsY3VsYXRlVGV4dFBvc2l0aW9uKHZpZXcsIHRhcmdldCwgaGFuZGxlcikge1xuICBjb25zdCBzdGF0ZSA9IHZpZXcuc3RhdGU7XG4gIGNvbnN0IHsgZnJvbSwgdG8gfSA9IHN0YXRlLnNlbGVjdGlvbjtcbiAgY29uc3Qgc3RhcnQgPSB2aWV3LmNvb3Jkc0F0UG9zKGZyb20pO1xuICBjb25zdCBlbmQgPSB2aWV3LmNvb3Jkc0F0UG9zKHRvKTtcbiAgY29uc3QgdGFyZ2V0Tm9kZVJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IHBhcmVudCA9IHRhcmdldC5wYXJlbnRFbGVtZW50O1xuICBpZiAoIXBhcmVudCkgdGhyb3cgbWlzc2luZ1Jvb3RFbGVtZW50KCk7XG4gIGNvbnN0IHBhcmVudE5vZGVSZWN0ID0gcGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICBjb25zdCBbdG9wLCBsZWZ0XSA9IGhhbmRsZXIoc3RhcnQsIGVuZCwgdGFyZ2V0Tm9kZVJlY3QsIHBhcmVudE5vZGVSZWN0KTtcbiAgdGFyZ2V0LnN0eWxlLnRvcCA9IGAke3RvcH1weGA7XG4gIHRhcmdldC5zdHlsZS5sZWZ0ID0gYCR7bGVmdH1weGA7XG59XG5mdW5jdGlvbiBtaW5NYXgodmFsdWUgPSAwLCBtaW4gPSAwLCBtYXggPSAwKSB7XG4gIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgbWluKSwgbWF4KTtcbn1cbmZ1bmN0aW9uIHBvc1RvRE9NUmVjdCh2aWV3LCBmcm9tLCB0bykge1xuICBjb25zdCBtaW5Qb3MgPSAwO1xuICBjb25zdCBtYXhQb3MgPSB2aWV3LnN0YXRlLmRvYy5jb250ZW50LnNpemU7XG4gIGNvbnN0IHJlc29sdmVkRnJvbSA9IG1pbk1heChmcm9tLCBtaW5Qb3MsIG1heFBvcyk7XG4gIGNvbnN0IHJlc29sdmVkRW5kID0gbWluTWF4KHRvLCBtaW5Qb3MsIG1heFBvcyk7XG4gIGNvbnN0IHN0YXJ0ID0gdmlldy5jb29yZHNBdFBvcyhyZXNvbHZlZEZyb20pO1xuICBjb25zdCBlbmQgPSB2aWV3LmNvb3Jkc0F0UG9zKHJlc29sdmVkRW5kLCAtMSk7XG4gIGNvbnN0IHRvcCA9IE1hdGgubWluKHN0YXJ0LnRvcCwgZW5kLnRvcCk7XG4gIGNvbnN0IGJvdHRvbSA9IE1hdGgubWF4KHN0YXJ0LmJvdHRvbSwgZW5kLmJvdHRvbSk7XG4gIGNvbnN0IGxlZnQgPSBNYXRoLm1pbihzdGFydC5sZWZ0LCBlbmQubGVmdCk7XG4gIGNvbnN0IHJpZ2h0ID0gTWF0aC5tYXgoc3RhcnQucmlnaHQsIGVuZC5yaWdodCk7XG4gIGNvbnN0IHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xuICBjb25zdCBoZWlnaHQgPSBib3R0b20gLSB0b3A7XG4gIGNvbnN0IHggPSBsZWZ0O1xuICBjb25zdCB5ID0gdG9wO1xuICBjb25zdCBkYXRhID0ge1xuICAgIHRvcCxcbiAgICBib3R0b20sXG4gICAgbGVmdCxcbiAgICByaWdodCxcbiAgICB3aWR0aCxcbiAgICBoZWlnaHQsXG4gICAgeCxcbiAgICB5XG4gIH07XG4gIHJldHVybiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBkYXRhKSwge1xuICAgIHRvSlNPTjogKCkgPT4gZGF0YVxuICB9KTtcbn1cblxuZnVuY3Rpb24gY2xvbmVUcih0cikge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHRyKSwgdHIpLnNldFRpbWUoRGF0ZS5ub3coKSk7XG59XG5mdW5jdGlvbiBlcXVhbE5vZGVUeXBlKG5vZGVUeXBlLCBub2RlKSB7XG4gIHJldHVybiBBcnJheS5pc0FycmF5KG5vZGVUeXBlKSAmJiBub2RlVHlwZS5pbmNsdWRlcyhub2RlLnR5cGUpIHx8IG5vZGUudHlwZSA9PT0gbm9kZVR5cGU7XG59XG5cbmZ1bmN0aW9uIGZsYXR0ZW4obm9kZSwgZGVzY2VuZCA9IHRydWUpIHtcbiAgY29uc3QgcmVzdWx0ID0gW107XG4gIG5vZGUuZGVzY2VuZGFudHMoKGNoaWxkLCBwb3MpID0+IHtcbiAgICByZXN1bHQucHVzaCh7IG5vZGU6IGNoaWxkLCBwb3MgfSk7XG4gICAgaWYgKCFkZXNjZW5kKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBmaW5kQ2hpbGRyZW4ocHJlZGljYXRlKSB7XG4gIHJldHVybiAobm9kZSwgZGVzY2VuZCkgPT4gZmxhdHRlbihub2RlLCBkZXNjZW5kKS5maWx0ZXIoKGNoaWxkKSA9PiBwcmVkaWNhdGUoY2hpbGQubm9kZSkpO1xufVxuZnVuY3Rpb24gZmluZENoaWxkcmVuQnlNYXJrKG5vZGUsIG1hcmtUeXBlLCBkZXNjZW5kKSB7XG4gIHJldHVybiBmaW5kQ2hpbGRyZW4oKGNoaWxkKSA9PiBCb29sZWFuKG1hcmtUeXBlLmlzSW5TZXQoY2hpbGQubWFya3MpKSkoXG4gICAgbm9kZSxcbiAgICBkZXNjZW5kXG4gICk7XG59XG5mdW5jdGlvbiBmaW5kUGFyZW50KHByZWRpY2F0ZSkge1xuICByZXR1cm4gKCRwb3MpID0+IHtcbiAgICBmb3IgKGxldCBkZXB0aCA9ICRwb3MuZGVwdGg7IGRlcHRoID4gMDsgZGVwdGggLT0gMSkge1xuICAgICAgY29uc3Qgbm9kZSA9ICRwb3Mubm9kZShkZXB0aCk7XG4gICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgIGNvbnN0IGZyb20gPSAkcG9zLmJlZm9yZShkZXB0aCk7XG4gICAgICAgIGNvbnN0IHRvID0gJHBvcy5hZnRlcihkZXB0aCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZnJvbSxcbiAgICAgICAgICB0byxcbiAgICAgICAgICBub2RlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2b2lkIDA7XG4gIH07XG59XG5mdW5jdGlvbiBmaW5kUGFyZW50Tm9kZVR5cGUoJHBvcywgbm9kZVR5cGUpIHtcbiAgcmV0dXJuIGZpbmRQYXJlbnQoKG5vZGUpID0+IG5vZGUudHlwZSA9PT0gbm9kZVR5cGUpKCRwb3MpO1xufVxuXG5mdW5jdGlvbiBnZXROb2RlRnJvbVNjaGVtYSh0eXBlLCBzY2hlbWEpIHtcbiAgY29uc3QgdGFyZ2V0ID0gc2NoZW1hLm5vZGVzW3R5cGVdO1xuICBpZiAoIXRhcmdldCkgdGhyb3cgZ2V0QXRvbUZyb21TY2hlbWFGYWlsKFwibm9kZVwiLCB0eXBlKTtcbiAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIGdldE1hcmtGcm9tU2NoZW1hKHR5cGUsIHNjaGVtYSkge1xuICBjb25zdCB0YXJnZXQgPSBzY2hlbWEubWFya3NbdHlwZV07XG4gIGlmICghdGFyZ2V0KSB0aHJvdyBnZXRBdG9tRnJvbVNjaGVtYUZhaWwoXCJtYXJrXCIsIHR5cGUpO1xuICByZXR1cm4gdGFyZ2V0O1xufVxuXG5mdW5jdGlvbiBmaW5kUGFyZW50Tm9kZUNsb3Nlc3RUb1BvcyhwcmVkaWNhdGUpIHtcbiAgcmV0dXJuICgkcG9zKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9ICRwb3MuZGVwdGg7IGkgPiAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IG5vZGUgPSAkcG9zLm5vZGUoaSk7XG4gICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcG9zOiBpID4gMCA/ICRwb3MuYmVmb3JlKGkpIDogMCxcbiAgICAgICAgICBzdGFydDogJHBvcy5zdGFydChpKSxcbiAgICAgICAgICBkZXB0aDogaSxcbiAgICAgICAgICBub2RlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2b2lkIDA7XG4gIH07XG59XG5mdW5jdGlvbiBmaW5kUGFyZW50Tm9kZShwcmVkaWNhdGUpIHtcbiAgcmV0dXJuIChzZWxlY3Rpb24pID0+IHtcbiAgICByZXR1cm4gZmluZFBhcmVudE5vZGVDbG9zZXN0VG9Qb3MocHJlZGljYXRlKShzZWxlY3Rpb24uJGZyb20pO1xuICB9O1xufVxuZnVuY3Rpb24gZmluZFNlbGVjdGVkTm9kZU9mVHlwZShzZWxlY3Rpb24sIG5vZGVUeXBlKSB7XG4gIGlmICghKHNlbGVjdGlvbiBpbnN0YW5jZW9mIE5vZGVTZWxlY3Rpb24pKSByZXR1cm47XG4gIGNvbnN0IHsgbm9kZSwgJGZyb20gfSA9IHNlbGVjdGlvbjtcbiAgaWYgKGVxdWFsTm9kZVR5cGUobm9kZVR5cGUsIG5vZGUpKVxuICAgIHJldHVybiB7XG4gICAgICBub2RlLFxuICAgICAgcG9zOiAkZnJvbS5wb3MsXG4gICAgICBzdGFydDogJGZyb20uc3RhcnQoJGZyb20uZGVwdGgpLFxuICAgICAgZGVwdGg6ICRmcm9tLmRlcHRoXG4gICAgfTtcbiAgcmV0dXJuIHZvaWQgMDtcbn1cblxuZXhwb3J0IHsgYnJvd3NlciwgY2FsY3VsYXRlTm9kZVBvc2l0aW9uLCBjYWxjdWxhdGVUZXh0UG9zaXRpb24sIGNsb25lVHIsIGN1c3RvbUlucHV0UnVsZXMsIGN1c3RvbUlucHV0UnVsZXNLZXksIGVxdWFsTm9kZVR5cGUsIGZpbmRDaGlsZHJlbiwgZmluZENoaWxkcmVuQnlNYXJrLCBmaW5kUGFyZW50LCBmaW5kUGFyZW50Tm9kZSwgZmluZFBhcmVudE5vZGVDbG9zZXN0VG9Qb3MsIGZpbmRQYXJlbnROb2RlVHlwZSwgZmluZFNlbGVjdGVkTm9kZU9mVHlwZSwgZmxhdHRlbiwgZ2V0TWFya0Zyb21TY2hlbWEsIGdldE5vZGVGcm9tU2NoZW1hLCBtYXJrUnVsZSwgbm9kZVJ1bGUsIHBvc1RvRE9NUmVjdCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/prose/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/react/lib/index.js":
/*!***************************************************!*\
  !*** ./node_modules/@milkdown/react/lib/index.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Milkdown: () => (/* binding */ Milkdown),\n/* harmony export */   MilkdownProvider: () => (/* binding */ MilkdownProvider),\n/* harmony export */   useEditor: () => (/* binding */ useEditor),\n/* harmony export */   useInstance: () => (/* binding */ useInstance)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n\nconst editorInfoContext = (0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(\n  {}\n);\nfunction useGetEditor() {\n  const {\n    dom,\n    editor: editorRef,\n    setLoading,\n    editorFactory: getEditor\n  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(editorInfoContext);\n  const domRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    const div = domRef.current;\n    if (!getEditor) return;\n    if (!div) return;\n    dom.current = div;\n    const editor = getEditor(div);\n    if (!editor) return;\n    setLoading(true);\n    editor.create().then((editor2) => {\n      editorRef.current = editor2;\n    }).finally(() => {\n      setLoading(false);\n    }).catch(console.error);\n    return () => {\n      editor.destroy().catch(console.error);\n    };\n  }, [dom, editorRef, getEditor, setLoading]);\n  return domRef;\n}\nconst Milkdown = () => {\n  const domRef = useGetEditor();\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", { \"data-milkdown-root\": true, ref: domRef });\n};\nconst MilkdownProvider = ({ children }) => {\n  const dom = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(void 0);\n  const [editorFactory, setEditorFactory] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(\n    void 0\n  );\n  const editor = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(void 0);\n  const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const editorInfoCtx = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(\n    () => ({\n      loading,\n      dom,\n      editor,\n      setLoading,\n      editorFactory,\n      setEditorFactory\n    }),\n    [loading, editorFactory]\n  );\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0__.createElement(editorInfoContext.Provider, { value: editorInfoCtx }, children);\n};\nfunction useEditor(getEditor, deps = []) {\n  const editorInfo = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(editorInfoContext);\n  const factory = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(getEditor, deps);\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)(() => {\n    editorInfo.setEditorFactory(() => factory);\n  }, [editorInfo, factory]);\n  return {\n    loading: editorInfo.loading,\n    get: () => editorInfo.editor.current\n  };\n}\nfunction useInstance() {\n  const editorInfo = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(editorInfoContext);\n  const getInstance = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n    return editorInfo.editor.current;\n  }, [editorInfo.editor]);\n  return [editorInfo.loading, getInstance];\n}\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3JlYWN0L2xpYi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE2SDtBQUM3SCwwQkFBMEIsb0RBQWE7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksRUFBRSxpREFBVTtBQUNoQixpQkFBaUIsNkNBQU07QUFDdkIsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsZ0RBQW1CLFVBQVUseUNBQXlDO0FBQy9GO0FBQ0EsNEJBQTRCLFVBQVU7QUFDdEMsY0FBYyw2Q0FBTTtBQUNwQiw0Q0FBNEMsK0NBQVE7QUFDcEQ7QUFDQTtBQUNBLGlCQUFpQiw2Q0FBTTtBQUN2QixnQ0FBZ0MsK0NBQVE7QUFDeEMsd0JBQXdCLDhDQUFPO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSx5QkFBeUIsZ0RBQW1CLCtCQUErQixzQkFBc0I7QUFDakc7QUFDQTtBQUNBLHFCQUFxQixpREFBVTtBQUMvQixrQkFBa0Isa0RBQVc7QUFDN0IsRUFBRSxzREFBZTtBQUNqQjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsaURBQVU7QUFDL0Isc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFNRTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcmFpbjIvRG9jdW1lbnRzL25vdGVDYXJkL25vZGVfbW9kdWxlcy9AbWlsa2Rvd24vcmVhY3QvbGliL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0LCB1c2VSZWYsIHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZU1lbW8sIHVzZUNhbGxiYWNrLCB1c2VMYXlvdXRFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcbmNvbnN0IGVkaXRvckluZm9Db250ZXh0ID0gY3JlYXRlQ29udGV4dChcbiAge31cbik7XG5mdW5jdGlvbiB1c2VHZXRFZGl0b3IoKSB7XG4gIGNvbnN0IHtcbiAgICBkb20sXG4gICAgZWRpdG9yOiBlZGl0b3JSZWYsXG4gICAgc2V0TG9hZGluZyxcbiAgICBlZGl0b3JGYWN0b3J5OiBnZXRFZGl0b3JcbiAgfSA9IHVzZUNvbnRleHQoZWRpdG9ySW5mb0NvbnRleHQpO1xuICBjb25zdCBkb21SZWYgPSB1c2VSZWYobnVsbCk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgZGl2ID0gZG9tUmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFnZXRFZGl0b3IpIHJldHVybjtcbiAgICBpZiAoIWRpdikgcmV0dXJuO1xuICAgIGRvbS5jdXJyZW50ID0gZGl2O1xuICAgIGNvbnN0IGVkaXRvciA9IGdldEVkaXRvcihkaXYpO1xuICAgIGlmICghZWRpdG9yKSByZXR1cm47XG4gICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICBlZGl0b3IuY3JlYXRlKCkudGhlbigoZWRpdG9yMikgPT4ge1xuICAgICAgZWRpdG9yUmVmLmN1cnJlbnQgPSBlZGl0b3IyO1xuICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGVkaXRvci5kZXN0cm95KCkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgfTtcbiAgfSwgW2RvbSwgZWRpdG9yUmVmLCBnZXRFZGl0b3IsIHNldExvYWRpbmddKTtcbiAgcmV0dXJuIGRvbVJlZjtcbn1cbmNvbnN0IE1pbGtkb3duID0gKCkgPT4ge1xuICBjb25zdCBkb21SZWYgPSB1c2VHZXRFZGl0b3IoKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgXCJkYXRhLW1pbGtkb3duLXJvb3RcIjogdHJ1ZSwgcmVmOiBkb21SZWYgfSk7XG59O1xuY29uc3QgTWlsa2Rvd25Qcm92aWRlciA9ICh7IGNoaWxkcmVuIH0pID0+IHtcbiAgY29uc3QgZG9tID0gdXNlUmVmKHZvaWQgMCk7XG4gIGNvbnN0IFtlZGl0b3JGYWN0b3J5LCBzZXRFZGl0b3JGYWN0b3J5XSA9IHVzZVN0YXRlKFxuICAgIHZvaWQgMFxuICApO1xuICBjb25zdCBlZGl0b3IgPSB1c2VSZWYodm9pZCAwKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IGVkaXRvckluZm9DdHggPSB1c2VNZW1vKFxuICAgICgpID0+ICh7XG4gICAgICBsb2FkaW5nLFxuICAgICAgZG9tLFxuICAgICAgZWRpdG9yLFxuICAgICAgc2V0TG9hZGluZyxcbiAgICAgIGVkaXRvckZhY3RvcnksXG4gICAgICBzZXRFZGl0b3JGYWN0b3J5XG4gICAgfSksXG4gICAgW2xvYWRpbmcsIGVkaXRvckZhY3RvcnldXG4gICk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8gUmVhY3QuY3JlYXRlRWxlbWVudChlZGl0b3JJbmZvQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogZWRpdG9ySW5mb0N0eCB9LCBjaGlsZHJlbik7XG59O1xuZnVuY3Rpb24gdXNlRWRpdG9yKGdldEVkaXRvciwgZGVwcyA9IFtdKSB7XG4gIGNvbnN0IGVkaXRvckluZm8gPSB1c2VDb250ZXh0KGVkaXRvckluZm9Db250ZXh0KTtcbiAgY29uc3QgZmFjdG9yeSA9IHVzZUNhbGxiYWNrKGdldEVkaXRvciwgZGVwcyk7XG4gIHVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgZWRpdG9ySW5mby5zZXRFZGl0b3JGYWN0b3J5KCgpID0+IGZhY3RvcnkpO1xuICB9LCBbZWRpdG9ySW5mbywgZmFjdG9yeV0pO1xuICByZXR1cm4ge1xuICAgIGxvYWRpbmc6IGVkaXRvckluZm8ubG9hZGluZyxcbiAgICBnZXQ6ICgpID0+IGVkaXRvckluZm8uZWRpdG9yLmN1cnJlbnRcbiAgfTtcbn1cbmZ1bmN0aW9uIHVzZUluc3RhbmNlKCkge1xuICBjb25zdCBlZGl0b3JJbmZvID0gdXNlQ29udGV4dChlZGl0b3JJbmZvQ29udGV4dCk7XG4gIGNvbnN0IGdldEluc3RhbmNlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHJldHVybiBlZGl0b3JJbmZvLmVkaXRvci5jdXJyZW50O1xuICB9LCBbZWRpdG9ySW5mby5lZGl0b3JdKTtcbiAgcmV0dXJuIFtlZGl0b3JJbmZvLmxvYWRpbmcsIGdldEluc3RhbmNlXTtcbn1cbmV4cG9ydCB7XG4gIE1pbGtkb3duLFxuICBNaWxrZG93blByb3ZpZGVyLFxuICB1c2VFZGl0b3IsXG4gIHVzZUluc3RhbmNlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/react/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/theme-nord/lib/index.js":
/*!********************************************************!*\
  !*** ./node_modules/@milkdown/theme-nord/lib/index.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   nord: () => (/* binding */ nord)\n/* harmony export */ });\n/* harmony import */ var _milkdown_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @milkdown/core */ \"(ssr)/./node_modules/@milkdown/core/lib/index.js\");\n/* harmony import */ var clsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! clsx */ \"(ssr)/./node_modules/clsx/dist/clsx.mjs\");\n\n\nfunction nord(ctx) {\n  ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_1__.editorViewOptionsCtx, (prev) => {\n    const prevClass = prev.attributes;\n    return {\n      ...prev,\n      attributes: (state) => {\n        const attrs = typeof prevClass === \"function\" ? prevClass(state) : prevClass;\n        return {\n          ...attrs,\n          class: (0,clsx__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\n            \"prose dark:prose-invert\",\n            (attrs == null ? void 0 : attrs.class) || \"\",\n            \"milkdown-theme-nord\"\n          )\n        };\n      }\n    };\n  });\n}\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3RoZW1lLW5vcmQvbGliL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFzRDtBQUM5QjtBQUN4QjtBQUNBLGFBQWEsZ0VBQW9CO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdEQUFJO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBR0U7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JhaW4yL0RvY3VtZW50cy9ub3RlQ2FyZC9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3RoZW1lLW5vcmQvbGliL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVkaXRvclZpZXdPcHRpb25zQ3R4IH0gZnJvbSBcIkBtaWxrZG93bi9jb3JlXCI7XG5pbXBvcnQgY2xzeCBmcm9tIFwiY2xzeFwiO1xuZnVuY3Rpb24gbm9yZChjdHgpIHtcbiAgY3R4LnVwZGF0ZShlZGl0b3JWaWV3T3B0aW9uc0N0eCwgKHByZXYpID0+IHtcbiAgICBjb25zdCBwcmV2Q2xhc3MgPSBwcmV2LmF0dHJpYnV0ZXM7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnByZXYsXG4gICAgICBhdHRyaWJ1dGVzOiAoc3RhdGUpID0+IHtcbiAgICAgICAgY29uc3QgYXR0cnMgPSB0eXBlb2YgcHJldkNsYXNzID09PSBcImZ1bmN0aW9uXCIgPyBwcmV2Q2xhc3Moc3RhdGUpIDogcHJldkNsYXNzO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmF0dHJzLFxuICAgICAgICAgIGNsYXNzOiBjbHN4KFxuICAgICAgICAgICAgXCJwcm9zZSBkYXJrOnByb3NlLWludmVydFwiLFxuICAgICAgICAgICAgKGF0dHJzID09IG51bGwgPyB2b2lkIDAgOiBhdHRycy5jbGFzcykgfHwgXCJcIixcbiAgICAgICAgICAgIFwibWlsa2Rvd24tdGhlbWUtbm9yZFwiXG4gICAgICAgICAgKVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufVxuZXhwb3J0IHtcbiAgbm9yZFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/theme-nord/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/transformer/lib/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/@milkdown/transformer/lib/index.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ParserState: () => (/* binding */ ParserState),\n/* harmony export */   SerializerState: () => (/* binding */ SerializerState),\n/* harmony export */   Stack: () => (/* binding */ Stack),\n/* harmony export */   StackElement: () => (/* binding */ StackElement)\n/* harmony export */ });\n/* harmony import */ var _milkdown_exception__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @milkdown/exception */ \"(ssr)/./node_modules/@milkdown/exception/lib/index.js\");\n/* harmony import */ var _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @milkdown/prose/model */ \"(ssr)/./node_modules/prosemirror-model/dist/index.js\");\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\nvar _marks, _hasText, _maybeMerge, _matchTarget, _runNode, _closeNodeAndPush, _addNodeAndPush, _marks2, _matchTarget2, _runProseNode, _runProseMark, _runNode2, _searchType, _maybeMergeChildren, _createMarkdownNode, _moveSpaces, _closeNodeAndPush2, _addNodeAndPush2, _openMark, _closeMark;\n\n\nclass StackElement {\n}\nclass Stack {\n  constructor() {\n    this.elements = [];\n    this.size = () => {\n      return this.elements.length;\n    };\n    this.top = () => {\n      return this.elements.at(-1);\n    };\n    this.push = (node) => {\n      var _a;\n      (_a = this.top()) == null ? void 0 : _a.push(node);\n    };\n    this.open = (node) => {\n      this.elements.push(node);\n    };\n    this.close = () => {\n      const el = this.elements.pop();\n      if (!el) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.stackOverFlow)();\n      return el;\n    };\n  }\n}\nclass ParserStackElement extends StackElement {\n  constructor(type, content, attrs) {\n    super();\n    this.type = type;\n    this.content = content;\n    this.attrs = attrs;\n  }\n  push(node, ...rest) {\n    this.content.push(node, ...rest);\n  }\n  pop() {\n    return this.content.pop();\n  }\n  static create(type, content, attrs) {\n    return new ParserStackElement(type, content, attrs);\n  }\n}\nconst _ParserState = class _ParserState extends Stack {\n  /// @internal\n  constructor(schema) {\n    super();\n    __privateAdd(this, _marks);\n    __privateAdd(this, _hasText);\n    __privateAdd(this, _maybeMerge);\n    __privateAdd(this, _matchTarget);\n    __privateAdd(this, _runNode);\n    __privateAdd(this, _closeNodeAndPush);\n    __privateAdd(this, _addNodeAndPush);\n    __privateSet(this, _marks, _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_1__.Mark.none);\n    __privateSet(this, _hasText, (node) => node.isText);\n    __privateSet(this, _maybeMerge, (a, b) => {\n      if (__privateGet(this, _hasText).call(this, a) && __privateGet(this, _hasText).call(this, b) && _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_1__.Mark.sameSet(a.marks, b.marks))\n        return this.schema.text(a.text + b.text, a.marks);\n      return void 0;\n    });\n    __privateSet(this, _matchTarget, (node) => {\n      const result = Object.values({\n        ...this.schema.nodes,\n        ...this.schema.marks\n      }).find((x) => {\n        const spec = x.spec;\n        return spec.parseMarkdown.match(node);\n      });\n      if (!result) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.parserMatchError)(node);\n      return result;\n    });\n    __privateSet(this, _runNode, (node) => {\n      const type = __privateGet(this, _matchTarget).call(this, node);\n      const spec = type.spec;\n      spec.parseMarkdown.runner(this, node, type);\n    });\n    this.injectRoot = (node, nodeType, attrs) => {\n      this.openNode(nodeType, attrs);\n      this.next(node.children);\n      return this;\n    };\n    this.openNode = (nodeType, attrs) => {\n      this.open(ParserStackElement.create(nodeType, [], attrs));\n      return this;\n    };\n    __privateSet(this, _closeNodeAndPush, () => {\n      __privateSet(this, _marks, _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_1__.Mark.none);\n      const element = this.close();\n      return __privateGet(this, _addNodeAndPush).call(this, element.type, element.attrs, element.content);\n    });\n    this.closeNode = () => {\n      try {\n        __privateGet(this, _closeNodeAndPush).call(this);\n      } catch (e) {\n        console.error(e);\n      }\n      return this;\n    };\n    __privateSet(this, _addNodeAndPush, (nodeType, attrs, content) => {\n      const node = nodeType.createAndFill(attrs, content, __privateGet(this, _marks));\n      if (!node) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.createNodeInParserFail)(nodeType, attrs, content);\n      this.push(node);\n      return node;\n    });\n    this.addNode = (nodeType, attrs, content) => {\n      try {\n        __privateGet(this, _addNodeAndPush).call(this, nodeType, attrs, content);\n      } catch (e) {\n        console.error(e);\n      }\n      return this;\n    };\n    this.openMark = (markType, attrs) => {\n      const mark = markType.create(attrs);\n      __privateSet(this, _marks, mark.addToSet(__privateGet(this, _marks)));\n      return this;\n    };\n    this.closeMark = (markType) => {\n      __privateSet(this, _marks, markType.removeFromSet(__privateGet(this, _marks)));\n      return this;\n    };\n    this.addText = (text) => {\n      try {\n        const topElement = this.top();\n        if (!topElement) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.stackOverFlow)();\n        const prevNode = topElement.pop();\n        const currNode = this.schema.text(text, __privateGet(this, _marks));\n        if (!prevNode) {\n          topElement.push(currNode);\n          return this;\n        }\n        const merged = __privateGet(this, _maybeMerge).call(this, prevNode, currNode);\n        if (merged) {\n          topElement.push(merged);\n          return this;\n        }\n        topElement.push(prevNode, currNode);\n        return this;\n      } catch (e) {\n        console.error(e);\n        return this;\n      }\n    };\n    this.build = () => {\n      let doc;\n      do\n        doc = __privateGet(this, _closeNodeAndPush).call(this);\n      while (this.size());\n      return doc;\n    };\n    this.next = (nodes = []) => {\n      [nodes].flat().forEach((node) => __privateGet(this, _runNode).call(this, node));\n      return this;\n    };\n    this.toDoc = () => this.build();\n    this.run = (remark, markdown) => {\n      const tree = remark.runSync(\n        remark.parse(markdown),\n        markdown\n      );\n      this.next(tree);\n      return this;\n    };\n    this.schema = schema;\n  }\n};\n_marks = new WeakMap();\n_hasText = new WeakMap();\n_maybeMerge = new WeakMap();\n_matchTarget = new WeakMap();\n_runNode = new WeakMap();\n_closeNodeAndPush = new WeakMap();\n_addNodeAndPush = new WeakMap();\n_ParserState.create = (schema, remark) => {\n  const state = new _ParserState(schema);\n  return (text) => {\n    state.run(remark, text);\n    return state.toDoc();\n  };\n};\nlet ParserState = _ParserState;\nconst _SerializerStackElement = class _SerializerStackElement extends StackElement {\n  constructor(type, children, value, props = {}) {\n    super();\n    this.type = type;\n    this.children = children;\n    this.value = value;\n    this.props = props;\n    this.push = (node, ...rest) => {\n      if (!this.children) this.children = [];\n      this.children.push(node, ...rest);\n    };\n    this.pop = () => {\n      var _a;\n      return (_a = this.children) == null ? void 0 : _a.pop();\n    };\n  }\n};\n_SerializerStackElement.create = (type, children, value, props = {}) => new _SerializerStackElement(type, children, value, props);\nlet SerializerStackElement = _SerializerStackElement;\nconst isFragment = (x) => Object.prototype.hasOwnProperty.call(x, \"size\");\nconst _SerializerState = class _SerializerState extends Stack {\n  /// @internal\n  constructor(schema) {\n    super();\n    __privateAdd(this, _marks2);\n    __privateAdd(this, _matchTarget2);\n    __privateAdd(this, _runProseNode);\n    __privateAdd(this, _runProseMark);\n    __privateAdd(this, _runNode2);\n    __privateAdd(this, _searchType);\n    __privateAdd(this, _maybeMergeChildren);\n    __privateAdd(this, _createMarkdownNode);\n    __privateAdd(this, _moveSpaces);\n    __privateAdd(this, _closeNodeAndPush2);\n    __privateAdd(this, _addNodeAndPush2);\n    __privateAdd(this, _openMark);\n    __privateAdd(this, _closeMark);\n    __privateSet(this, _marks2, _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_1__.Mark.none);\n    __privateSet(this, _matchTarget2, (node) => {\n      const result = Object.values({\n        ...this.schema.nodes,\n        ...this.schema.marks\n      }).find((x) => {\n        const spec = x.spec;\n        return spec.toMarkdown.match(node);\n      });\n      if (!result) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_0__.serializerMatchError)(node.type);\n      return result;\n    });\n    __privateSet(this, _runProseNode, (node) => {\n      const type = __privateGet(this, _matchTarget2).call(this, node);\n      const spec = type.spec;\n      return spec.toMarkdown.runner(this, node);\n    });\n    __privateSet(this, _runProseMark, (mark, node) => {\n      const type = __privateGet(this, _matchTarget2).call(this, mark);\n      const spec = type.spec;\n      return spec.toMarkdown.runner(this, mark, node);\n    });\n    __privateSet(this, _runNode2, (node) => {\n      const { marks } = node;\n      const getPriority = (x) => x.type.spec.priority ?? 50;\n      const tmp = [...marks].sort((a, b) => getPriority(a) - getPriority(b));\n      const unPreventNext = tmp.every((mark) => !__privateGet(this, _runProseMark).call(this, mark, node));\n      if (unPreventNext) __privateGet(this, _runProseNode).call(this, node);\n      marks.forEach((mark) => __privateGet(this, _closeMark).call(this, mark));\n    });\n    __privateSet(this, _searchType, (child, type) => {\n      var _a;\n      if (child.type === type) return child;\n      if (((_a = child.children) == null ? void 0 : _a.length) !== 1) return child;\n      const searchNode = (node2) => {\n        var _a2;\n        if (node2.type === type) return node2;\n        if (((_a2 = node2.children) == null ? void 0 : _a2.length) !== 1) return null;\n        const [firstChild] = node2.children;\n        if (!firstChild) return null;\n        return searchNode(firstChild);\n      };\n      const target = searchNode(child);\n      if (!target) return child;\n      const tmp = target.children ? [...target.children] : void 0;\n      const node = { ...child, children: tmp };\n      node.children = tmp;\n      target.children = [node];\n      return target;\n    });\n    __privateSet(this, _maybeMergeChildren, (node) => {\n      const { children } = node;\n      if (!children) return node;\n      node.children = children.reduce((nextChildren, child, index) => {\n        if (index === 0) return [child];\n        const last = nextChildren.at(-1);\n        if (last && last.isMark && child.isMark) {\n          child = __privateGet(this, _searchType).call(this, child, last.type);\n          const { children: currChildren, ...currRest } = child;\n          const { children: prevChildren, ...prevRest } = last;\n          if (child.type === last.type && currChildren && prevChildren && JSON.stringify(currRest) === JSON.stringify(prevRest)) {\n            const next = {\n              ...prevRest,\n              children: [...prevChildren, ...currChildren]\n            };\n            return nextChildren.slice(0, -1).concat(__privateGet(this, _maybeMergeChildren).call(this, next));\n          }\n        }\n        return nextChildren.concat(child);\n      }, []);\n      return node;\n    });\n    __privateSet(this, _createMarkdownNode, (element) => {\n      const node = {\n        ...element.props,\n        type: element.type\n      };\n      if (element.children) node.children = element.children;\n      if (element.value) node.value = element.value;\n      return node;\n    });\n    this.openNode = (type, value, props) => {\n      this.open(SerializerStackElement.create(type, void 0, value, props));\n      return this;\n    };\n    __privateSet(this, _moveSpaces, (element, onPush) => {\n      let startSpaces = \"\";\n      let endSpaces = \"\";\n      const children = element.children;\n      let first = -1;\n      let last = -1;\n      const findIndex = (node) => {\n        if (!node) return;\n        node.forEach((child, index) => {\n          if (child.type === \"text\" && child.value) {\n            if (first < 0) first = index;\n            last = index;\n          }\n        });\n      };\n      if (children) {\n        findIndex(children);\n        const lastChild = children == null ? void 0 : children[last];\n        const firstChild = children == null ? void 0 : children[first];\n        if (lastChild && lastChild.value.endsWith(\" \")) {\n          endSpaces = lastChild.value.match(/ +$/)[0];\n          lastChild.value = lastChild.value.trimEnd();\n        }\n        if (firstChild && firstChild.value.startsWith(\" \")) {\n          startSpaces = firstChild.value.match(/^ +/)[0];\n          firstChild.value = firstChild.value.trimStart();\n        }\n      }\n      if (startSpaces.length) __privateGet(this, _addNodeAndPush2).call(this, \"text\", void 0, startSpaces);\n      const result = onPush();\n      if (endSpaces.length) __privateGet(this, _addNodeAndPush2).call(this, \"text\", void 0, endSpaces);\n      return result;\n    });\n    __privateSet(this, _closeNodeAndPush2, (trim = false) => {\n      const element = this.close();\n      const onPush = () => __privateGet(this, _addNodeAndPush2).call(this, element.type, element.children, element.value, element.props);\n      if (trim) return __privateGet(this, _moveSpaces).call(this, element, onPush);\n      return onPush();\n    });\n    this.closeNode = () => {\n      __privateGet(this, _closeNodeAndPush2).call(this);\n      return this;\n    };\n    __privateSet(this, _addNodeAndPush2, (type, children, value, props) => {\n      const element = SerializerStackElement.create(type, children, value, props);\n      const node = __privateGet(this, _maybeMergeChildren).call(this, __privateGet(this, _createMarkdownNode).call(this, element));\n      this.push(node);\n      return node;\n    });\n    this.addNode = (type, children, value, props) => {\n      __privateGet(this, _addNodeAndPush2).call(this, type, children, value, props);\n      return this;\n    };\n    __privateSet(this, _openMark, (mark, type, value, props) => {\n      const isIn = mark.isInSet(__privateGet(this, _marks2));\n      if (isIn) return this;\n      __privateSet(this, _marks2, mark.addToSet(__privateGet(this, _marks2)));\n      return this.openNode(type, value, { ...props, isMark: true });\n    });\n    __privateSet(this, _closeMark, (mark) => {\n      const isIn = mark.isInSet(__privateGet(this, _marks2));\n      if (!isIn) return;\n      __privateSet(this, _marks2, mark.type.removeFromSet(__privateGet(this, _marks2)));\n      __privateGet(this, _closeNodeAndPush2).call(this, true);\n    });\n    this.withMark = (mark, type, value, props) => {\n      __privateGet(this, _openMark).call(this, mark, type, value, props);\n      return this;\n    };\n    this.closeMark = (mark) => {\n      __privateGet(this, _closeMark).call(this, mark);\n      return this;\n    };\n    this.build = () => {\n      let doc = null;\n      do\n        doc = __privateGet(this, _closeNodeAndPush2).call(this);\n      while (this.size());\n      return doc;\n    };\n    this.next = (nodes) => {\n      if (isFragment(nodes)) {\n        nodes.forEach((node) => {\n          __privateGet(this, _runNode2).call(this, node);\n        });\n        return this;\n      }\n      __privateGet(this, _runNode2).call(this, nodes);\n      return this;\n    };\n    this.toString = (remark) => remark.stringify(this.build());\n    this.run = (tree) => {\n      this.next(tree);\n      return this;\n    };\n    this.schema = schema;\n  }\n};\n_marks2 = new WeakMap();\n_matchTarget2 = new WeakMap();\n_runProseNode = new WeakMap();\n_runProseMark = new WeakMap();\n_runNode2 = new WeakMap();\n_searchType = new WeakMap();\n_maybeMergeChildren = new WeakMap();\n_createMarkdownNode = new WeakMap();\n_moveSpaces = new WeakMap();\n_closeNodeAndPush2 = new WeakMap();\n_addNodeAndPush2 = new WeakMap();\n_openMark = new WeakMap();\n_closeMark = new WeakMap();\n_SerializerState.create = (schema, remark) => {\n  const state = new _SerializerState(schema);\n  return (content) => {\n    state.run(content);\n    return state.toString(remark);\n  };\n};\nlet SerializerState = _SerializerState;\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3RyYW5zZm9ybWVyL2xpYi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ29IO0FBQ3ZFO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsa0VBQWE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix1REFBSTtBQUNuQztBQUNBO0FBQ0Esc0dBQXNHLHVEQUFJO0FBQzFHO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUCx5QkFBeUIscUVBQWdCO0FBQ3pDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHVEQUFJO0FBQ3JDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwyRUFBc0I7QUFDN0M7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isa0VBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHVEQUFJO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1AseUJBQXlCLHlFQUFvQjtBQUM3QztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsUUFBUTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxjQUFjLFdBQVc7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHNDQUFzQztBQUN4RCxrQkFBa0Isc0NBQXNDO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsd0JBQXdCO0FBQ2xFLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUU7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JhaW4yL0RvY3VtZW50cy9ub3RlQ2FyZC9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3RyYW5zZm9ybWVyL2xpYi9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX190eXBlRXJyb3IgPSAobXNnKSA9PiB7XG4gIHRocm93IFR5cGVFcnJvcihtc2cpO1xufTtcbnZhciBfX2FjY2Vzc0NoZWNrID0gKG9iaiwgbWVtYmVyLCBtc2cpID0+IG1lbWJlci5oYXMob2JqKSB8fCBfX3R5cGVFcnJvcihcIkNhbm5vdCBcIiArIG1zZyk7XG52YXIgX19wcml2YXRlR2V0ID0gKG9iaiwgbWVtYmVyLCBnZXR0ZXIpID0+IChfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcInJlYWQgZnJvbSBwcml2YXRlIGZpZWxkXCIpLCBnZXR0ZXIgPyBnZXR0ZXIuY2FsbChvYmopIDogbWVtYmVyLmdldChvYmopKTtcbnZhciBfX3ByaXZhdGVBZGQgPSAob2JqLCBtZW1iZXIsIHZhbHVlKSA9PiBtZW1iZXIuaGFzKG9iaikgPyBfX3R5cGVFcnJvcihcIkNhbm5vdCBhZGQgdGhlIHNhbWUgcHJpdmF0ZSBtZW1iZXIgbW9yZSB0aGFuIG9uY2VcIikgOiBtZW1iZXIgaW5zdGFuY2VvZiBXZWFrU2V0ID8gbWVtYmVyLmFkZChvYmopIDogbWVtYmVyLnNldChvYmosIHZhbHVlKTtcbnZhciBfX3ByaXZhdGVTZXQgPSAob2JqLCBtZW1iZXIsIHZhbHVlLCBzZXR0ZXIpID0+IChfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcIndyaXRlIHRvIHByaXZhdGUgZmllbGRcIiksIHNldHRlciA/IHNldHRlci5jYWxsKG9iaiwgdmFsdWUpIDogbWVtYmVyLnNldChvYmosIHZhbHVlKSwgdmFsdWUpO1xudmFyIF9tYXJrcywgX2hhc1RleHQsIF9tYXliZU1lcmdlLCBfbWF0Y2hUYXJnZXQsIF9ydW5Ob2RlLCBfY2xvc2VOb2RlQW5kUHVzaCwgX2FkZE5vZGVBbmRQdXNoLCBfbWFya3MyLCBfbWF0Y2hUYXJnZXQyLCBfcnVuUHJvc2VOb2RlLCBfcnVuUHJvc2VNYXJrLCBfcnVuTm9kZTIsIF9zZWFyY2hUeXBlLCBfbWF5YmVNZXJnZUNoaWxkcmVuLCBfY3JlYXRlTWFya2Rvd25Ob2RlLCBfbW92ZVNwYWNlcywgX2Nsb3NlTm9kZUFuZFB1c2gyLCBfYWRkTm9kZUFuZFB1c2gyLCBfb3Blbk1hcmssIF9jbG9zZU1hcms7XG5pbXBvcnQgeyBzdGFja092ZXJGbG93LCBwYXJzZXJNYXRjaEVycm9yLCBjcmVhdGVOb2RlSW5QYXJzZXJGYWlsLCBzZXJpYWxpemVyTWF0Y2hFcnJvciB9IGZyb20gXCJAbWlsa2Rvd24vZXhjZXB0aW9uXCI7XG5pbXBvcnQgeyBNYXJrIH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZS9tb2RlbFwiO1xuY2xhc3MgU3RhY2tFbGVtZW50IHtcbn1cbmNsYXNzIFN0YWNrIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5lbGVtZW50cyA9IFtdO1xuICAgIHRoaXMuc2l6ZSA9ICgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmxlbmd0aDtcbiAgICB9O1xuICAgIHRoaXMudG9wID0gKCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudHMuYXQoLTEpO1xuICAgIH07XG4gICAgdGhpcy5wdXNoID0gKG5vZGUpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIChfYSA9IHRoaXMudG9wKCkpID09IG51bGwgPyB2b2lkIDAgOiBfYS5wdXNoKG5vZGUpO1xuICAgIH07XG4gICAgdGhpcy5vcGVuID0gKG5vZGUpID0+IHtcbiAgICAgIHRoaXMuZWxlbWVudHMucHVzaChub2RlKTtcbiAgICB9O1xuICAgIHRoaXMuY2xvc2UgPSAoKSA9PiB7XG4gICAgICBjb25zdCBlbCA9IHRoaXMuZWxlbWVudHMucG9wKCk7XG4gICAgICBpZiAoIWVsKSB0aHJvdyBzdGFja092ZXJGbG93KCk7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfTtcbiAgfVxufVxuY2xhc3MgUGFyc2VyU3RhY2tFbGVtZW50IGV4dGVuZHMgU3RhY2tFbGVtZW50IHtcbiAgY29uc3RydWN0b3IodHlwZSwgY29udGVudCwgYXR0cnMpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgdGhpcy5jb250ZW50ID0gY29udGVudDtcbiAgICB0aGlzLmF0dHJzID0gYXR0cnM7XG4gIH1cbiAgcHVzaChub2RlLCAuLi5yZXN0KSB7XG4gICAgdGhpcy5jb250ZW50LnB1c2gobm9kZSwgLi4ucmVzdCk7XG4gIH1cbiAgcG9wKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRlbnQucG9wKCk7XG4gIH1cbiAgc3RhdGljIGNyZWF0ZSh0eXBlLCBjb250ZW50LCBhdHRycykge1xuICAgIHJldHVybiBuZXcgUGFyc2VyU3RhY2tFbGVtZW50KHR5cGUsIGNvbnRlbnQsIGF0dHJzKTtcbiAgfVxufVxuY29uc3QgX1BhcnNlclN0YXRlID0gY2xhc3MgX1BhcnNlclN0YXRlIGV4dGVuZHMgU3RhY2sge1xuICAvLy8gQGludGVybmFsXG4gIGNvbnN0cnVjdG9yKHNjaGVtYSkge1xuICAgIHN1cGVyKCk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tYXJrcyk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYXNUZXh0KTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21heWJlTWVyZ2UpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbWF0Y2hUYXJnZXQpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcnVuTm9kZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jbG9zZU5vZGVBbmRQdXNoKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FkZE5vZGVBbmRQdXNoKTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX21hcmtzLCBNYXJrLm5vbmUpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfaGFzVGV4dCwgKG5vZGUpID0+IG5vZGUuaXNUZXh0KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX21heWJlTWVyZ2UsIChhLCBiKSA9PiB7XG4gICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9oYXNUZXh0KS5jYWxsKHRoaXMsIGEpICYmIF9fcHJpdmF0ZUdldCh0aGlzLCBfaGFzVGV4dCkuY2FsbCh0aGlzLCBiKSAmJiBNYXJrLnNhbWVTZXQoYS5tYXJrcywgYi5tYXJrcykpXG4gICAgICAgIHJldHVybiB0aGlzLnNjaGVtYS50ZXh0KGEudGV4dCArIGIudGV4dCwgYS5tYXJrcyk7XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWF0Y2hUYXJnZXQsIChub2RlKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBPYmplY3QudmFsdWVzKHtcbiAgICAgICAgLi4udGhpcy5zY2hlbWEubm9kZXMsXG4gICAgICAgIC4uLnRoaXMuc2NoZW1hLm1hcmtzXG4gICAgICB9KS5maW5kKCh4KSA9PiB7XG4gICAgICAgIGNvbnN0IHNwZWMgPSB4LnNwZWM7XG4gICAgICAgIHJldHVybiBzcGVjLnBhcnNlTWFya2Rvd24ubWF0Y2gobm9kZSk7XG4gICAgICB9KTtcbiAgICAgIGlmICghcmVzdWx0KSB0aHJvdyBwYXJzZXJNYXRjaEVycm9yKG5vZGUpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX3J1bk5vZGUsIChub2RlKSA9PiB7XG4gICAgICBjb25zdCB0eXBlID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXRjaFRhcmdldCkuY2FsbCh0aGlzLCBub2RlKTtcbiAgICAgIGNvbnN0IHNwZWMgPSB0eXBlLnNwZWM7XG4gICAgICBzcGVjLnBhcnNlTWFya2Rvd24ucnVubmVyKHRoaXMsIG5vZGUsIHR5cGUpO1xuICAgIH0pO1xuICAgIHRoaXMuaW5qZWN0Um9vdCA9IChub2RlLCBub2RlVHlwZSwgYXR0cnMpID0+IHtcbiAgICAgIHRoaXMub3Blbk5vZGUobm9kZVR5cGUsIGF0dHJzKTtcbiAgICAgIHRoaXMubmV4dChub2RlLmNoaWxkcmVuKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5vcGVuTm9kZSA9IChub2RlVHlwZSwgYXR0cnMpID0+IHtcbiAgICAgIHRoaXMub3BlbihQYXJzZXJTdGFja0VsZW1lbnQuY3JlYXRlKG5vZGVUeXBlLCBbXSwgYXR0cnMpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jbG9zZU5vZGVBbmRQdXNoLCAoKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21hcmtzLCBNYXJrLm5vbmUpO1xuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuY2xvc2UoKTtcbiAgICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2FkZE5vZGVBbmRQdXNoKS5jYWxsKHRoaXMsIGVsZW1lbnQudHlwZSwgZWxlbWVudC5hdHRycywgZWxlbWVudC5jb250ZW50KTtcbiAgICB9KTtcbiAgICB0aGlzLmNsb3NlTm9kZSA9ICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY2xvc2VOb2RlQW5kUHVzaCkuY2FsbCh0aGlzKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9hZGROb2RlQW5kUHVzaCwgKG5vZGVUeXBlLCBhdHRycywgY29udGVudCkgPT4ge1xuICAgICAgY29uc3Qgbm9kZSA9IG5vZGVUeXBlLmNyZWF0ZUFuZEZpbGwoYXR0cnMsIGNvbnRlbnQsIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya3MpKTtcbiAgICAgIGlmICghbm9kZSkgdGhyb3cgY3JlYXRlTm9kZUluUGFyc2VyRmFpbChub2RlVHlwZSwgYXR0cnMsIGNvbnRlbnQpO1xuICAgICAgdGhpcy5wdXNoKG5vZGUpO1xuICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfSk7XG4gICAgdGhpcy5hZGROb2RlID0gKG5vZGVUeXBlLCBhdHRycywgY29udGVudCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9hZGROb2RlQW5kUHVzaCkuY2FsbCh0aGlzLCBub2RlVHlwZSwgYXR0cnMsIGNvbnRlbnQpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLm9wZW5NYXJrID0gKG1hcmtUeXBlLCBhdHRycykgPT4ge1xuICAgICAgY29uc3QgbWFyayA9IG1hcmtUeXBlLmNyZWF0ZShhdHRycyk7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21hcmtzLCBtYXJrLmFkZFRvU2V0KF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya3MpKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuY2xvc2VNYXJrID0gKG1hcmtUeXBlKSA9PiB7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21hcmtzLCBtYXJrVHlwZS5yZW1vdmVGcm9tU2V0KF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya3MpKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuYWRkVGV4dCA9ICh0ZXh0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB0b3BFbGVtZW50ID0gdGhpcy50b3AoKTtcbiAgICAgICAgaWYgKCF0b3BFbGVtZW50KSB0aHJvdyBzdGFja092ZXJGbG93KCk7XG4gICAgICAgIGNvbnN0IHByZXZOb2RlID0gdG9wRWxlbWVudC5wb3AoKTtcbiAgICAgICAgY29uc3QgY3Vyck5vZGUgPSB0aGlzLnNjaGVtYS50ZXh0KHRleHQsIF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya3MpKTtcbiAgICAgICAgaWYgKCFwcmV2Tm9kZSkge1xuICAgICAgICAgIHRvcEVsZW1lbnQucHVzaChjdXJyTm9kZSk7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWVyZ2VkID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXliZU1lcmdlKS5jYWxsKHRoaXMsIHByZXZOb2RlLCBjdXJyTm9kZSk7XG4gICAgICAgIGlmIChtZXJnZWQpIHtcbiAgICAgICAgICB0b3BFbGVtZW50LnB1c2gobWVyZ2VkKTtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB0b3BFbGVtZW50LnB1c2gocHJldk5vZGUsIGN1cnJOb2RlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5idWlsZCA9ICgpID0+IHtcbiAgICAgIGxldCBkb2M7XG4gICAgICBkb1xuICAgICAgICBkb2MgPSBfX3ByaXZhdGVHZXQodGhpcywgX2Nsb3NlTm9kZUFuZFB1c2gpLmNhbGwodGhpcyk7XG4gICAgICB3aGlsZSAodGhpcy5zaXplKCkpO1xuICAgICAgcmV0dXJuIGRvYztcbiAgICB9O1xuICAgIHRoaXMubmV4dCA9IChub2RlcyA9IFtdKSA9PiB7XG4gICAgICBbbm9kZXNdLmZsYXQoKS5mb3JFYWNoKChub2RlKSA9PiBfX3ByaXZhdGVHZXQodGhpcywgX3J1bk5vZGUpLmNhbGwodGhpcywgbm9kZSkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB0aGlzLnRvRG9jID0gKCkgPT4gdGhpcy5idWlsZCgpO1xuICAgIHRoaXMucnVuID0gKHJlbWFyaywgbWFya2Rvd24pID0+IHtcbiAgICAgIGNvbnN0IHRyZWUgPSByZW1hcmsucnVuU3luYyhcbiAgICAgICAgcmVtYXJrLnBhcnNlKG1hcmtkb3duKSxcbiAgICAgICAgbWFya2Rvd25cbiAgICAgICk7XG4gICAgICB0aGlzLm5leHQodHJlZSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICB9XG59O1xuX21hcmtzID0gbmV3IFdlYWtNYXAoKTtcbl9oYXNUZXh0ID0gbmV3IFdlYWtNYXAoKTtcbl9tYXliZU1lcmdlID0gbmV3IFdlYWtNYXAoKTtcbl9tYXRjaFRhcmdldCA9IG5ldyBXZWFrTWFwKCk7XG5fcnVuTm9kZSA9IG5ldyBXZWFrTWFwKCk7XG5fY2xvc2VOb2RlQW5kUHVzaCA9IG5ldyBXZWFrTWFwKCk7XG5fYWRkTm9kZUFuZFB1c2ggPSBuZXcgV2Vha01hcCgpO1xuX1BhcnNlclN0YXRlLmNyZWF0ZSA9IChzY2hlbWEsIHJlbWFyaykgPT4ge1xuICBjb25zdCBzdGF0ZSA9IG5ldyBfUGFyc2VyU3RhdGUoc2NoZW1hKTtcbiAgcmV0dXJuICh0ZXh0KSA9PiB7XG4gICAgc3RhdGUucnVuKHJlbWFyaywgdGV4dCk7XG4gICAgcmV0dXJuIHN0YXRlLnRvRG9jKCk7XG4gIH07XG59O1xubGV0IFBhcnNlclN0YXRlID0gX1BhcnNlclN0YXRlO1xuY29uc3QgX1NlcmlhbGl6ZXJTdGFja0VsZW1lbnQgPSBjbGFzcyBfU2VyaWFsaXplclN0YWNrRWxlbWVudCBleHRlbmRzIFN0YWNrRWxlbWVudCB7XG4gIGNvbnN0cnVjdG9yKHR5cGUsIGNoaWxkcmVuLCB2YWx1ZSwgcHJvcHMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLmNoaWxkcmVuID0gY2hpbGRyZW47XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMucHJvcHMgPSBwcm9wcztcbiAgICB0aGlzLnB1c2ggPSAobm9kZSwgLi4ucmVzdCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmNoaWxkcmVuKSB0aGlzLmNoaWxkcmVuID0gW107XG4gICAgICB0aGlzLmNoaWxkcmVuLnB1c2gobm9kZSwgLi4ucmVzdCk7XG4gICAgfTtcbiAgICB0aGlzLnBvcCA9ICgpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIHJldHVybiAoX2EgPSB0aGlzLmNoaWxkcmVuKSA9PSBudWxsID8gdm9pZCAwIDogX2EucG9wKCk7XG4gICAgfTtcbiAgfVxufTtcbl9TZXJpYWxpemVyU3RhY2tFbGVtZW50LmNyZWF0ZSA9ICh0eXBlLCBjaGlsZHJlbiwgdmFsdWUsIHByb3BzID0ge30pID0+IG5ldyBfU2VyaWFsaXplclN0YWNrRWxlbWVudCh0eXBlLCBjaGlsZHJlbiwgdmFsdWUsIHByb3BzKTtcbmxldCBTZXJpYWxpemVyU3RhY2tFbGVtZW50ID0gX1NlcmlhbGl6ZXJTdGFja0VsZW1lbnQ7XG5jb25zdCBpc0ZyYWdtZW50ID0gKHgpID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCBcInNpemVcIik7XG5jb25zdCBfU2VyaWFsaXplclN0YXRlID0gY2xhc3MgX1NlcmlhbGl6ZXJTdGF0ZSBleHRlbmRzIFN0YWNrIHtcbiAgLy8vIEBpbnRlcm5hbFxuICBjb25zdHJ1Y3RvcihzY2hlbWEpIHtcbiAgICBzdXBlcigpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbWFya3MyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX21hdGNoVGFyZ2V0Mik7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9ydW5Qcm9zZU5vZGUpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcnVuUHJvc2VNYXJrKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3J1bk5vZGUyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX3NlYXJjaFR5cGUpO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfbWF5YmVNZXJnZUNoaWxkcmVuKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2NyZWF0ZU1hcmtkb3duTm9kZSk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tb3ZlU3BhY2VzKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2Nsb3NlTm9kZUFuZFB1c2gyKTtcbiAgICBfX3ByaXZhdGVBZGQodGhpcywgX2FkZE5vZGVBbmRQdXNoMik7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9vcGVuTWFyayk7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jbG9zZU1hcmspO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFya3MyLCBNYXJrLm5vbmUpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWF0Y2hUYXJnZXQyLCAobm9kZSkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gT2JqZWN0LnZhbHVlcyh7XG4gICAgICAgIC4uLnRoaXMuc2NoZW1hLm5vZGVzLFxuICAgICAgICAuLi50aGlzLnNjaGVtYS5tYXJrc1xuICAgICAgfSkuZmluZCgoeCkgPT4ge1xuICAgICAgICBjb25zdCBzcGVjID0geC5zcGVjO1xuICAgICAgICByZXR1cm4gc3BlYy50b01hcmtkb3duLm1hdGNoKG5vZGUpO1xuICAgICAgfSk7XG4gICAgICBpZiAoIXJlc3VsdCkgdGhyb3cgc2VyaWFsaXplck1hdGNoRXJyb3Iobm9kZS50eXBlKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9ydW5Qcm9zZU5vZGUsIChub2RlKSA9PiB7XG4gICAgICBjb25zdCB0eXBlID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXRjaFRhcmdldDIpLmNhbGwodGhpcywgbm9kZSk7XG4gICAgICBjb25zdCBzcGVjID0gdHlwZS5zcGVjO1xuICAgICAgcmV0dXJuIHNwZWMudG9NYXJrZG93bi5ydW5uZXIodGhpcywgbm9kZSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9ydW5Qcm9zZU1hcmssIChtYXJrLCBub2RlKSA9PiB7XG4gICAgICBjb25zdCB0eXBlID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXRjaFRhcmdldDIpLmNhbGwodGhpcywgbWFyayk7XG4gICAgICBjb25zdCBzcGVjID0gdHlwZS5zcGVjO1xuICAgICAgcmV0dXJuIHNwZWMudG9NYXJrZG93bi5ydW5uZXIodGhpcywgbWFyaywgbm9kZSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9ydW5Ob2RlMiwgKG5vZGUpID0+IHtcbiAgICAgIGNvbnN0IHsgbWFya3MgfSA9IG5vZGU7XG4gICAgICBjb25zdCBnZXRQcmlvcml0eSA9ICh4KSA9PiB4LnR5cGUuc3BlYy5wcmlvcml0eSA/PyA1MDtcbiAgICAgIGNvbnN0IHRtcCA9IFsuLi5tYXJrc10uc29ydCgoYSwgYikgPT4gZ2V0UHJpb3JpdHkoYSkgLSBnZXRQcmlvcml0eShiKSk7XG4gICAgICBjb25zdCB1blByZXZlbnROZXh0ID0gdG1wLmV2ZXJ5KChtYXJrKSA9PiAhX19wcml2YXRlR2V0KHRoaXMsIF9ydW5Qcm9zZU1hcmspLmNhbGwodGhpcywgbWFyaywgbm9kZSkpO1xuICAgICAgaWYgKHVuUHJldmVudE5leHQpIF9fcHJpdmF0ZUdldCh0aGlzLCBfcnVuUHJvc2VOb2RlKS5jYWxsKHRoaXMsIG5vZGUpO1xuICAgICAgbWFya3MuZm9yRWFjaCgobWFyaykgPT4gX19wcml2YXRlR2V0KHRoaXMsIF9jbG9zZU1hcmspLmNhbGwodGhpcywgbWFyaykpO1xuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfc2VhcmNoVHlwZSwgKGNoaWxkLCB0eXBlKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICBpZiAoY2hpbGQudHlwZSA9PT0gdHlwZSkgcmV0dXJuIGNoaWxkO1xuICAgICAgaWYgKCgoX2EgPSBjaGlsZC5jaGlsZHJlbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgIT09IDEpIHJldHVybiBjaGlsZDtcbiAgICAgIGNvbnN0IHNlYXJjaE5vZGUgPSAobm9kZTIpID0+IHtcbiAgICAgICAgdmFyIF9hMjtcbiAgICAgICAgaWYgKG5vZGUyLnR5cGUgPT09IHR5cGUpIHJldHVybiBub2RlMjtcbiAgICAgICAgaWYgKCgoX2EyID0gbm9kZTIuY2hpbGRyZW4pID09IG51bGwgPyB2b2lkIDAgOiBfYTIubGVuZ3RoKSAhPT0gMSkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IFtmaXJzdENoaWxkXSA9IG5vZGUyLmNoaWxkcmVuO1xuICAgICAgICBpZiAoIWZpcnN0Q2hpbGQpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gc2VhcmNoTm9kZShmaXJzdENoaWxkKTtcbiAgICAgIH07XG4gICAgICBjb25zdCB0YXJnZXQgPSBzZWFyY2hOb2RlKGNoaWxkKTtcbiAgICAgIGlmICghdGFyZ2V0KSByZXR1cm4gY2hpbGQ7XG4gICAgICBjb25zdCB0bXAgPSB0YXJnZXQuY2hpbGRyZW4gPyBbLi4udGFyZ2V0LmNoaWxkcmVuXSA6IHZvaWQgMDtcbiAgICAgIGNvbnN0IG5vZGUgPSB7IC4uLmNoaWxkLCBjaGlsZHJlbjogdG1wIH07XG4gICAgICBub2RlLmNoaWxkcmVuID0gdG1wO1xuICAgICAgdGFyZ2V0LmNoaWxkcmVuID0gW25vZGVdO1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9KTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX21heWJlTWVyZ2VDaGlsZHJlbiwgKG5vZGUpID0+IHtcbiAgICAgIGNvbnN0IHsgY2hpbGRyZW4gfSA9IG5vZGU7XG4gICAgICBpZiAoIWNoaWxkcmVuKSByZXR1cm4gbm9kZTtcbiAgICAgIG5vZGUuY2hpbGRyZW4gPSBjaGlsZHJlbi5yZWR1Y2UoKG5leHRDaGlsZHJlbiwgY2hpbGQsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkgcmV0dXJuIFtjaGlsZF07XG4gICAgICAgIGNvbnN0IGxhc3QgPSBuZXh0Q2hpbGRyZW4uYXQoLTEpO1xuICAgICAgICBpZiAobGFzdCAmJiBsYXN0LmlzTWFyayAmJiBjaGlsZC5pc01hcmspIHtcbiAgICAgICAgICBjaGlsZCA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfc2VhcmNoVHlwZSkuY2FsbCh0aGlzLCBjaGlsZCwgbGFzdC50eXBlKTtcbiAgICAgICAgICBjb25zdCB7IGNoaWxkcmVuOiBjdXJyQ2hpbGRyZW4sIC4uLmN1cnJSZXN0IH0gPSBjaGlsZDtcbiAgICAgICAgICBjb25zdCB7IGNoaWxkcmVuOiBwcmV2Q2hpbGRyZW4sIC4uLnByZXZSZXN0IH0gPSBsYXN0O1xuICAgICAgICAgIGlmIChjaGlsZC50eXBlID09PSBsYXN0LnR5cGUgJiYgY3VyckNoaWxkcmVuICYmIHByZXZDaGlsZHJlbiAmJiBKU09OLnN0cmluZ2lmeShjdXJyUmVzdCkgPT09IEpTT04uc3RyaW5naWZ5KHByZXZSZXN0KSkge1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9IHtcbiAgICAgICAgICAgICAgLi4ucHJldlJlc3QsXG4gICAgICAgICAgICAgIGNoaWxkcmVuOiBbLi4ucHJldkNoaWxkcmVuLCAuLi5jdXJyQ2hpbGRyZW5dXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG5leHRDaGlsZHJlbi5zbGljZSgwLCAtMSkuY29uY2F0KF9fcHJpdmF0ZUdldCh0aGlzLCBfbWF5YmVNZXJnZUNoaWxkcmVuKS5jYWxsKHRoaXMsIG5leHQpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5leHRDaGlsZHJlbi5jb25jYXQoY2hpbGQpO1xuICAgICAgfSwgW10pO1xuICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jcmVhdGVNYXJrZG93bk5vZGUsIChlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCBub2RlID0ge1xuICAgICAgICAuLi5lbGVtZW50LnByb3BzLFxuICAgICAgICB0eXBlOiBlbGVtZW50LnR5cGVcbiAgICAgIH07XG4gICAgICBpZiAoZWxlbWVudC5jaGlsZHJlbikgbm9kZS5jaGlsZHJlbiA9IGVsZW1lbnQuY2hpbGRyZW47XG4gICAgICBpZiAoZWxlbWVudC52YWx1ZSkgbm9kZS52YWx1ZSA9IGVsZW1lbnQudmFsdWU7XG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9KTtcbiAgICB0aGlzLm9wZW5Ob2RlID0gKHR5cGUsIHZhbHVlLCBwcm9wcykgPT4ge1xuICAgICAgdGhpcy5vcGVuKFNlcmlhbGl6ZXJTdGFja0VsZW1lbnQuY3JlYXRlKHR5cGUsIHZvaWQgMCwgdmFsdWUsIHByb3BzKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbW92ZVNwYWNlcywgKGVsZW1lbnQsIG9uUHVzaCkgPT4ge1xuICAgICAgbGV0IHN0YXJ0U3BhY2VzID0gXCJcIjtcbiAgICAgIGxldCBlbmRTcGFjZXMgPSBcIlwiO1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSBlbGVtZW50LmNoaWxkcmVuO1xuICAgICAgbGV0IGZpcnN0ID0gLTE7XG4gICAgICBsZXQgbGFzdCA9IC0xO1xuICAgICAgY29uc3QgZmluZEluZGV4ID0gKG5vZGUpID0+IHtcbiAgICAgICAgaWYgKCFub2RlKSByZXR1cm47XG4gICAgICAgIG5vZGUuZm9yRWFjaCgoY2hpbGQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKGNoaWxkLnR5cGUgPT09IFwidGV4dFwiICYmIGNoaWxkLnZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoZmlyc3QgPCAwKSBmaXJzdCA9IGluZGV4O1xuICAgICAgICAgICAgbGFzdCA9IGluZGV4O1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgaWYgKGNoaWxkcmVuKSB7XG4gICAgICAgIGZpbmRJbmRleChjaGlsZHJlbik7XG4gICAgICAgIGNvbnN0IGxhc3RDaGlsZCA9IGNoaWxkcmVuID09IG51bGwgPyB2b2lkIDAgOiBjaGlsZHJlbltsYXN0XTtcbiAgICAgICAgY29uc3QgZmlyc3RDaGlsZCA9IGNoaWxkcmVuID09IG51bGwgPyB2b2lkIDAgOiBjaGlsZHJlbltmaXJzdF07XG4gICAgICAgIGlmIChsYXN0Q2hpbGQgJiYgbGFzdENoaWxkLnZhbHVlLmVuZHNXaXRoKFwiIFwiKSkge1xuICAgICAgICAgIGVuZFNwYWNlcyA9IGxhc3RDaGlsZC52YWx1ZS5tYXRjaCgvICskLylbMF07XG4gICAgICAgICAgbGFzdENoaWxkLnZhbHVlID0gbGFzdENoaWxkLnZhbHVlLnRyaW1FbmQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlyc3RDaGlsZCAmJiBmaXJzdENoaWxkLnZhbHVlLnN0YXJ0c1dpdGgoXCIgXCIpKSB7XG4gICAgICAgICAgc3RhcnRTcGFjZXMgPSBmaXJzdENoaWxkLnZhbHVlLm1hdGNoKC9eICsvKVswXTtcbiAgICAgICAgICBmaXJzdENoaWxkLnZhbHVlID0gZmlyc3RDaGlsZC52YWx1ZS50cmltU3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHN0YXJ0U3BhY2VzLmxlbmd0aCkgX19wcml2YXRlR2V0KHRoaXMsIF9hZGROb2RlQW5kUHVzaDIpLmNhbGwodGhpcywgXCJ0ZXh0XCIsIHZvaWQgMCwgc3RhcnRTcGFjZXMpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gb25QdXNoKCk7XG4gICAgICBpZiAoZW5kU3BhY2VzLmxlbmd0aCkgX19wcml2YXRlR2V0KHRoaXMsIF9hZGROb2RlQW5kUHVzaDIpLmNhbGwodGhpcywgXCJ0ZXh0XCIsIHZvaWQgMCwgZW5kU3BhY2VzKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jbG9zZU5vZGVBbmRQdXNoMiwgKHRyaW0gPSBmYWxzZSkgPT4ge1xuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuY2xvc2UoKTtcbiAgICAgIGNvbnN0IG9uUHVzaCA9ICgpID0+IF9fcHJpdmF0ZUdldCh0aGlzLCBfYWRkTm9kZUFuZFB1c2gyKS5jYWxsKHRoaXMsIGVsZW1lbnQudHlwZSwgZWxlbWVudC5jaGlsZHJlbiwgZWxlbWVudC52YWx1ZSwgZWxlbWVudC5wcm9wcyk7XG4gICAgICBpZiAodHJpbSkgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfbW92ZVNwYWNlcykuY2FsbCh0aGlzLCBlbGVtZW50LCBvblB1c2gpO1xuICAgICAgcmV0dXJuIG9uUHVzaCgpO1xuICAgIH0pO1xuICAgIHRoaXMuY2xvc2VOb2RlID0gKCkgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9jbG9zZU5vZGVBbmRQdXNoMikuY2FsbCh0aGlzKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9hZGROb2RlQW5kUHVzaDIsICh0eXBlLCBjaGlsZHJlbiwgdmFsdWUsIHByb3BzKSA9PiB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gU2VyaWFsaXplclN0YWNrRWxlbWVudC5jcmVhdGUodHlwZSwgY2hpbGRyZW4sIHZhbHVlLCBwcm9wcyk7XG4gICAgICBjb25zdCBub2RlID0gX19wcml2YXRlR2V0KHRoaXMsIF9tYXliZU1lcmdlQ2hpbGRyZW4pLmNhbGwodGhpcywgX19wcml2YXRlR2V0KHRoaXMsIF9jcmVhdGVNYXJrZG93bk5vZGUpLmNhbGwodGhpcywgZWxlbWVudCkpO1xuICAgICAgdGhpcy5wdXNoKG5vZGUpO1xuICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfSk7XG4gICAgdGhpcy5hZGROb2RlID0gKHR5cGUsIGNoaWxkcmVuLCB2YWx1ZSwgcHJvcHMpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfYWRkTm9kZUFuZFB1c2gyKS5jYWxsKHRoaXMsIHR5cGUsIGNoaWxkcmVuLCB2YWx1ZSwgcHJvcHMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBfX3ByaXZhdGVTZXQodGhpcywgX29wZW5NYXJrLCAobWFyaywgdHlwZSwgdmFsdWUsIHByb3BzKSA9PiB7XG4gICAgICBjb25zdCBpc0luID0gbWFyay5pc0luU2V0KF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya3MyKSk7XG4gICAgICBpZiAoaXNJbikgcmV0dXJuIHRoaXM7XG4gICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21hcmtzMiwgbWFyay5hZGRUb1NldChfX3ByaXZhdGVHZXQodGhpcywgX21hcmtzMikpKTtcbiAgICAgIHJldHVybiB0aGlzLm9wZW5Ob2RlKHR5cGUsIHZhbHVlLCB7IC4uLnByb3BzLCBpc01hcms6IHRydWUgfSk7XG4gICAgfSk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9jbG9zZU1hcmssIChtYXJrKSA9PiB7XG4gICAgICBjb25zdCBpc0luID0gbWFyay5pc0luU2V0KF9fcHJpdmF0ZUdldCh0aGlzLCBfbWFya3MyKSk7XG4gICAgICBpZiAoIWlzSW4pIHJldHVybjtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWFya3MyLCBtYXJrLnR5cGUucmVtb3ZlRnJvbVNldChfX3ByaXZhdGVHZXQodGhpcywgX21hcmtzMikpKTtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfY2xvc2VOb2RlQW5kUHVzaDIpLmNhbGwodGhpcywgdHJ1ZSk7XG4gICAgfSk7XG4gICAgdGhpcy53aXRoTWFyayA9IChtYXJrLCB0eXBlLCB2YWx1ZSwgcHJvcHMpID0+IHtcbiAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfb3Blbk1hcmspLmNhbGwodGhpcywgbWFyaywgdHlwZSwgdmFsdWUsIHByb3BzKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy5jbG9zZU1hcmsgPSAobWFyaykgPT4ge1xuICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9jbG9zZU1hcmspLmNhbGwodGhpcywgbWFyayk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuYnVpbGQgPSAoKSA9PiB7XG4gICAgICBsZXQgZG9jID0gbnVsbDtcbiAgICAgIGRvXG4gICAgICAgIGRvYyA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfY2xvc2VOb2RlQW5kUHVzaDIpLmNhbGwodGhpcyk7XG4gICAgICB3aGlsZSAodGhpcy5zaXplKCkpO1xuICAgICAgcmV0dXJuIGRvYztcbiAgICB9O1xuICAgIHRoaXMubmV4dCA9IChub2RlcykgPT4ge1xuICAgICAgaWYgKGlzRnJhZ21lbnQobm9kZXMpKSB7XG4gICAgICAgIG5vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3J1bk5vZGUyKS5jYWxsKHRoaXMsIG5vZGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBfX3ByaXZhdGVHZXQodGhpcywgX3J1bk5vZGUyKS5jYWxsKHRoaXMsIG5vZGVzKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgdGhpcy50b1N0cmluZyA9IChyZW1hcmspID0+IHJlbWFyay5zdHJpbmdpZnkodGhpcy5idWlsZCgpKTtcbiAgICB0aGlzLnJ1biA9ICh0cmVlKSA9PiB7XG4gICAgICB0aGlzLm5leHQodHJlZSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICB9XG59O1xuX21hcmtzMiA9IG5ldyBXZWFrTWFwKCk7XG5fbWF0Y2hUYXJnZXQyID0gbmV3IFdlYWtNYXAoKTtcbl9ydW5Qcm9zZU5vZGUgPSBuZXcgV2Vha01hcCgpO1xuX3J1blByb3NlTWFyayA9IG5ldyBXZWFrTWFwKCk7XG5fcnVuTm9kZTIgPSBuZXcgV2Vha01hcCgpO1xuX3NlYXJjaFR5cGUgPSBuZXcgV2Vha01hcCgpO1xuX21heWJlTWVyZ2VDaGlsZHJlbiA9IG5ldyBXZWFrTWFwKCk7XG5fY3JlYXRlTWFya2Rvd25Ob2RlID0gbmV3IFdlYWtNYXAoKTtcbl9tb3ZlU3BhY2VzID0gbmV3IFdlYWtNYXAoKTtcbl9jbG9zZU5vZGVBbmRQdXNoMiA9IG5ldyBXZWFrTWFwKCk7XG5fYWRkTm9kZUFuZFB1c2gyID0gbmV3IFdlYWtNYXAoKTtcbl9vcGVuTWFyayA9IG5ldyBXZWFrTWFwKCk7XG5fY2xvc2VNYXJrID0gbmV3IFdlYWtNYXAoKTtcbl9TZXJpYWxpemVyU3RhdGUuY3JlYXRlID0gKHNjaGVtYSwgcmVtYXJrKSA9PiB7XG4gIGNvbnN0IHN0YXRlID0gbmV3IF9TZXJpYWxpemVyU3RhdGUoc2NoZW1hKTtcbiAgcmV0dXJuIChjb250ZW50KSA9PiB7XG4gICAgc3RhdGUucnVuKGNvbnRlbnQpO1xuICAgIHJldHVybiBzdGF0ZS50b1N0cmluZyhyZW1hcmspO1xuICB9O1xufTtcbmxldCBTZXJpYWxpemVyU3RhdGUgPSBfU2VyaWFsaXplclN0YXRlO1xuZXhwb3J0IHtcbiAgUGFyc2VyU3RhdGUsXG4gIFNlcmlhbGl6ZXJTdGF0ZSxcbiAgU3RhY2ssXG4gIFN0YWNrRWxlbWVudFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/transformer/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/utils/lib/index.js":
/*!***************************************************!*\
  !*** ./node_modules/@milkdown/utils/lib/index.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   $command: () => (/* binding */ $command),\n/* harmony export */   $commandAsync: () => (/* binding */ $commandAsync),\n/* harmony export */   $ctx: () => (/* binding */ $ctx),\n/* harmony export */   $inputRule: () => (/* binding */ $inputRule),\n/* harmony export */   $inputRuleAsync: () => (/* binding */ $inputRuleAsync),\n/* harmony export */   $mark: () => (/* binding */ $mark),\n/* harmony export */   $markAsync: () => (/* binding */ $markAsync),\n/* harmony export */   $markAttr: () => (/* binding */ $markAttr),\n/* harmony export */   $markSchema: () => (/* binding */ $markSchema),\n/* harmony export */   $node: () => (/* binding */ $node),\n/* harmony export */   $nodeAsync: () => (/* binding */ $nodeAsync),\n/* harmony export */   $nodeAttr: () => (/* binding */ $nodeAttr),\n/* harmony export */   $nodeSchema: () => (/* binding */ $nodeSchema),\n/* harmony export */   $prose: () => (/* binding */ $prose),\n/* harmony export */   $proseAsync: () => (/* binding */ $proseAsync),\n/* harmony export */   $remark: () => (/* binding */ $remark),\n/* harmony export */   $shortcut: () => (/* binding */ $shortcut),\n/* harmony export */   $shortcutAsync: () => (/* binding */ $shortcutAsync),\n/* harmony export */   $useKeymap: () => (/* binding */ $useKeymap),\n/* harmony export */   $view: () => (/* binding */ $view),\n/* harmony export */   $viewAsync: () => (/* binding */ $viewAsync),\n/* harmony export */   addTimer: () => (/* binding */ addTimer),\n/* harmony export */   callCommand: () => (/* binding */ callCommand),\n/* harmony export */   forceUpdate: () => (/* binding */ forceUpdate),\n/* harmony export */   getHTML: () => (/* binding */ getHTML),\n/* harmony export */   getMarkdown: () => (/* binding */ getMarkdown),\n/* harmony export */   insert: () => (/* binding */ insert),\n/* harmony export */   nanoid: () => (/* binding */ nanoid),\n/* harmony export */   outline: () => (/* binding */ outline),\n/* harmony export */   pipe: () => (/* binding */ pipe),\n/* harmony export */   replaceAll: () => (/* binding */ replaceAll),\n/* harmony export */   setAttr: () => (/* binding */ setAttr)\n/* harmony export */ });\n/* harmony import */ var _milkdown_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @milkdown/core */ \"(ssr)/./node_modules/@milkdown/core/lib/index.js\");\n/* harmony import */ var _milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @milkdown/ctx */ \"(ssr)/./node_modules/@milkdown/ctx/lib/index.js\");\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nanoid */ \"(ssr)/./node_modules/@milkdown/utils/node_modules/nanoid/index.js\");\n/* harmony import */ var _milkdown_exception__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @milkdown/exception */ \"(ssr)/./node_modules/@milkdown/exception/lib/index.js\");\n/* harmony import */ var _milkdown_prose_keymap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @milkdown/prose/keymap */ \"(ssr)/./node_modules/prosemirror-keymap/dist/index.js\");\n/* harmony import */ var _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @milkdown/prose/model */ \"(ssr)/./node_modules/prosemirror-model/dist/index.js\");\n/* harmony import */ var _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @milkdown/prose/state */ \"(ssr)/./node_modules/prosemirror-state/dist/index.js\");\n\n\n\n\n\n\n\nconst nanoid = (0,nanoid__WEBPACK_IMPORTED_MODULE_0__.customAlphabet)(\"abcedfghicklmn\", 10);\nfunction addTimer(runner, injectTo, timerName) {\n  const timer = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__.createTimer)(timerName || nanoid());\n  let doneCalled = false;\n  const plugin = (ctx) => {\n    ctx.record(timer);\n    ctx.update(injectTo, (x) => x.concat(timer));\n    return async () => {\n      const done = () => {\n        ctx.done(timer);\n        doneCalled = true;\n      };\n      const cleanup = await runner(ctx, plugin, done);\n      if (!doneCalled) ctx.done(timer);\n      return () => {\n        ctx.update(injectTo, (x) => x.filter((y) => y !== timer));\n        ctx.clearTimer(timer);\n        if (cleanup) {\n          const result = cleanup();\n          if (result && \"then\" in result) {\n            result.catch(console.error);\n          }\n        }\n      };\n    };\n  };\n  plugin.timer = timer;\n  return plugin;\n}\nfunction $command(key, cmd) {\n  const cmdKey = (0,_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.createCmdKey)(key);\n  const plugin = (ctx) => async () => {\n    plugin.key = cmdKey;\n    await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.CommandsReady);\n    const command = cmd(ctx);\n    ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).create(cmdKey, command);\n    plugin.run = (payload) => ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).call(key, payload);\n    return () => {\n      ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).remove(cmdKey);\n    };\n  };\n  return plugin;\n}\nfunction $commandAsync(key, cmd, timerName) {\n  const cmdKey = (0,_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.createCmdKey)(key);\n  return addTimer(\n    async (ctx, plugin) => {\n      await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.CommandsReady);\n      const command = await cmd(ctx);\n      ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).create(cmdKey, command);\n      plugin.run = (payload) => ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).call(key, payload);\n      plugin.key = cmdKey;\n      return () => {\n        ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).remove(cmdKey);\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsTimerCtx,\n    timerName\n  );\n}\nfunction $inputRule(inputRule) {\n  const plugin = (ctx) => async () => {\n    await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n    const ir = inputRule(ctx);\n    ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.inputRulesCtx, (irs) => [...irs, ir]);\n    plugin.inputRule = ir;\n    return () => {\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.inputRulesCtx, (irs) => irs.filter((x) => x !== ir));\n    };\n  };\n  return plugin;\n}\nfunction $inputRuleAsync(inputRule, timerName) {\n  return addTimer(\n    async (ctx, plugin) => {\n      await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n      const ir = await inputRule(ctx);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.inputRulesCtx, (irs) => [...irs, ir]);\n      plugin.inputRule = ir;\n      return () => {\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.inputRulesCtx, (irs) => irs.filter((x) => x !== ir));\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorStateTimerCtx,\n    timerName\n  );\n}\nfunction $mark(id, schema) {\n  const plugin = (ctx) => async () => {\n    const markSchema = schema(ctx);\n    ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.marksCtx, (ns) => [\n      ...ns.filter((n) => n[0] !== id),\n      [id, markSchema]\n    ]);\n    plugin.id = id;\n    plugin.schema = markSchema;\n    return () => {\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.marksCtx, (ns) => ns.filter(([x]) => x !== id));\n    };\n  };\n  plugin.type = (ctx) => {\n    const markType = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaCtx).marks[id];\n    if (!markType) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__.missingMarkInSchema)(id);\n    return markType;\n  };\n  return plugin;\n}\nfunction $markAsync(id, schema, timerName) {\n  const plugin = addTimer(\n    async (ctx, plugin2, done) => {\n      const markSchema = await schema(ctx);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.marksCtx, (ns) => [\n        ...ns.filter((n) => n[0] !== id),\n        [id, markSchema]\n      ]);\n      plugin2.id = id;\n      plugin2.schema = markSchema;\n      done();\n      return () => {\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.marksCtx, (ns) => ns.filter(([x]) => x !== id));\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaTimerCtx,\n    timerName\n  );\n  plugin.type = (ctx) => {\n    const markType = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaCtx).marks[id];\n    if (!markType) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__.missingMarkInSchema)(id);\n    return markType;\n  };\n  return plugin;\n}\nfunction $node(id, schema) {\n  const plugin = (ctx) => async () => {\n    const nodeSchema = schema(ctx);\n    ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodesCtx, (ns) => [\n      ...ns.filter((n) => n[0] !== id),\n      [id, nodeSchema]\n    ]);\n    plugin.id = id;\n    plugin.schema = nodeSchema;\n    return () => {\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodesCtx, (ns) => ns.filter(([x]) => x !== id));\n    };\n  };\n  plugin.type = (ctx) => {\n    const nodeType = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaCtx).nodes[id];\n    if (!nodeType) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__.missingNodeInSchema)(id);\n    return nodeType;\n  };\n  return plugin;\n}\nfunction $nodeAsync(id, schema, timerName) {\n  const plugin = addTimer(\n    async (ctx, plugin2, done) => {\n      const nodeSchema = await schema(ctx);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodesCtx, (ns) => [\n        ...ns.filter((n) => n[0] !== id),\n        [id, nodeSchema]\n      ]);\n      plugin2.id = id;\n      plugin2.schema = nodeSchema;\n      done();\n      return () => {\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodesCtx, (ns) => ns.filter(([x]) => x !== id));\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaTimerCtx,\n    timerName\n  );\n  plugin.type = (ctx) => {\n    const nodeType = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaCtx).nodes[id];\n    if (!nodeType) throw (0,_milkdown_exception__WEBPACK_IMPORTED_MODULE_3__.missingNodeInSchema)(id);\n    return nodeType;\n  };\n  return plugin;\n}\nfunction $prose(prose) {\n  let prosePlugin;\n  const plugin = (ctx) => async () => {\n    await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n    prosePlugin = prose(ctx);\n    ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => [...ps, prosePlugin]);\n    return () => {\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => ps.filter((x) => x !== prosePlugin));\n    };\n  };\n  plugin.plugin = () => prosePlugin;\n  plugin.key = () => prosePlugin.spec.key;\n  return plugin;\n}\nfunction $proseAsync(prose, timerName) {\n  let prosePlugin;\n  const plugin = addTimer(\n    async (ctx) => {\n      await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n      prosePlugin = await prose(ctx);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => [...ps, prosePlugin]);\n      return () => {\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => ps.filter((x) => x !== prosePlugin));\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorStateTimerCtx,\n    timerName\n  );\n  plugin.plugin = () => prosePlugin;\n  plugin.key = () => prosePlugin.spec.key;\n  return plugin;\n}\nfunction $shortcut(shortcut) {\n  const plugin = (ctx) => async () => {\n    await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n    const k = shortcut(ctx);\n    const keymapPlugin = (0,_milkdown_prose_keymap__WEBPACK_IMPORTED_MODULE_4__.keymap)(k);\n    ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => [...ps, keymapPlugin]);\n    plugin.keymap = k;\n    return () => {\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => ps.filter((x) => x !== keymapPlugin));\n    };\n  };\n  return plugin;\n}\nfunction $shortcutAsync(shortcut, timerName) {\n  return addTimer(\n    async (ctx, plugin) => {\n      await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n      const k = await shortcut(ctx);\n      const keymapPlugin = (0,_milkdown_prose_keymap__WEBPACK_IMPORTED_MODULE_4__.keymap)(k);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx, (ps) => [...ps, keymapPlugin]);\n      plugin.keymap = k;\n      return () => {\n        ctx.update(\n          _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx,\n          (ps) => ps.filter((x) => x !== keymapPlugin)\n        );\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorStateTimerCtx,\n    timerName\n  );\n}\nfunction $view(type, view) {\n  const plugin = (ctx) => async () => {\n    await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n    const v = view(ctx);\n    if (type.type(ctx) instanceof _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.NodeType)\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodeViewCtx, (ps) => [\n        ...ps,\n        [type.id, v]\n      ]);\n    else\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.markViewCtx, (ps) => [\n        ...ps,\n        [type.id, v]\n      ]);\n    plugin.view = v;\n    plugin.type = type;\n    return () => {\n      if (type.type(ctx) instanceof _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.NodeType)\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodeViewCtx, (ps) => ps.filter((x) => x[0] !== type.id));\n      else ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.markViewCtx, (ps) => ps.filter((x) => x[0] !== type.id));\n    };\n  };\n  return plugin;\n}\nfunction $viewAsync(type, view, timerName) {\n  return addTimer(\n    async (ctx, plugin) => {\n      await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.SchemaReady);\n      const v = await view(ctx);\n      if (type.type(ctx) instanceof _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.NodeType)\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodeViewCtx, (ps) => [\n          ...ps,\n          [type.id, v]\n        ]);\n      else\n        ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.markViewCtx, (ps) => [\n          ...ps,\n          [type.id, v]\n        ]);\n      plugin.view = v;\n      plugin.type = type;\n      return () => {\n        if (type.type(ctx) instanceof _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.NodeType)\n          ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodeViewCtx, (ps) => ps.filter((x) => x[0] !== type.id));\n        else ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.markViewCtx, (ps) => ps.filter((x) => x[0] !== type.id));\n      };\n    },\n    _milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewTimerCtx,\n    timerName\n  );\n}\nfunction $ctx(value, name) {\n  const slice = (0,_milkdown_ctx__WEBPACK_IMPORTED_MODULE_1__.createSlice)(value, name);\n  const plugin = (ctx) => {\n    ctx.inject(slice);\n    return () => {\n      return () => {\n        ctx.remove(slice);\n      };\n    };\n  };\n  plugin.key = slice;\n  return plugin;\n}\nfunction $nodeSchema(id, schema) {\n  const schemaCtx2 = $ctx(schema, id);\n  const nodeSchema = $node(id, (ctx) => {\n    const userSchema = ctx.get(schemaCtx2.key);\n    return userSchema(ctx);\n  });\n  const result = [schemaCtx2, nodeSchema];\n  result.id = nodeSchema.id;\n  result.node = nodeSchema;\n  result.type = (ctx) => nodeSchema.type(ctx);\n  result.schema = nodeSchema.schema;\n  result.ctx = schemaCtx2;\n  result.key = schemaCtx2.key;\n  result.extendSchema = (handler) => {\n    return (ctx) => () => {\n      const prev = ctx.get(schemaCtx2.key);\n      const next = handler(prev);\n      const nodeSchema2 = next(ctx);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.nodesCtx, (ns) => [\n        ...ns.filter((n) => n[0] !== id),\n        [id, nodeSchema2]\n      ]);\n      result.schema = nodeSchema2;\n    };\n  };\n  return result;\n}\nfunction $markSchema(id, schema) {\n  const schemaCtx2 = $ctx(schema, id);\n  const markSchema = $mark(id, (ctx) => {\n    const userSchema = ctx.get(schemaCtx2.key);\n    return userSchema(ctx);\n  });\n  const result = [schemaCtx2, markSchema];\n  result.id = markSchema.id;\n  result.mark = markSchema;\n  result.type = markSchema.type;\n  result.schema = markSchema.schema;\n  result.ctx = schemaCtx2;\n  result.key = schemaCtx2.key;\n  result.extendSchema = (handler) => {\n    return (ctx) => () => {\n      const prev = ctx.get(schemaCtx2.key);\n      const next = handler(prev);\n      const markSchema2 = next(ctx);\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.marksCtx, (ms) => [\n        ...ms.filter((m) => m[0] !== id),\n        [id, markSchema2]\n      ]);\n      result.schema = markSchema2;\n    };\n  };\n  return result;\n}\nfunction $useKeymap(name, userKeymap) {\n  const key = Object.fromEntries(\n    Object.entries(userKeymap).map(([key2, { shortcuts: shortcuts2 }]) => {\n      return [key2, shortcuts2];\n    })\n  );\n  const keymapDef = $ctx(key, `${name}Keymap`);\n  const shortcuts = $shortcut((ctx) => {\n    const keys = ctx.get(keymapDef.key);\n    const keymapTuple = Object.entries(userKeymap).flatMap(\n      ([key2, { command }]) => {\n        const targetKeys = [keys[key2]].flat();\n        return targetKeys.map((targetKey) => [targetKey, command(ctx)]);\n      }\n    );\n    return Object.fromEntries(keymapTuple);\n  });\n  const result = [keymapDef, shortcuts];\n  result.ctx = keymapDef;\n  result.shortcuts = shortcuts;\n  result.key = keymapDef.key;\n  result.keymap = shortcuts.keymap;\n  return result;\n}\nconst $nodeAttr = (name, value = () => ({})) => $ctx(value, `${name}Attr`);\nconst $markAttr = (name, value = () => ({})) => $ctx(value, `${name}Attr`);\nfunction $remark(id, remark, initialOptions) {\n  const options = $ctx(initialOptions ?? {}, id);\n  const plugin = (ctx) => async () => {\n    await ctx.wait(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.InitReady);\n    const re = remark(ctx);\n    const remarkPlugin = {\n      plugin: re,\n      options: ctx.get(options.key)\n    };\n    ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.remarkPluginsCtx, (rp) => [...rp, remarkPlugin]);\n    return () => {\n      ctx.update(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.remarkPluginsCtx, (rp) => rp.filter((x) => x !== remarkPlugin));\n    };\n  };\n  const result = [options, plugin];\n  result.id = id;\n  result.plugin = plugin;\n  result.options = options;\n  return result;\n}\nfunction callCommand(slice, payload) {\n  return (ctx) => {\n    return ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.commandsCtx).call(slice, payload);\n  };\n}\nfunction forceUpdate() {\n  return (ctx) => {\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const { tr } = view.state;\n    const nextTr = Object.assign(Object.create(tr), tr).setTime(Date.now());\n    return view.dispatch(nextTr);\n  };\n}\nfunction getHTML() {\n  return (ctx) => {\n    const div = document.createElement(\"div\");\n    const schema = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaCtx);\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const fragment = _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.DOMSerializer.fromSchema(schema).serializeFragment(\n      view.state.doc.content\n    );\n    div.appendChild(fragment);\n    return div.innerHTML;\n  };\n}\nfunction getMarkdown() {\n  return (ctx) => {\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const serializer = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.serializerCtx);\n    return serializer(view.state.doc);\n  };\n}\nfunction insert(markdown) {\n  return (ctx) => {\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const parser = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.parserCtx);\n    const doc = parser(markdown);\n    if (!doc) return;\n    const contentSlice = view.state.selection.content();\n    return view.dispatch(\n      view.state.tr.replaceSelection(\n        new _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.Slice(doc.content, contentSlice.openStart, contentSlice.openEnd)\n      ).scrollIntoView()\n    );\n  };\n}\nfunction outline() {\n  return (ctx) => {\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const data = [];\n    const doc = view.state.doc;\n    doc.descendants((node) => {\n      if (node.type.name === \"heading\" && node.attrs.level)\n        data.push({\n          text: node.textContent,\n          level: node.attrs.level,\n          id: node.attrs.id\n        });\n    });\n    return data;\n  };\n}\nfunction replaceAll(markdown, flush = false) {\n  return (ctx) => {\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const parser = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.parserCtx);\n    const doc = parser(markdown);\n    if (!doc) return;\n    if (!flush) {\n      const { state: state2 } = view;\n      return view.dispatch(\n        state2.tr.replace(\n          0,\n          state2.doc.content.size,\n          new _milkdown_prose_model__WEBPACK_IMPORTED_MODULE_5__.Slice(doc.content, 0, 0)\n        )\n      );\n    }\n    const schema = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.schemaCtx);\n    const options = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorStateOptionsCtx);\n    const plugins = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.prosePluginsCtx);\n    const state = _milkdown_prose_state__WEBPACK_IMPORTED_MODULE_6__.EditorState.create({\n      schema,\n      doc,\n      plugins,\n      ...options\n    });\n    view.updateState(state);\n  };\n}\nfunction setAttr(pos, update) {\n  return (ctx) => {\n    const view = ctx.get(_milkdown_core__WEBPACK_IMPORTED_MODULE_2__.editorViewCtx);\n    const { tr } = view.state;\n    const node = tr.doc.nodeAt(pos);\n    if (!node) return;\n    const nextAttr = update(node.attrs);\n    return view.dispatch(tr.setNodeMarkup(pos, void 0, nextAttr));\n  };\n}\nconst pipe = (...funcs) => {\n  const length = funcs.length;\n  let index = length;\n  while (index--) {\n    if (typeof funcs[index] !== \"function\")\n      throw new TypeError(\"Expected a function\");\n  }\n  return (...args) => {\n    let index2 = 0;\n    let result = length ? funcs[index2](...args) : args[0];\n    while (++index2 < length) result = funcs[index2](result);\n    return result;\n  };\n};\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3V0aWxzL2xpYi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd1Y7QUFDL1I7QUFDakI7QUFDdUM7QUFDL0I7QUFDdUI7QUFDbkI7QUFDcEQsZUFBZSxzREFBYztBQUM3QjtBQUNBLGdCQUFnQiwwREFBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsNERBQVk7QUFDN0I7QUFDQTtBQUNBLG1CQUFtQix5REFBYTtBQUNoQztBQUNBLFlBQVksdURBQVc7QUFDdkIsc0NBQXNDLHVEQUFXO0FBQ2pEO0FBQ0EsY0FBYyx1REFBVztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDREQUFZO0FBQzdCO0FBQ0E7QUFDQSxxQkFBcUIseURBQWE7QUFDbEM7QUFDQSxjQUFjLHVEQUFXO0FBQ3pCLHdDQUF3Qyx1REFBVztBQUNuRDtBQUNBO0FBQ0EsZ0JBQWdCLHVEQUFXO0FBQzNCO0FBQ0EsS0FBSztBQUNMLElBQUksNERBQWdCO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsdURBQVc7QUFDOUI7QUFDQSxlQUFlLHlEQUFhO0FBQzVCO0FBQ0E7QUFDQSxpQkFBaUIseURBQWE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsdURBQVc7QUFDaEM7QUFDQSxpQkFBaUIseURBQWE7QUFDOUI7QUFDQTtBQUNBLG1CQUFtQix5REFBYTtBQUNoQztBQUNBLEtBQUs7QUFDTCxJQUFJLCtEQUFtQjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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dEMsK0JBQStCLHlEQUFhO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIseURBQWE7QUFDdEMsMkJBQTJCLHFEQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUFLO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix5REFBYTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHlEQUFhO0FBQ3RDLDJCQUEyQixxREFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQSxjQUFjLGdCQUFnQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0RBQUs7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHFEQUFTO0FBQ3BDLDRCQUE0QixpRUFBcUI7QUFDakQsNEJBQTRCLDJEQUFlO0FBQzNDLGtCQUFrQiw4REFBVztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHlEQUFhO0FBQ3RDLFlBQVksS0FBSztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBa0NFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yYWluMi9Eb2N1bWVudHMvbm90ZUNhcmQvbm9kZV9tb2R1bGVzL0BtaWxrZG93bi91dGlscy9saWIvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ21kS2V5LCBjb21tYW5kc1RpbWVyQ3R4LCBDb21tYW5kc1JlYWR5LCBjb21tYW5kc0N0eCwgZWRpdG9yU3RhdGVUaW1lckN0eCwgU2NoZW1hUmVhZHksIGlucHV0UnVsZXNDdHgsIHNjaGVtYUN0eCwgc2NoZW1hVGltZXJDdHgsIG1hcmtzQ3R4LCBub2Rlc0N0eCwgcHJvc2VQbHVnaW5zQ3R4LCBlZGl0b3JWaWV3VGltZXJDdHgsIG5vZGVWaWV3Q3R4LCBtYXJrVmlld0N0eCwgSW5pdFJlYWR5LCByZW1hcmtQbHVnaW5zQ3R4LCBlZGl0b3JWaWV3Q3R4LCBzZXJpYWxpemVyQ3R4LCBwYXJzZXJDdHgsIGVkaXRvclN0YXRlT3B0aW9uc0N0eCB9IGZyb20gXCJAbWlsa2Rvd24vY29yZVwiO1xuaW1wb3J0IHsgY3JlYXRlVGltZXIsIGNyZWF0ZVNsaWNlIH0gZnJvbSBcIkBtaWxrZG93bi9jdHhcIjtcbmltcG9ydCB7IGN1c3RvbUFscGhhYmV0IH0gZnJvbSBcIm5hbm9pZFwiO1xuaW1wb3J0IHsgbWlzc2luZ01hcmtJblNjaGVtYSwgbWlzc2luZ05vZGVJblNjaGVtYSB9IGZyb20gXCJAbWlsa2Rvd24vZXhjZXB0aW9uXCI7XG5pbXBvcnQgeyBrZXltYXAgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL2tleW1hcFwiO1xuaW1wb3J0IHsgTm9kZVR5cGUsIERPTVNlcmlhbGl6ZXIsIFNsaWNlIH0gZnJvbSBcIkBtaWxrZG93bi9wcm9zZS9tb2RlbFwiO1xuaW1wb3J0IHsgRWRpdG9yU3RhdGUgfSBmcm9tIFwiQG1pbGtkb3duL3Byb3NlL3N0YXRlXCI7XG5jb25zdCBuYW5vaWQgPSBjdXN0b21BbHBoYWJldChcImFiY2VkZmdoaWNrbG1uXCIsIDEwKTtcbmZ1bmN0aW9uIGFkZFRpbWVyKHJ1bm5lciwgaW5qZWN0VG8sIHRpbWVyTmFtZSkge1xuICBjb25zdCB0aW1lciA9IGNyZWF0ZVRpbWVyKHRpbWVyTmFtZSB8fCBuYW5vaWQoKSk7XG4gIGxldCBkb25lQ2FsbGVkID0gZmFsc2U7XG4gIGNvbnN0IHBsdWdpbiA9IChjdHgpID0+IHtcbiAgICBjdHgucmVjb3JkKHRpbWVyKTtcbiAgICBjdHgudXBkYXRlKGluamVjdFRvLCAoeCkgPT4geC5jb25jYXQodGltZXIpKTtcbiAgICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZG9uZSA9ICgpID0+IHtcbiAgICAgICAgY3R4LmRvbmUodGltZXIpO1xuICAgICAgICBkb25lQ2FsbGVkID0gdHJ1ZTtcbiAgICAgIH07XG4gICAgICBjb25zdCBjbGVhbnVwID0gYXdhaXQgcnVubmVyKGN0eCwgcGx1Z2luLCBkb25lKTtcbiAgICAgIGlmICghZG9uZUNhbGxlZCkgY3R4LmRvbmUodGltZXIpO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgY3R4LnVwZGF0ZShpbmplY3RUbywgKHgpID0+IHguZmlsdGVyKCh5KSA9PiB5ICE9PSB0aW1lcikpO1xuICAgICAgICBjdHguY2xlYXJUaW1lcih0aW1lcik7XG4gICAgICAgIGlmIChjbGVhbnVwKSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2xlYW51cCgpO1xuICAgICAgICAgIGlmIChyZXN1bHQgJiYgXCJ0aGVuXCIgaW4gcmVzdWx0KSB7XG4gICAgICAgICAgICByZXN1bHQuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH07XG4gIH07XG4gIHBsdWdpbi50aW1lciA9IHRpbWVyO1xuICByZXR1cm4gcGx1Z2luO1xufVxuZnVuY3Rpb24gJGNvbW1hbmQoa2V5LCBjbWQpIHtcbiAgY29uc3QgY21kS2V5ID0gY3JlYXRlQ21kS2V5KGtleSk7XG4gIGNvbnN0IHBsdWdpbiA9IChjdHgpID0+IGFzeW5jICgpID0+IHtcbiAgICBwbHVnaW4ua2V5ID0gY21kS2V5O1xuICAgIGF3YWl0IGN0eC53YWl0KENvbW1hbmRzUmVhZHkpO1xuICAgIGNvbnN0IGNvbW1hbmQgPSBjbWQoY3R4KTtcbiAgICBjdHguZ2V0KGNvbW1hbmRzQ3R4KS5jcmVhdGUoY21kS2V5LCBjb21tYW5kKTtcbiAgICBwbHVnaW4ucnVuID0gKHBheWxvYWQpID0+IGN0eC5nZXQoY29tbWFuZHNDdHgpLmNhbGwoa2V5LCBwYXlsb2FkKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY3R4LmdldChjb21tYW5kc0N0eCkucmVtb3ZlKGNtZEtleSk7XG4gICAgfTtcbiAgfTtcbiAgcmV0dXJuIHBsdWdpbjtcbn1cbmZ1bmN0aW9uICRjb21tYW5kQXN5bmMoa2V5LCBjbWQsIHRpbWVyTmFtZSkge1xuICBjb25zdCBjbWRLZXkgPSBjcmVhdGVDbWRLZXkoa2V5KTtcbiAgcmV0dXJuIGFkZFRpbWVyKFxuICAgIGFzeW5jIChjdHgsIHBsdWdpbikgPT4ge1xuICAgICAgYXdhaXQgY3R4LndhaXQoQ29tbWFuZHNSZWFkeSk7XG4gICAgICBjb25zdCBjb21tYW5kID0gYXdhaXQgY21kKGN0eCk7XG4gICAgICBjdHguZ2V0KGNvbW1hbmRzQ3R4KS5jcmVhdGUoY21kS2V5LCBjb21tYW5kKTtcbiAgICAgIHBsdWdpbi5ydW4gPSAocGF5bG9hZCkgPT4gY3R4LmdldChjb21tYW5kc0N0eCkuY2FsbChrZXksIHBheWxvYWQpO1xuICAgICAgcGx1Z2luLmtleSA9IGNtZEtleTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGN0eC5nZXQoY29tbWFuZHNDdHgpLnJlbW92ZShjbWRLZXkpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGNvbW1hbmRzVGltZXJDdHgsXG4gICAgdGltZXJOYW1lXG4gICk7XG59XG5mdW5jdGlvbiAkaW5wdXRSdWxlKGlucHV0UnVsZSkge1xuICBjb25zdCBwbHVnaW4gPSAoY3R4KSA9PiBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY3R4LndhaXQoU2NoZW1hUmVhZHkpO1xuICAgIGNvbnN0IGlyID0gaW5wdXRSdWxlKGN0eCk7XG4gICAgY3R4LnVwZGF0ZShpbnB1dFJ1bGVzQ3R4LCAoaXJzKSA9PiBbLi4uaXJzLCBpcl0pO1xuICAgIHBsdWdpbi5pbnB1dFJ1bGUgPSBpcjtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY3R4LnVwZGF0ZShpbnB1dFJ1bGVzQ3R4LCAoaXJzKSA9PiBpcnMuZmlsdGVyKCh4KSA9PiB4ICE9PSBpcikpO1xuICAgIH07XG4gIH07XG4gIHJldHVybiBwbHVnaW47XG59XG5mdW5jdGlvbiAkaW5wdXRSdWxlQXN5bmMoaW5wdXRSdWxlLCB0aW1lck5hbWUpIHtcbiAgcmV0dXJuIGFkZFRpbWVyKFxuICAgIGFzeW5jIChjdHgsIHBsdWdpbikgPT4ge1xuICAgICAgYXdhaXQgY3R4LndhaXQoU2NoZW1hUmVhZHkpO1xuICAgICAgY29uc3QgaXIgPSBhd2FpdCBpbnB1dFJ1bGUoY3R4KTtcbiAgICAgIGN0eC51cGRhdGUoaW5wdXRSdWxlc0N0eCwgKGlycykgPT4gWy4uLmlycywgaXJdKTtcbiAgICAgIHBsdWdpbi5pbnB1dFJ1bGUgPSBpcjtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGN0eC51cGRhdGUoaW5wdXRSdWxlc0N0eCwgKGlycykgPT4gaXJzLmZpbHRlcigoeCkgPT4geCAhPT0gaXIpKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBlZGl0b3JTdGF0ZVRpbWVyQ3R4LFxuICAgIHRpbWVyTmFtZVxuICApO1xufVxuZnVuY3Rpb24gJG1hcmsoaWQsIHNjaGVtYSkge1xuICBjb25zdCBwbHVnaW4gPSAoY3R4KSA9PiBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbWFya1NjaGVtYSA9IHNjaGVtYShjdHgpO1xuICAgIGN0eC51cGRhdGUobWFya3NDdHgsIChucykgPT4gW1xuICAgICAgLi4ubnMuZmlsdGVyKChuKSA9PiBuWzBdICE9PSBpZCksXG4gICAgICBbaWQsIG1hcmtTY2hlbWFdXG4gICAgXSk7XG4gICAgcGx1Z2luLmlkID0gaWQ7XG4gICAgcGx1Z2luLnNjaGVtYSA9IG1hcmtTY2hlbWE7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGN0eC51cGRhdGUobWFya3NDdHgsIChucykgPT4gbnMuZmlsdGVyKChbeF0pID0+IHggIT09IGlkKSk7XG4gICAgfTtcbiAgfTtcbiAgcGx1Z2luLnR5cGUgPSAoY3R4KSA9PiB7XG4gICAgY29uc3QgbWFya1R5cGUgPSBjdHguZ2V0KHNjaGVtYUN0eCkubWFya3NbaWRdO1xuICAgIGlmICghbWFya1R5cGUpIHRocm93IG1pc3NpbmdNYXJrSW5TY2hlbWEoaWQpO1xuICAgIHJldHVybiBtYXJrVHlwZTtcbiAgfTtcbiAgcmV0dXJuIHBsdWdpbjtcbn1cbmZ1bmN0aW9uICRtYXJrQXN5bmMoaWQsIHNjaGVtYSwgdGltZXJOYW1lKSB7XG4gIGNvbnN0IHBsdWdpbiA9IGFkZFRpbWVyKFxuICAgIGFzeW5jIChjdHgsIHBsdWdpbjIsIGRvbmUpID0+IHtcbiAgICAgIGNvbnN0IG1hcmtTY2hlbWEgPSBhd2FpdCBzY2hlbWEoY3R4KTtcbiAgICAgIGN0eC51cGRhdGUobWFya3NDdHgsIChucykgPT4gW1xuICAgICAgICAuLi5ucy5maWx0ZXIoKG4pID0+IG5bMF0gIT09IGlkKSxcbiAgICAgICAgW2lkLCBtYXJrU2NoZW1hXVxuICAgICAgXSk7XG4gICAgICBwbHVnaW4yLmlkID0gaWQ7XG4gICAgICBwbHVnaW4yLnNjaGVtYSA9IG1hcmtTY2hlbWE7XG4gICAgICBkb25lKCk7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjdHgudXBkYXRlKG1hcmtzQ3R4LCAobnMpID0+IG5zLmZpbHRlcigoW3hdKSA9PiB4ICE9PSBpZCkpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIHNjaGVtYVRpbWVyQ3R4LFxuICAgIHRpbWVyTmFtZVxuICApO1xuICBwbHVnaW4udHlwZSA9IChjdHgpID0+IHtcbiAgICBjb25zdCBtYXJrVHlwZSA9IGN0eC5nZXQoc2NoZW1hQ3R4KS5tYXJrc1tpZF07XG4gICAgaWYgKCFtYXJrVHlwZSkgdGhyb3cgbWlzc2luZ01hcmtJblNjaGVtYShpZCk7XG4gICAgcmV0dXJuIG1hcmtUeXBlO1xuICB9O1xuICByZXR1cm4gcGx1Z2luO1xufVxuZnVuY3Rpb24gJG5vZGUoaWQsIHNjaGVtYSkge1xuICBjb25zdCBwbHVnaW4gPSAoY3R4KSA9PiBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgbm9kZVNjaGVtYSA9IHNjaGVtYShjdHgpO1xuICAgIGN0eC51cGRhdGUobm9kZXNDdHgsIChucykgPT4gW1xuICAgICAgLi4ubnMuZmlsdGVyKChuKSA9PiBuWzBdICE9PSBpZCksXG4gICAgICBbaWQsIG5vZGVTY2hlbWFdXG4gICAgXSk7XG4gICAgcGx1Z2luLmlkID0gaWQ7XG4gICAgcGx1Z2luLnNjaGVtYSA9IG5vZGVTY2hlbWE7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGN0eC51cGRhdGUobm9kZXNDdHgsIChucykgPT4gbnMuZmlsdGVyKChbeF0pID0+IHggIT09IGlkKSk7XG4gICAgfTtcbiAgfTtcbiAgcGx1Z2luLnR5cGUgPSAoY3R4KSA9PiB7XG4gICAgY29uc3Qgbm9kZVR5cGUgPSBjdHguZ2V0KHNjaGVtYUN0eCkubm9kZXNbaWRdO1xuICAgIGlmICghbm9kZVR5cGUpIHRocm93IG1pc3NpbmdOb2RlSW5TY2hlbWEoaWQpO1xuICAgIHJldHVybiBub2RlVHlwZTtcbiAgfTtcbiAgcmV0dXJuIHBsdWdpbjtcbn1cbmZ1bmN0aW9uICRub2RlQXN5bmMoaWQsIHNjaGVtYSwgdGltZXJOYW1lKSB7XG4gIGNvbnN0IHBsdWdpbiA9IGFkZFRpbWVyKFxuICAgIGFzeW5jIChjdHgsIHBsdWdpbjIsIGRvbmUpID0+IHtcbiAgICAgIGNvbnN0IG5vZGVTY2hlbWEgPSBhd2FpdCBzY2hlbWEoY3R4KTtcbiAgICAgIGN0eC51cGRhdGUobm9kZXNDdHgsIChucykgPT4gW1xuICAgICAgICAuLi5ucy5maWx0ZXIoKG4pID0+IG5bMF0gIT09IGlkKSxcbiAgICAgICAgW2lkLCBub2RlU2NoZW1hXVxuICAgICAgXSk7XG4gICAgICBwbHVnaW4yLmlkID0gaWQ7XG4gICAgICBwbHVnaW4yLnNjaGVtYSA9IG5vZGVTY2hlbWE7XG4gICAgICBkb25lKCk7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjdHgudXBkYXRlKG5vZGVzQ3R4LCAobnMpID0+IG5zLmZpbHRlcigoW3hdKSA9PiB4ICE9PSBpZCkpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIHNjaGVtYVRpbWVyQ3R4LFxuICAgIHRpbWVyTmFtZVxuICApO1xuICBwbHVnaW4udHlwZSA9IChjdHgpID0+IHtcbiAgICBjb25zdCBub2RlVHlwZSA9IGN0eC5nZXQoc2NoZW1hQ3R4KS5ub2Rlc1tpZF07XG4gICAgaWYgKCFub2RlVHlwZSkgdGhyb3cgbWlzc2luZ05vZGVJblNjaGVtYShpZCk7XG4gICAgcmV0dXJuIG5vZGVUeXBlO1xuICB9O1xuICByZXR1cm4gcGx1Z2luO1xufVxuZnVuY3Rpb24gJHByb3NlKHByb3NlKSB7XG4gIGxldCBwcm9zZVBsdWdpbjtcbiAgY29uc3QgcGx1Z2luID0gKGN0eCkgPT4gYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGN0eC53YWl0KFNjaGVtYVJlYWR5KTtcbiAgICBwcm9zZVBsdWdpbiA9IHByb3NlKGN0eCk7XG4gICAgY3R4LnVwZGF0ZShwcm9zZVBsdWdpbnNDdHgsIChwcykgPT4gWy4uLnBzLCBwcm9zZVBsdWdpbl0pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjdHgudXBkYXRlKHByb3NlUGx1Z2luc0N0eCwgKHBzKSA9PiBwcy5maWx0ZXIoKHgpID0+IHggIT09IHByb3NlUGx1Z2luKSk7XG4gICAgfTtcbiAgfTtcbiAgcGx1Z2luLnBsdWdpbiA9ICgpID0+IHByb3NlUGx1Z2luO1xuICBwbHVnaW4ua2V5ID0gKCkgPT4gcHJvc2VQbHVnaW4uc3BlYy5rZXk7XG4gIHJldHVybiBwbHVnaW47XG59XG5mdW5jdGlvbiAkcHJvc2VBc3luYyhwcm9zZSwgdGltZXJOYW1lKSB7XG4gIGxldCBwcm9zZVBsdWdpbjtcbiAgY29uc3QgcGx1Z2luID0gYWRkVGltZXIoXG4gICAgYXN5bmMgKGN0eCkgPT4ge1xuICAgICAgYXdhaXQgY3R4LndhaXQoU2NoZW1hUmVhZHkpO1xuICAgICAgcHJvc2VQbHVnaW4gPSBhd2FpdCBwcm9zZShjdHgpO1xuICAgICAgY3R4LnVwZGF0ZShwcm9zZVBsdWdpbnNDdHgsIChwcykgPT4gWy4uLnBzLCBwcm9zZVBsdWdpbl0pO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgY3R4LnVwZGF0ZShwcm9zZVBsdWdpbnNDdHgsIChwcykgPT4gcHMuZmlsdGVyKCh4KSA9PiB4ICE9PSBwcm9zZVBsdWdpbikpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGVkaXRvclN0YXRlVGltZXJDdHgsXG4gICAgdGltZXJOYW1lXG4gICk7XG4gIHBsdWdpbi5wbHVnaW4gPSAoKSA9PiBwcm9zZVBsdWdpbjtcbiAgcGx1Z2luLmtleSA9ICgpID0+IHByb3NlUGx1Z2luLnNwZWMua2V5O1xuICByZXR1cm4gcGx1Z2luO1xufVxuZnVuY3Rpb24gJHNob3J0Y3V0KHNob3J0Y3V0KSB7XG4gIGNvbnN0IHBsdWdpbiA9IChjdHgpID0+IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBjdHgud2FpdChTY2hlbWFSZWFkeSk7XG4gICAgY29uc3QgayA9IHNob3J0Y3V0KGN0eCk7XG4gICAgY29uc3Qga2V5bWFwUGx1Z2luID0ga2V5bWFwKGspO1xuICAgIGN0eC51cGRhdGUocHJvc2VQbHVnaW5zQ3R4LCAocHMpID0+IFsuLi5wcywga2V5bWFwUGx1Z2luXSk7XG4gICAgcGx1Z2luLmtleW1hcCA9IGs7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGN0eC51cGRhdGUocHJvc2VQbHVnaW5zQ3R4LCAocHMpID0+IHBzLmZpbHRlcigoeCkgPT4geCAhPT0ga2V5bWFwUGx1Z2luKSk7XG4gICAgfTtcbiAgfTtcbiAgcmV0dXJuIHBsdWdpbjtcbn1cbmZ1bmN0aW9uICRzaG9ydGN1dEFzeW5jKHNob3J0Y3V0LCB0aW1lck5hbWUpIHtcbiAgcmV0dXJuIGFkZFRpbWVyKFxuICAgIGFzeW5jIChjdHgsIHBsdWdpbikgPT4ge1xuICAgICAgYXdhaXQgY3R4LndhaXQoU2NoZW1hUmVhZHkpO1xuICAgICAgY29uc3QgayA9IGF3YWl0IHNob3J0Y3V0KGN0eCk7XG4gICAgICBjb25zdCBrZXltYXBQbHVnaW4gPSBrZXltYXAoayk7XG4gICAgICBjdHgudXBkYXRlKHByb3NlUGx1Z2luc0N0eCwgKHBzKSA9PiBbLi4ucHMsIGtleW1hcFBsdWdpbl0pO1xuICAgICAgcGx1Z2luLmtleW1hcCA9IGs7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjdHgudXBkYXRlKFxuICAgICAgICAgIHByb3NlUGx1Z2luc0N0eCxcbiAgICAgICAgICAocHMpID0+IHBzLmZpbHRlcigoeCkgPT4geCAhPT0ga2V5bWFwUGx1Z2luKVxuICAgICAgICApO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGVkaXRvclN0YXRlVGltZXJDdHgsXG4gICAgdGltZXJOYW1lXG4gICk7XG59XG5mdW5jdGlvbiAkdmlldyh0eXBlLCB2aWV3KSB7XG4gIGNvbnN0IHBsdWdpbiA9IChjdHgpID0+IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBjdHgud2FpdChTY2hlbWFSZWFkeSk7XG4gICAgY29uc3QgdiA9IHZpZXcoY3R4KTtcbiAgICBpZiAodHlwZS50eXBlKGN0eCkgaW5zdGFuY2VvZiBOb2RlVHlwZSlcbiAgICAgIGN0eC51cGRhdGUobm9kZVZpZXdDdHgsIChwcykgPT4gW1xuICAgICAgICAuLi5wcyxcbiAgICAgICAgW3R5cGUuaWQsIHZdXG4gICAgICBdKTtcbiAgICBlbHNlXG4gICAgICBjdHgudXBkYXRlKG1hcmtWaWV3Q3R4LCAocHMpID0+IFtcbiAgICAgICAgLi4ucHMsXG4gICAgICAgIFt0eXBlLmlkLCB2XVxuICAgICAgXSk7XG4gICAgcGx1Z2luLnZpZXcgPSB2O1xuICAgIHBsdWdpbi50eXBlID0gdHlwZTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKHR5cGUudHlwZShjdHgpIGluc3RhbmNlb2YgTm9kZVR5cGUpXG4gICAgICAgIGN0eC51cGRhdGUobm9kZVZpZXdDdHgsIChwcykgPT4gcHMuZmlsdGVyKCh4KSA9PiB4WzBdICE9PSB0eXBlLmlkKSk7XG4gICAgICBlbHNlIGN0eC51cGRhdGUobWFya1ZpZXdDdHgsIChwcykgPT4gcHMuZmlsdGVyKCh4KSA9PiB4WzBdICE9PSB0eXBlLmlkKSk7XG4gICAgfTtcbiAgfTtcbiAgcmV0dXJuIHBsdWdpbjtcbn1cbmZ1bmN0aW9uICR2aWV3QXN5bmModHlwZSwgdmlldywgdGltZXJOYW1lKSB7XG4gIHJldHVybiBhZGRUaW1lcihcbiAgICBhc3luYyAoY3R4LCBwbHVnaW4pID0+IHtcbiAgICAgIGF3YWl0IGN0eC53YWl0KFNjaGVtYVJlYWR5KTtcbiAgICAgIGNvbnN0IHYgPSBhd2FpdCB2aWV3KGN0eCk7XG4gICAgICBpZiAodHlwZS50eXBlKGN0eCkgaW5zdGFuY2VvZiBOb2RlVHlwZSlcbiAgICAgICAgY3R4LnVwZGF0ZShub2RlVmlld0N0eCwgKHBzKSA9PiBbXG4gICAgICAgICAgLi4ucHMsXG4gICAgICAgICAgW3R5cGUuaWQsIHZdXG4gICAgICAgIF0pO1xuICAgICAgZWxzZVxuICAgICAgICBjdHgudXBkYXRlKG1hcmtWaWV3Q3R4LCAocHMpID0+IFtcbiAgICAgICAgICAuLi5wcyxcbiAgICAgICAgICBbdHlwZS5pZCwgdl1cbiAgICAgICAgXSk7XG4gICAgICBwbHVnaW4udmlldyA9IHY7XG4gICAgICBwbHVnaW4udHlwZSA9IHR5cGU7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAodHlwZS50eXBlKGN0eCkgaW5zdGFuY2VvZiBOb2RlVHlwZSlcbiAgICAgICAgICBjdHgudXBkYXRlKG5vZGVWaWV3Q3R4LCAocHMpID0+IHBzLmZpbHRlcigoeCkgPT4geFswXSAhPT0gdHlwZS5pZCkpO1xuICAgICAgICBlbHNlIGN0eC51cGRhdGUobWFya1ZpZXdDdHgsIChwcykgPT4gcHMuZmlsdGVyKCh4KSA9PiB4WzBdICE9PSB0eXBlLmlkKSk7XG4gICAgICB9O1xuICAgIH0sXG4gICAgZWRpdG9yVmlld1RpbWVyQ3R4LFxuICAgIHRpbWVyTmFtZVxuICApO1xufVxuZnVuY3Rpb24gJGN0eCh2YWx1ZSwgbmFtZSkge1xuICBjb25zdCBzbGljZSA9IGNyZWF0ZVNsaWNlKHZhbHVlLCBuYW1lKTtcbiAgY29uc3QgcGx1Z2luID0gKGN0eCkgPT4ge1xuICAgIGN0eC5pbmplY3Qoc2xpY2UpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjdHgucmVtb3ZlKHNsaWNlKTtcbiAgICAgIH07XG4gICAgfTtcbiAgfTtcbiAgcGx1Z2luLmtleSA9IHNsaWNlO1xuICByZXR1cm4gcGx1Z2luO1xufVxuZnVuY3Rpb24gJG5vZGVTY2hlbWEoaWQsIHNjaGVtYSkge1xuICBjb25zdCBzY2hlbWFDdHgyID0gJGN0eChzY2hlbWEsIGlkKTtcbiAgY29uc3Qgbm9kZVNjaGVtYSA9ICRub2RlKGlkLCAoY3R4KSA9PiB7XG4gICAgY29uc3QgdXNlclNjaGVtYSA9IGN0eC5nZXQoc2NoZW1hQ3R4Mi5rZXkpO1xuICAgIHJldHVybiB1c2VyU2NoZW1hKGN0eCk7XG4gIH0pO1xuICBjb25zdCByZXN1bHQgPSBbc2NoZW1hQ3R4Miwgbm9kZVNjaGVtYV07XG4gIHJlc3VsdC5pZCA9IG5vZGVTY2hlbWEuaWQ7XG4gIHJlc3VsdC5ub2RlID0gbm9kZVNjaGVtYTtcbiAgcmVzdWx0LnR5cGUgPSAoY3R4KSA9PiBub2RlU2NoZW1hLnR5cGUoY3R4KTtcbiAgcmVzdWx0LnNjaGVtYSA9IG5vZGVTY2hlbWEuc2NoZW1hO1xuICByZXN1bHQuY3R4ID0gc2NoZW1hQ3R4MjtcbiAgcmVzdWx0LmtleSA9IHNjaGVtYUN0eDIua2V5O1xuICByZXN1bHQuZXh0ZW5kU2NoZW1hID0gKGhhbmRsZXIpID0+IHtcbiAgICByZXR1cm4gKGN0eCkgPT4gKCkgPT4ge1xuICAgICAgY29uc3QgcHJldiA9IGN0eC5nZXQoc2NoZW1hQ3R4Mi5rZXkpO1xuICAgICAgY29uc3QgbmV4dCA9IGhhbmRsZXIocHJldik7XG4gICAgICBjb25zdCBub2RlU2NoZW1hMiA9IG5leHQoY3R4KTtcbiAgICAgIGN0eC51cGRhdGUobm9kZXNDdHgsIChucykgPT4gW1xuICAgICAgICAuLi5ucy5maWx0ZXIoKG4pID0+IG5bMF0gIT09IGlkKSxcbiAgICAgICAgW2lkLCBub2RlU2NoZW1hMl1cbiAgICAgIF0pO1xuICAgICAgcmVzdWx0LnNjaGVtYSA9IG5vZGVTY2hlbWEyO1xuICAgIH07XG4gIH07XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiAkbWFya1NjaGVtYShpZCwgc2NoZW1hKSB7XG4gIGNvbnN0IHNjaGVtYUN0eDIgPSAkY3R4KHNjaGVtYSwgaWQpO1xuICBjb25zdCBtYXJrU2NoZW1hID0gJG1hcmsoaWQsIChjdHgpID0+IHtcbiAgICBjb25zdCB1c2VyU2NoZW1hID0gY3R4LmdldChzY2hlbWFDdHgyLmtleSk7XG4gICAgcmV0dXJuIHVzZXJTY2hlbWEoY3R4KTtcbiAgfSk7XG4gIGNvbnN0IHJlc3VsdCA9IFtzY2hlbWFDdHgyLCBtYXJrU2NoZW1hXTtcbiAgcmVzdWx0LmlkID0gbWFya1NjaGVtYS5pZDtcbiAgcmVzdWx0Lm1hcmsgPSBtYXJrU2NoZW1hO1xuICByZXN1bHQudHlwZSA9IG1hcmtTY2hlbWEudHlwZTtcbiAgcmVzdWx0LnNjaGVtYSA9IG1hcmtTY2hlbWEuc2NoZW1hO1xuICByZXN1bHQuY3R4ID0gc2NoZW1hQ3R4MjtcbiAgcmVzdWx0LmtleSA9IHNjaGVtYUN0eDIua2V5O1xuICByZXN1bHQuZXh0ZW5kU2NoZW1hID0gKGhhbmRsZXIpID0+IHtcbiAgICByZXR1cm4gKGN0eCkgPT4gKCkgPT4ge1xuICAgICAgY29uc3QgcHJldiA9IGN0eC5nZXQoc2NoZW1hQ3R4Mi5rZXkpO1xuICAgICAgY29uc3QgbmV4dCA9IGhhbmRsZXIocHJldik7XG4gICAgICBjb25zdCBtYXJrU2NoZW1hMiA9IG5leHQoY3R4KTtcbiAgICAgIGN0eC51cGRhdGUobWFya3NDdHgsIChtcykgPT4gW1xuICAgICAgICAuLi5tcy5maWx0ZXIoKG0pID0+IG1bMF0gIT09IGlkKSxcbiAgICAgICAgW2lkLCBtYXJrU2NoZW1hMl1cbiAgICAgIF0pO1xuICAgICAgcmVzdWx0LnNjaGVtYSA9IG1hcmtTY2hlbWEyO1xuICAgIH07XG4gIH07XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiAkdXNlS2V5bWFwKG5hbWUsIHVzZXJLZXltYXApIHtcbiAgY29uc3Qga2V5ID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIE9iamVjdC5lbnRyaWVzKHVzZXJLZXltYXApLm1hcCgoW2tleTIsIHsgc2hvcnRjdXRzOiBzaG9ydGN1dHMyIH1dKSA9PiB7XG4gICAgICByZXR1cm4gW2tleTIsIHNob3J0Y3V0czJdO1xuICAgIH0pXG4gICk7XG4gIGNvbnN0IGtleW1hcERlZiA9ICRjdHgoa2V5LCBgJHtuYW1lfUtleW1hcGApO1xuICBjb25zdCBzaG9ydGN1dHMgPSAkc2hvcnRjdXQoKGN0eCkgPT4ge1xuICAgIGNvbnN0IGtleXMgPSBjdHguZ2V0KGtleW1hcERlZi5rZXkpO1xuICAgIGNvbnN0IGtleW1hcFR1cGxlID0gT2JqZWN0LmVudHJpZXModXNlcktleW1hcCkuZmxhdE1hcChcbiAgICAgIChba2V5MiwgeyBjb21tYW5kIH1dKSA9PiB7XG4gICAgICAgIGNvbnN0IHRhcmdldEtleXMgPSBba2V5c1trZXkyXV0uZmxhdCgpO1xuICAgICAgICByZXR1cm4gdGFyZ2V0S2V5cy5tYXAoKHRhcmdldEtleSkgPT4gW3RhcmdldEtleSwgY29tbWFuZChjdHgpXSk7XG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKGtleW1hcFR1cGxlKTtcbiAgfSk7XG4gIGNvbnN0IHJlc3VsdCA9IFtrZXltYXBEZWYsIHNob3J0Y3V0c107XG4gIHJlc3VsdC5jdHggPSBrZXltYXBEZWY7XG4gIHJlc3VsdC5zaG9ydGN1dHMgPSBzaG9ydGN1dHM7XG4gIHJlc3VsdC5rZXkgPSBrZXltYXBEZWYua2V5O1xuICByZXN1bHQua2V5bWFwID0gc2hvcnRjdXRzLmtleW1hcDtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmNvbnN0ICRub2RlQXR0ciA9IChuYW1lLCB2YWx1ZSA9ICgpID0+ICh7fSkpID0+ICRjdHgodmFsdWUsIGAke25hbWV9QXR0cmApO1xuY29uc3QgJG1hcmtBdHRyID0gKG5hbWUsIHZhbHVlID0gKCkgPT4gKHt9KSkgPT4gJGN0eCh2YWx1ZSwgYCR7bmFtZX1BdHRyYCk7XG5mdW5jdGlvbiAkcmVtYXJrKGlkLCByZW1hcmssIGluaXRpYWxPcHRpb25zKSB7XG4gIGNvbnN0IG9wdGlvbnMgPSAkY3R4KGluaXRpYWxPcHRpb25zID8/IHt9LCBpZCk7XG4gIGNvbnN0IHBsdWdpbiA9IChjdHgpID0+IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBjdHgud2FpdChJbml0UmVhZHkpO1xuICAgIGNvbnN0IHJlID0gcmVtYXJrKGN0eCk7XG4gICAgY29uc3QgcmVtYXJrUGx1Z2luID0ge1xuICAgICAgcGx1Z2luOiByZSxcbiAgICAgIG9wdGlvbnM6IGN0eC5nZXQob3B0aW9ucy5rZXkpXG4gICAgfTtcbiAgICBjdHgudXBkYXRlKHJlbWFya1BsdWdpbnNDdHgsIChycCkgPT4gWy4uLnJwLCByZW1hcmtQbHVnaW5dKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY3R4LnVwZGF0ZShyZW1hcmtQbHVnaW5zQ3R4LCAocnApID0+IHJwLmZpbHRlcigoeCkgPT4geCAhPT0gcmVtYXJrUGx1Z2luKSk7XG4gICAgfTtcbiAgfTtcbiAgY29uc3QgcmVzdWx0ID0gW29wdGlvbnMsIHBsdWdpbl07XG4gIHJlc3VsdC5pZCA9IGlkO1xuICByZXN1bHQucGx1Z2luID0gcGx1Z2luO1xuICByZXN1bHQub3B0aW9ucyA9IG9wdGlvbnM7XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjYWxsQ29tbWFuZChzbGljZSwgcGF5bG9hZCkge1xuICByZXR1cm4gKGN0eCkgPT4ge1xuICAgIHJldHVybiBjdHguZ2V0KGNvbW1hbmRzQ3R4KS5jYWxsKHNsaWNlLCBwYXlsb2FkKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGZvcmNlVXBkYXRlKCkge1xuICByZXR1cm4gKGN0eCkgPT4ge1xuICAgIGNvbnN0IHZpZXcgPSBjdHguZ2V0KGVkaXRvclZpZXdDdHgpO1xuICAgIGNvbnN0IHsgdHIgfSA9IHZpZXcuc3RhdGU7XG4gICAgY29uc3QgbmV4dFRyID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHRyKSwgdHIpLnNldFRpbWUoRGF0ZS5ub3coKSk7XG4gICAgcmV0dXJuIHZpZXcuZGlzcGF0Y2gobmV4dFRyKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGdldEhUTUwoKSB7XG4gIHJldHVybiAoY3R4KSA9PiB7XG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb25zdCBzY2hlbWEgPSBjdHguZ2V0KHNjaGVtYUN0eCk7XG4gICAgY29uc3QgdmlldyA9IGN0eC5nZXQoZWRpdG9yVmlld0N0eCk7XG4gICAgY29uc3QgZnJhZ21lbnQgPSBET01TZXJpYWxpemVyLmZyb21TY2hlbWEoc2NoZW1hKS5zZXJpYWxpemVGcmFnbWVudChcbiAgICAgIHZpZXcuc3RhdGUuZG9jLmNvbnRlbnRcbiAgICApO1xuICAgIGRpdi5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7XG4gIH07XG59XG5mdW5jdGlvbiBnZXRNYXJrZG93bigpIHtcbiAgcmV0dXJuIChjdHgpID0+IHtcbiAgICBjb25zdCB2aWV3ID0gY3R4LmdldChlZGl0b3JWaWV3Q3R4KTtcbiAgICBjb25zdCBzZXJpYWxpemVyID0gY3R4LmdldChzZXJpYWxpemVyQ3R4KTtcbiAgICByZXR1cm4gc2VyaWFsaXplcih2aWV3LnN0YXRlLmRvYyk7XG4gIH07XG59XG5mdW5jdGlvbiBpbnNlcnQobWFya2Rvd24pIHtcbiAgcmV0dXJuIChjdHgpID0+IHtcbiAgICBjb25zdCB2aWV3ID0gY3R4LmdldChlZGl0b3JWaWV3Q3R4KTtcbiAgICBjb25zdCBwYXJzZXIgPSBjdHguZ2V0KHBhcnNlckN0eCk7XG4gICAgY29uc3QgZG9jID0gcGFyc2VyKG1hcmtkb3duKTtcbiAgICBpZiAoIWRvYykgcmV0dXJuO1xuICAgIGNvbnN0IGNvbnRlbnRTbGljZSA9IHZpZXcuc3RhdGUuc2VsZWN0aW9uLmNvbnRlbnQoKTtcbiAgICByZXR1cm4gdmlldy5kaXNwYXRjaChcbiAgICAgIHZpZXcuc3RhdGUudHIucmVwbGFjZVNlbGVjdGlvbihcbiAgICAgICAgbmV3IFNsaWNlKGRvYy5jb250ZW50LCBjb250ZW50U2xpY2Uub3BlblN0YXJ0LCBjb250ZW50U2xpY2Uub3BlbkVuZClcbiAgICAgICkuc2Nyb2xsSW50b1ZpZXcoKVxuICAgICk7XG4gIH07XG59XG5mdW5jdGlvbiBvdXRsaW5lKCkge1xuICByZXR1cm4gKGN0eCkgPT4ge1xuICAgIGNvbnN0IHZpZXcgPSBjdHguZ2V0KGVkaXRvclZpZXdDdHgpO1xuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBjb25zdCBkb2MgPSB2aWV3LnN0YXRlLmRvYztcbiAgICBkb2MuZGVzY2VuZGFudHMoKG5vZGUpID0+IHtcbiAgICAgIGlmIChub2RlLnR5cGUubmFtZSA9PT0gXCJoZWFkaW5nXCIgJiYgbm9kZS5hdHRycy5sZXZlbClcbiAgICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgICB0ZXh0OiBub2RlLnRleHRDb250ZW50LFxuICAgICAgICAgIGxldmVsOiBub2RlLmF0dHJzLmxldmVsLFxuICAgICAgICAgIGlkOiBub2RlLmF0dHJzLmlkXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBkYXRhO1xuICB9O1xufVxuZnVuY3Rpb24gcmVwbGFjZUFsbChtYXJrZG93biwgZmx1c2ggPSBmYWxzZSkge1xuICByZXR1cm4gKGN0eCkgPT4ge1xuICAgIGNvbnN0IHZpZXcgPSBjdHguZ2V0KGVkaXRvclZpZXdDdHgpO1xuICAgIGNvbnN0IHBhcnNlciA9IGN0eC5nZXQocGFyc2VyQ3R4KTtcbiAgICBjb25zdCBkb2MgPSBwYXJzZXIobWFya2Rvd24pO1xuICAgIGlmICghZG9jKSByZXR1cm47XG4gICAgaWYgKCFmbHVzaCkge1xuICAgICAgY29uc3QgeyBzdGF0ZTogc3RhdGUyIH0gPSB2aWV3O1xuICAgICAgcmV0dXJuIHZpZXcuZGlzcGF0Y2goXG4gICAgICAgIHN0YXRlMi50ci5yZXBsYWNlKFxuICAgICAgICAgIDAsXG4gICAgICAgICAgc3RhdGUyLmRvYy5jb250ZW50LnNpemUsXG4gICAgICAgICAgbmV3IFNsaWNlKGRvYy5jb250ZW50LCAwLCAwKVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBzY2hlbWEgPSBjdHguZ2V0KHNjaGVtYUN0eCk7XG4gICAgY29uc3Qgb3B0aW9ucyA9IGN0eC5nZXQoZWRpdG9yU3RhdGVPcHRpb25zQ3R4KTtcbiAgICBjb25zdCBwbHVnaW5zID0gY3R4LmdldChwcm9zZVBsdWdpbnNDdHgpO1xuICAgIGNvbnN0IHN0YXRlID0gRWRpdG9yU3RhdGUuY3JlYXRlKHtcbiAgICAgIHNjaGVtYSxcbiAgICAgIGRvYyxcbiAgICAgIHBsdWdpbnMsXG4gICAgICAuLi5vcHRpb25zXG4gICAgfSk7XG4gICAgdmlldy51cGRhdGVTdGF0ZShzdGF0ZSk7XG4gIH07XG59XG5mdW5jdGlvbiBzZXRBdHRyKHBvcywgdXBkYXRlKSB7XG4gIHJldHVybiAoY3R4KSA9PiB7XG4gICAgY29uc3QgdmlldyA9IGN0eC5nZXQoZWRpdG9yVmlld0N0eCk7XG4gICAgY29uc3QgeyB0ciB9ID0gdmlldy5zdGF0ZTtcbiAgICBjb25zdCBub2RlID0gdHIuZG9jLm5vZGVBdChwb3MpO1xuICAgIGlmICghbm9kZSkgcmV0dXJuO1xuICAgIGNvbnN0IG5leHRBdHRyID0gdXBkYXRlKG5vZGUuYXR0cnMpO1xuICAgIHJldHVybiB2aWV3LmRpc3BhdGNoKHRyLnNldE5vZGVNYXJrdXAocG9zLCB2b2lkIDAsIG5leHRBdHRyKSk7XG4gIH07XG59XG5jb25zdCBwaXBlID0gKC4uLmZ1bmNzKSA9PiB7XG4gIGNvbnN0IGxlbmd0aCA9IGZ1bmNzLmxlbmd0aDtcbiAgbGV0IGluZGV4ID0gbGVuZ3RoO1xuICB3aGlsZSAoaW5kZXgtLSkge1xuICAgIGlmICh0eXBlb2YgZnVuY3NbaW5kZXhdICE9PSBcImZ1bmN0aW9uXCIpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiKTtcbiAgfVxuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBsZXQgaW5kZXgyID0gMDtcbiAgICBsZXQgcmVzdWx0ID0gbGVuZ3RoID8gZnVuY3NbaW5kZXgyXSguLi5hcmdzKSA6IGFyZ3NbMF07XG4gICAgd2hpbGUgKCsraW5kZXgyIDwgbGVuZ3RoKSByZXN1bHQgPSBmdW5jc1tpbmRleDJdKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbn07XG5leHBvcnQge1xuICAkY29tbWFuZCxcbiAgJGNvbW1hbmRBc3luYyxcbiAgJGN0eCxcbiAgJGlucHV0UnVsZSxcbiAgJGlucHV0UnVsZUFzeW5jLFxuICAkbWFyayxcbiAgJG1hcmtBc3luYyxcbiAgJG1hcmtBdHRyLFxuICAkbWFya1NjaGVtYSxcbiAgJG5vZGUsXG4gICRub2RlQXN5bmMsXG4gICRub2RlQXR0cixcbiAgJG5vZGVTY2hlbWEsXG4gICRwcm9zZSxcbiAgJHByb3NlQXN5bmMsXG4gICRyZW1hcmssXG4gICRzaG9ydGN1dCxcbiAgJHNob3J0Y3V0QXN5bmMsXG4gICR1c2VLZXltYXAsXG4gICR2aWV3LFxuICAkdmlld0FzeW5jLFxuICBhZGRUaW1lcixcbiAgY2FsbENvbW1hbmQsXG4gIGZvcmNlVXBkYXRlLFxuICBnZXRIVE1MLFxuICBnZXRNYXJrZG93bixcbiAgaW5zZXJ0LFxuICBuYW5vaWQsXG4gIG91dGxpbmUsXG4gIHBpcGUsXG4gIHJlcGxhY2VBbGwsXG4gIHNldEF0dHJcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/utils/lib/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/utils/node_modules/nanoid/index.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@milkdown/utils/node_modules/nanoid/index.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   customAlphabet: () => (/* binding */ customAlphabet),\n/* harmony export */   customRandom: () => (/* binding */ customRandom),\n/* harmony export */   nanoid: () => (/* binding */ nanoid),\n/* harmony export */   random: () => (/* binding */ random),\n/* harmony export */   urlAlphabet: () => (/* reexport safe */ _url_alphabet_index_js__WEBPACK_IMPORTED_MODULE_1__.urlAlphabet)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var _url_alphabet_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./url-alphabet/index.js */ \"(ssr)/./node_modules/@milkdown/utils/node_modules/nanoid/url-alphabet/index.js\");\n\n\n\nconst POOL_SIZE_MULTIPLIER = 128\nlet pool, poolOffset\nfunction fillPool(bytes) {\n  if (!pool || pool.length < bytes) {\n    pool = Buffer.allocUnsafe(bytes * POOL_SIZE_MULTIPLIER)\n    node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto.getRandomValues(pool)\n    poolOffset = 0\n  } else if (poolOffset + bytes > pool.length) {\n    node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto.getRandomValues(pool)\n    poolOffset = 0\n  }\n  poolOffset += bytes\n}\nfunction random(bytes) {\n  fillPool((bytes |= 0))\n  return pool.subarray(poolOffset - bytes, poolOffset)\n}\nfunction customRandom(alphabet, defaultSize, getRandom) {\n  let mask = (2 << (31 - Math.clz32((alphabet.length - 1) | 1))) - 1\n  let step = Math.ceil((1.6 * mask * defaultSize) / alphabet.length)\n  return (size = defaultSize) => {\n    let id = ''\n    while (true) {\n      let bytes = getRandom(step)\n      let i = step\n      while (i--) {\n        id += alphabet[bytes[i] & mask] || ''\n        if (id.length >= size) return id\n      }\n    }\n  }\n}\nfunction customAlphabet(alphabet, size = 21) {\n  return customRandom(alphabet, size, random)\n}\nfunction nanoid(size = 21) {\n  fillPool((size |= 0))\n  let id = ''\n  for (let i = poolOffset - size; i < poolOffset; i++) {\n    id += _url_alphabet_index_js__WEBPACK_IMPORTED_MODULE_1__.urlAlphabet[pool[i] & 63]\n  }\n  return id\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3V0aWxzL25vZGVfbW9kdWxlcy9uYW5vaWQvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFpRDtBQUN5QjtBQUNyQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxrREFBTTtBQUNWO0FBQ0EsSUFBSTtBQUNKLElBQUksa0RBQU07QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0Esa0NBQWtDLGdCQUFnQjtBQUNsRCxVQUFVLCtEQUFpQjtBQUMzQjtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yYWluMi9Eb2N1bWVudHMvbm90ZUNhcmQvbm9kZV9tb2R1bGVzL0BtaWxrZG93bi91dGlscy9ub2RlX21vZHVsZXMvbmFub2lkL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHdlYmNyeXB0byBhcyBjcnlwdG8gfSBmcm9tICdub2RlOmNyeXB0bydcbmltcG9ydCB7IHVybEFscGhhYmV0IGFzIHNjb3BlZFVybEFscGhhYmV0IH0gZnJvbSAnLi91cmwtYWxwaGFiZXQvaW5kZXguanMnXG5leHBvcnQgeyB1cmxBbHBoYWJldCB9IGZyb20gJy4vdXJsLWFscGhhYmV0L2luZGV4LmpzJ1xuY29uc3QgUE9PTF9TSVpFX01VTFRJUExJRVIgPSAxMjhcbmxldCBwb29sLCBwb29sT2Zmc2V0XG5mdW5jdGlvbiBmaWxsUG9vbChieXRlcykge1xuICBpZiAoIXBvb2wgfHwgcG9vbC5sZW5ndGggPCBieXRlcykge1xuICAgIHBvb2wgPSBCdWZmZXIuYWxsb2NVbnNhZmUoYnl0ZXMgKiBQT09MX1NJWkVfTVVMVElQTElFUilcbiAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHBvb2wpXG4gICAgcG9vbE9mZnNldCA9IDBcbiAgfSBlbHNlIGlmIChwb29sT2Zmc2V0ICsgYnl0ZXMgPiBwb29sLmxlbmd0aCkge1xuICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMocG9vbClcbiAgICBwb29sT2Zmc2V0ID0gMFxuICB9XG4gIHBvb2xPZmZzZXQgKz0gYnl0ZXNcbn1cbmV4cG9ydCBmdW5jdGlvbiByYW5kb20oYnl0ZXMpIHtcbiAgZmlsbFBvb2woKGJ5dGVzIHw9IDApKVxuICByZXR1cm4gcG9vbC5zdWJhcnJheShwb29sT2Zmc2V0IC0gYnl0ZXMsIHBvb2xPZmZzZXQpXG59XG5leHBvcnQgZnVuY3Rpb24gY3VzdG9tUmFuZG9tKGFscGhhYmV0LCBkZWZhdWx0U2l6ZSwgZ2V0UmFuZG9tKSB7XG4gIGxldCBtYXNrID0gKDIgPDwgKDMxIC0gTWF0aC5jbHozMigoYWxwaGFiZXQubGVuZ3RoIC0gMSkgfCAxKSkpIC0gMVxuICBsZXQgc3RlcCA9IE1hdGguY2VpbCgoMS42ICogbWFzayAqIGRlZmF1bHRTaXplKSAvIGFscGhhYmV0Lmxlbmd0aClcbiAgcmV0dXJuIChzaXplID0gZGVmYXVsdFNpemUpID0+IHtcbiAgICBsZXQgaWQgPSAnJ1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBsZXQgYnl0ZXMgPSBnZXRSYW5kb20oc3RlcClcbiAgICAgIGxldCBpID0gc3RlcFxuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZCArPSBhbHBoYWJldFtieXRlc1tpXSAmIG1hc2tdIHx8ICcnXG4gICAgICAgIGlmIChpZC5sZW5ndGggPj0gc2l6ZSkgcmV0dXJuIGlkXG4gICAgICB9XG4gICAgfVxuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gY3VzdG9tQWxwaGFiZXQoYWxwaGFiZXQsIHNpemUgPSAyMSkge1xuICByZXR1cm4gY3VzdG9tUmFuZG9tKGFscGhhYmV0LCBzaXplLCByYW5kb20pXG59XG5leHBvcnQgZnVuY3Rpb24gbmFub2lkKHNpemUgPSAyMSkge1xuICBmaWxsUG9vbCgoc2l6ZSB8PSAwKSlcbiAgbGV0IGlkID0gJydcbiAgZm9yIChsZXQgaSA9IHBvb2xPZmZzZXQgLSBzaXplOyBpIDwgcG9vbE9mZnNldDsgaSsrKSB7XG4gICAgaWQgKz0gc2NvcGVkVXJsQWxwaGFiZXRbcG9vbFtpXSAmIDYzXVxuICB9XG4gIHJldHVybiBpZFxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/utils/node_modules/nanoid/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@milkdown/utils/node_modules/nanoid/url-alphabet/index.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@milkdown/utils/node_modules/nanoid/url-alphabet/index.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   urlAlphabet: () => (/* binding */ urlAlphabet)\n/* harmony export */ });\nconst urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQG1pbGtkb3duL3V0aWxzL25vZGVfbW9kdWxlcy9uYW5vaWQvdXJsLWFscGhhYmV0L2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQIiwic291cmNlcyI6WyIvVXNlcnMvcmFpbjIvRG9jdW1lbnRzL25vdGVDYXJkL25vZGVfbW9kdWxlcy9AbWlsa2Rvd24vdXRpbHMvbm9kZV9tb2R1bGVzL25hbm9pZC91cmwtYWxwaGFiZXQvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHVybEFscGhhYmV0ID1cbiAgJ3VzZWFuZG9tLTI2VDE5ODM0MFBYNzVweEpBQ0tWRVJZTUlOREJVU0hXT0xGX0dRWmJmZ2hqa2xxdnd5enJpY3QnXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@milkdown/utils/node_modules/nanoid/url-alphabet/index.js\n");

/***/ })

};
;